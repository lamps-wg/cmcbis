<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Certificate Management over CMS (CMC)</title>
<meta content="Joseph Mandel (editor)" name="author">
<meta content="Sean Turner (editor)" name="author">
<meta content="
       This document defines the base syntax for CMC, a Certificate
Management protocol using the Cryptographic Message Syntax (CMS).
This protocol addresses two immediate needs within the Internet
Public Key Infrastructure (PKI) community: 
       
           The need for an interface to public key certification products
and services based on CMS and PKCS #10 (Public Key Cryptography
Standard), and 
         
         
           The need for a PKI enrollment protocol for encryption only keys
due to algorithm or hardware design. 
         
       
       CMC also requires the use of the transport document and the
requirements usage document along with this document for a full
definition. 
       This document obsoletes RFCs 5272 and 6402. 
       This document also updates part of RFC 5911 to add support for additional
HMAC algorithms used with the POP Link Witness control. 
    " name="description">
<meta content="xml2rfc 3.21.0" name="generator">
<meta content="Public Key Infrastructure" name="keyword">
<meta content="Certificate Management" name="keyword">
<meta content="Cryptographic Message Syntax" name="keyword">
<meta content="draft-mandel-lamps-rfc5272bis-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 69.5.1
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-mandel-lamps-rfc5272bis.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">CMC: Structures</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Mandel, Ed &amp; Turner, Ed</td>
<td class="center">Expires 2 January 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Limited Additional Mechanisms for PKIX and SMIME</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-mandel-lamps-rfc5272bis-latest</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc5272" class="eref">5272</a>, <a href="https://www.rfc-editor.org/rfc/rfc6402" class="eref">6402</a> (if approved)</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc5911" class="eref">5911</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-07-01" class="published">1 July 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-01-02">2 January 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Mandel, Ed</div>
<div class="org">AKAYLA, Inc.</div>
</div>
<div class="author">
      <div class="author-name">S. Turner, Ed</div>
<div class="org">sn3rd</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Certificate Management over CMS (CMC)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the base syntax for CMC, a Certificate
Management protocol using the Cryptographic Message Syntax (CMS).
This protocol addresses two immediate needs within the Internet
Public Key Infrastructure (PKI) community:<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-abstract-2">
<li id="section-abstract-2.1">
          <p id="section-abstract-2.1.1">The need for an interface to public key certification products
and services based on CMS and PKCS #10 (Public Key Cryptography
Standard), and<a href="#section-abstract-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-abstract-2.2">
          <p id="section-abstract-2.2.1">The need for a PKI enrollment protocol for encryption only keys
due to algorithm or hardware design.<a href="#section-abstract-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-abstract-3">CMC also requires the use of the transport document and the
requirements usage document along with this document for a full
definition.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">This document obsoletes RFCs 5272 and 6402.<a href="#section-abstract-4" class="pilcrow">¶</a></p>
<p id="section-abstract-5">This document also updates part of RFC 5911 to add support for additional
HMAC algorithms used with the POP Link Witness control.<a href="#section-abstract-5" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-mandel-lamps-rfc5272bis/">https://datatracker.ietf.org/doc/draft-mandel-lamps-rfc5272bis/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Limited Additional Mechanisms for PKIX and SMIME Working Group mailing list (<span><a href="mailto:spasm@ietf.org">mailto:spasm@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/spasm/">https://mailarchive.ietf.org/arch/browse/spasm/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/spasm/">https://www.ietf.org/mailman/listinfo/spasm/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/seanturner/cmcbis">https://github.com/seanturner/cmcbis</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 2 January 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-protocol-requirements" class="internal xref">Protocol Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-requirements-terminology" class="internal xref">Requirements Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-changes-from-rfc-2797" class="internal xref">Changes from RFC 2797</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-updates-made-by-rfc-6402" class="internal xref">Updates Made by RFC 6402</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-changes-since-rfc-6402" class="internal xref">Changes Since RFC 6402</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-protocol-requests-responses" class="internal xref">Protocol Requests/Responses</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-pki-requests" class="internal xref">PKI Requests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-simple-pki-request" class="internal xref">Simple PKI Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-full-pki-request" class="internal xref">Full PKI Request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-pkidata-content-type" class="internal xref">PKIData Content Type</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-body-part-identification" class="internal xref">Body Part Identification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="auto internal xref">3.2.3</a>.  <a href="#name-cmc-unsigned-data-attribute" class="internal xref">CMC Unsigned Data Attribute</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-pki-responses" class="internal xref">PKI Responses</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-simple-pki-response" class="internal xref">Simple PKI Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-full-pki-response" class="internal xref">Full PKI Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-pkiresponse-content-type" class="internal xref">PKIResponse Content Type</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-application-of-encryption-t" class="internal xref">Application of Encryption to a PKI Request/Response</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-controls" class="internal xref">Controls</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-cmc-status-info-controls" class="internal xref">CMC Status Info Controls</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-extended-cmc-status-info-co" class="internal xref">Extended CMC Status Info Control</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-cmc-status-info-control" class="internal xref">CMC Status Info Control</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="auto internal xref">6.1.3</a>.  <a href="#name-cmcstatus-values" class="internal xref">CMCStatus Values</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.4">
                    <p id="section-toc.1-1.6.2.1.2.4.1"><a href="#section-6.1.4" class="auto internal xref">6.1.4</a>.  <a href="#name-cmcfailinfo" class="internal xref">CMCFailInfo</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-identification-and-identity" class="internal xref">Identification and Identity Proof Controls</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-identity-proof-version-2-co" class="internal xref">Identity Proof Version 2 Control</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-identity-proof-control" class="internal xref">Identity Proof Control</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="auto internal xref">6.2.3</a>.  <a href="#name-identification-control" class="internal xref">Identification Control</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.4">
                    <p id="section-toc.1-1.6.2.2.2.4.1"><a href="#section-6.2.4" class="auto internal xref">6.2.4</a>.  <a href="#name-hardware-shared-secret-toke" class="internal xref">Hardware Shared-Secret Token Generation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-linking-identity-and-pop-in" class="internal xref">Linking Identity and POP Information</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="auto internal xref">6.3.1</a>.  <a href="#name-cryptographic-linkage" class="internal xref">Cryptographic Linkage</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="auto internal xref">6.3.2</a>.  <a href="#name-shared-secret-subject-dn-li" class="internal xref">Shared-Secret/Subject DN Linking</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.3">
                    <p id="section-toc.1-1.6.2.3.2.3.1"><a href="#section-6.3.3" class="auto internal xref">6.3.3</a>.  <a href="#name-existing-certificate-linkin" class="internal xref">Existing Certificate Linking</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-data-return-control" class="internal xref">Data Return Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-ra-certificate-modification" class="internal xref">RA Certificate Modification Controls</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a href="#section-6.5.1" class="auto internal xref">6.5.1</a>.  <a href="#name-modify-certification-reques" class="internal xref">Modify Certification Request Control</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a href="#section-6.5.2" class="auto internal xref">6.5.2</a>.  <a href="#name-add-extensions-control" class="internal xref">Add Extensions Control</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-transaction-identifier-cont" class="internal xref">Transaction Identifier Control and Sender and Recipient Nonce Controls</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="auto internal xref">6.7</a>.  <a href="#name-encrypted-and-decrypted-pop" class="internal xref">Encrypted and Decrypted POP Controls</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="auto internal xref">6.8</a>.  <a href="#name-ra-pop-witness-control" class="internal xref">RA POP Witness Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a href="#section-6.9" class="auto internal xref">6.9</a>.  <a href="#name-get-certificate-control" class="internal xref">Get Certificate Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.10">
                <p id="section-toc.1-1.6.2.10.1"><a href="#section-6.10" class="auto internal xref">6.10</a>. <a href="#name-get-crl-control" class="internal xref">Get CRL Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.11">
                <p id="section-toc.1-1.6.2.11.1"><a href="#section-6.11" class="auto internal xref">6.11</a>. <a href="#name-revocation-request-control" class="internal xref">Revocation Request Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.12">
                <p id="section-toc.1-1.6.2.12.1"><a href="#section-6.12" class="auto internal xref">6.12</a>. <a href="#name-registration-and-response-i" class="internal xref">Registration and Response Information Controls</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.13">
                <p id="section-toc.1-1.6.2.13.1"><a href="#section-6.13" class="auto internal xref">6.13</a>. <a href="#name-query-pending-control" class="internal xref">Query Pending Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.14">
                <p id="section-toc.1-1.6.2.14.1"><a href="#section-6.14" class="auto internal xref">6.14</a>. <a href="#name-confirm-certificate-accepta" class="internal xref">Confirm Certificate Acceptance Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.15">
                <p id="section-toc.1-1.6.2.15.1"><a href="#section-6.15" class="auto internal xref">6.15</a>. <a href="#name-publish-trust-anchors-contr" class="internal xref">Publish Trust Anchors Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.16">
                <p id="section-toc.1-1.6.2.16.1"><a href="#section-6.16" class="auto internal xref">6.16</a>. <a href="#name-authenticated-data-control" class="internal xref">Authenticated Data Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.17">
                <p id="section-toc.1-1.6.2.17.1"><a href="#section-6.17" class="auto internal xref">6.17</a>. <a href="#name-batch-request-and-response-" class="internal xref">Batch Request and Response Controls</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.18">
                <p id="section-toc.1-1.6.2.18.1"><a href="#section-6.18" class="auto internal xref">6.18</a>. <a href="#name-publication-information-con" class="internal xref">Publication Information Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.19">
                <p id="section-toc.1-1.6.2.19.1"><a href="#section-6.19" class="auto internal xref">6.19</a>. <a href="#name-control-processed-control" class="internal xref">Control Processed Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.20">
                <p id="section-toc.1-1.6.2.20.1"><a href="#section-6.20" class="auto internal xref">6.20</a>. <a href="#name-ra-identity-proof-witness-c" class="internal xref">RA Identity Proof Witness Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.21">
                <p id="section-toc.1-1.6.2.21.1"><a href="#section-6.21" class="auto internal xref">6.21</a>. <a href="#name-response-body-control" class="internal xref">Response Body Control</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-other-attributes" class="internal xref">Other Attributes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-change-subject-name-attribu" class="internal xref">Change Subject Name Attribute</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-registration-authorities" class="internal xref">Registration Authorities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-encryption-removal" class="internal xref">Encryption Removal</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-signature-layer-removal" class="internal xref">Signature Layer Removal</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-certificate-requirements" class="internal xref">Certificate Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-extended-key-usage" class="internal xref">Extended Key Usage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-subject-information-access" class="internal xref">Subject Information Access</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-asn1-modules" class="internal xref">ASN.1 Modules</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-asn1-module-for-cmc" class="internal xref">ASN.1 Module for CMC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-asn1-module-for-pbkdf2-prfs" class="internal xref">ASN.1 Module for PBKDF2 PRFs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-enrollment-message-flows" class="internal xref">Enrollment Message Flows</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-request-of-a-signing-certif" class="internal xref">Request of a Signing Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-single-certification-reques" class="internal xref">Single Certification Request, But Modified by RA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-direct-pop-for-an-rsa-certi" class="internal xref">Direct POP for an RSA Certificate</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-production-of-diffie-hellma" class="internal xref">Production of Diffie-Hellman Public Key Certification Requests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-no-signature-signature-mech" class="internal xref">No-Signature Signature Mechanism</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document defines the base syntax for CMC, a Certificate
Management protocol using the Cryptographic Message Syntax (CMS).
This protocol addresses two immediate needs within the Internet PKI
community:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-2">
<li id="section-1-2.1">
          <p id="section-1-2.1.1">The need for an interface to public key certification products
and services based on CMS and PKCS #10, and<a href="#section-1-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-2.2">
          <p id="section-1-2.2.1">The need for a PKI enrollment protocol for encryption only keys
due to algorithm or hardware design.<a href="#section-1-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-1-3">A small number of additional services are defined to supplement the
core certification request service.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document obsoletes <span>[<a href="#CMC-PROTv1" class="cite xref">CMC-PROTv1</a>]</span> and <span>[<a href="#CMC-Updates" class="cite xref">CMC-Updates</a>]</span>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This document also updates <span>[<a href="#CMS-ALGS" class="cite xref">CMS-ALGS</a>]</span> to add support for additional
HMAC algorithms used in the POP Link Witness V2 control.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="protocol-requirements">
<section id="section-1.1">
        <h3 id="name-protocol-requirements">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-protocol-requirements" class="section-name selfRef">Protocol Requirements</a>
        </h3>
<p id="section-1.1-1">The protocol must be based as much as possible on the existing CMS,
PKCS #10 <span>[<a href="#PKCS10" class="cite xref">PKCS10</a>]</span> and CRMF (Certificate Request Message Format)
<span>[<a href="#CRMF" class="cite xref">CRMF</a>]</span> specifications.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The protocol must support the current industry practice of a PKCS #10
certification request followed by a PKCS#7 "certs-only" response as a
subset of the protocol.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">The protocol must easily support the multi-key enrollment protocols
required by S/MIME and other groups.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">The protocol must supply a way of doing all enrollment operations in
a single round-trip.  When this is not possible the number of
round-trips is to be minimized.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">The protocol must be designed such that all key generation can occur
on the client.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6">Support must exist for the mandatory algorithms used by S/MIME.
Support should exist for all other algorithms cited by the S/MIME
core documents.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7">The protocol must contain Proof-of-Possession (POP) methods.
Optional provisions for multiple-round-trip POP will be made if
necessary.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<p id="section-1.1-8">The protocol must support deferred and pending responses to
enrollment requests for cases where external procedures are required
to issue a certificate.<a href="#section-1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requirements-terminology">
<section id="section-1.2">
        <h3 id="name-requirements-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-requirements-terminology" class="section-name selfRef">Requirements Terminology</a>
        </h3>
<p id="section-1.2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes-from-rfc-2797">
<section id="section-1.3">
        <h3 id="name-changes-from-rfc-2797">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-changes-from-rfc-2797" class="section-name selfRef">Changes from RFC 2797</a>
        </h3>
<p id="section-1.3-1">We have done a major overhaul on the layout of the document. This
included two different steps.  Firstly we removed some sections from
the document and moved them to two other documents. Information on
how to transport our messages are now found in <span>[<a href="#CMC-TRANS" class="cite xref">CMC-TRANS</a>]</span>.
Information on which controls and sections of this document must be
implemented along with which algorithms are required can now be found
in <span>[<a href="#CMC-COMPL" class="cite xref">CMC-COMPL</a>]</span>.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">A number of new controls have been added in this version:<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-3.1">
            <p id="section-1.3-3.1.1">Extended CMC Status Info Section 6.1.1<a href="#section-1.3-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-4.1">
            <p id="section-1.3-4.1.1">Publish Trust Anchors Section 6.15<a href="#section-1.3-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-5.1">
            <p id="section-1.3-5.1.1">Authenticate Data Section 6.16<a href="#section-1.3-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-6.1">
            <p id="section-1.3-6.1.1">Batch Request and Response Processing Section 6.17<a href="#section-1.3-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-7.1">
            <p id="section-1.3-7.1.1">Publication Information Section 6.18<a href="#section-1.3-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-8.1">
            <p id="section-1.3-8.1.1">Modify Certification Request Section 6.5.1<a href="#section-1.3-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-9.1">
            <p id="section-1.3-9.1.1">Control Processed Section 6.19<a href="#section-1.3-9.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-10.1">
            <p id="section-1.3-10.1.1">Identity Proof Section 6.2.2<a href="#section-1.3-10.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-11.1">
            <p id="section-1.3-11.1.1">Identity POP Link Witness V2 Section 6.3.1.1<a href="#section-1.3-11.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="updates-made-by-rfc-6402">
<section id="section-1.4">
        <h3 id="name-updates-made-by-rfc-6402">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-updates-made-by-rfc-6402" class="section-name selfRef">Updates Made by RFC 6402</a>
        </h3>
<p id="section-1.4-1">Two new controls have been added:<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.4-2.1">
            <p id="section-1.4-2.1.1">RA Identity Witness  allows for an RA to perform identity checking
  using the identity and shared-secret, and then tell any
  following servers that the identity check was successfully
  performed.<a href="#section-1.4-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.4-3.1">
            <p id="section-1.4-3.1.1">Response Body  allows for an RA to identify a nested response for
  an EE to process.<a href="#section-1.4-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.4-4">Created a new attribute, Change Subject Name, that allows a client
to request a change in the subject name and subject alternate name
fields in a certificate.<a href="#section-1.4-4" class="pilcrow">¶</a></p>
<p id="section-1.4-5">Added Extended Key Usages for CMC to distinguish server types.<a href="#section-1.4-5" class="pilcrow">¶</a></p>
<p id="section-1.4-6">Defined a new Subject Information Access type to hold locations to
contact the CMC server.<a href="#section-1.4-6" class="pilcrow">¶</a></p>
<p id="section-1.4-7">Clarified that the use of a pre-existing certificate is not limited
to just renewal and rekey messages and is required for support.
This formalizes a requirement for the ability to do renewal and
rekey that previously was implicit.<a href="#section-1.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes-since-rfc-6402">
<section id="section-1.5">
        <h3 id="name-changes-since-rfc-6402">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-changes-since-rfc-6402" class="section-name selfRef">Changes Since RFC 6402</a>
        </h3>
<aside id="section-1.5-1">
          <p id="section-1.5-1.1">Note: For now, this section will be list of the changes introduced
  by each version. After WGLC, this section will be finalized.<a href="#section-1.5-1.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-1.5-2">--03 todo:<a href="#section-1.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-3.1">
            <p id="section-1.5-3.1.1">Address management of KEM certificate<a href="#section-1.5-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.5-4">--03 version changes:<a href="#section-1.5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-5.1">
            <p id="section-1.5-5.1.1">Publish Trust Anchors Control hashAlgorithm changed to SHA-256<a href="#section-1.5-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-5.2">
            <p id="section-1.5-5.2.1">Update DH-POP from RFC2875 to RFC6955<a href="#section-1.5-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-5.3">
            <p id="section-1.5-5.3.1">Editorial changes<a href="#section-1.5-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.5-6">--02 version changes:<a href="#section-1.5-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-7.1">
            <p id="section-1.5-7.1.1">Add module to support new HMAC algorithms in PBKDF2<a href="#section-1.5-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.5-8">--01 version changes:<a href="#section-1.5-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-9.1">
            <p id="section-1.5-9.1.1">Changed RFC 5273 references to draft-mandel-lamps-rfc5273bis<a href="#section-1.5-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-9.2">
            <p id="section-1.5-9.2.1">Changed RFC 5274 references to draft-mandel-lamps-rfc5274bis<a href="#section-1.5-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-9.3">
            <p id="section-1.5-9.3.1">Added missing "OBJECT IDENTIFIER" to declarations throughout mainbody
to match ASN.1 module<a href="#section-1.5-9.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-9.4">
            <p id="section-1.5-9.4.1">Rework Section 1.3<a href="#section-1.5-9.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-9.5">
            <p id="section-1.5-9.5.1">Update CMC Control Attribute Table<a href="#section-1.5-9.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-9.6">
            <p id="section-1.5-9.6.1">Updates ASN.1 to use 2002 ASN.1 module baseed on <span>[<a href="#CMC-Updates" class="cite xref">CMC-Updates</a>]</span><a href="#section-1.5-9.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-9.7">
            <p id="section-1.5-9.7.1">To support adopting SHA-256 and HMAC-SHA256:<a href="#section-1.5-9.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-9.7.2.1">
                <p id="section-1.5-9.7.2.1.1">Add maca-hMAC-SHA256 to POPAlgs<a href="#section-1.5-9.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.5-9.7.2.2">
                <p id="section-1.5-9.7.2.2.1">Add mda-sha256 to WitnessAlgs<a href="#section-1.5-9.7.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.5-9.7.2.3">
                <p id="section-1.5-9.7.2.3.1">Add maca-hMAC-SHA256 and mda-sha256 to example in Appendix B<a href="#section-1.5-9.7.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.5-9.8">
            <p id="section-1.5-9.8.1">Merged <span>[<a href="#erratum2731" class="cite xref">erratum2731</a>]</span><a href="#section-1.5-9.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-9.9">
            <p id="section-1.5-9.9.1">Merged <span>[<a href="#erratum4775" class="cite xref">erratum4775</a>]</span><a href="#section-1.5-9.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-9.10">
            <p id="section-1.5-9.10.1">Mereged <span>[<a href="#erratum7379" class="cite xref">erratum7379</a>]</span><a href="#section-1.5-9.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-9.11">
            <p id="section-1.5-9.11.1">Merged <span>[<a href="#erratum7628" class="cite xref">erratum7628</a>]</span><a href="#section-1.5-9.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-9.12">
            <p id="section-1.5-9.12.1">Merged <span>[<a href="#erratum7629" class="cite xref">erratum7629</a>]</span><a href="#section-1.5-9.12.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.5-10">--00 version changes:<a href="#section-1.5-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-11.1">
            <p id="section-1.5-11.1.1">Added "Updates Made by RFC 6402" section<a href="#section-1.5-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-11.2">
            <p id="section-1.5-11.2.1">Merged <span>[<a href="#CMC-Updates" class="cite xref">CMC-Updates</a>]</span> text<a href="#section-1.5-11.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-11.3">
            <p id="section-1.5-11.3.1">Merged <span>[<a href="#erratum2063" class="cite xref">erratum2063</a>]</span><a href="#section-1.5-11.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-11.4">
            <p id="section-1.5-11.4.1">Merged <span>[<a href="#erratum7627" class="cite xref">erratum7627</a>]</span><a href="#section-1.5-11.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-11.5">
            <p id="section-1.5-11.5.1">Updated and moved Acknowledgments<a href="#section-1.5-11.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="protocol-overview">
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-2-1">A PKI enrollment transaction in this specification is generally
composed of a single round-trip of messages. In the simplest case a
PKI enrollment request, henceforth referred to as a PKI Request, is
sent from the client to the server and a PKI enrollment response,
henceforth referred to as a PKI Response, is then returned from the
server to the client. In more complicated cases, such as delayed
certificate issuance, more than one round-trip is required.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This specification defines two PKI Request types and two PKI Response
types.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">PKI Requests are formed using either the PKCS #10 or CRMF structure.
The two PKI Requests are:<a href="#section-2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-4.1">
          <span class="break"></span><dl class="dlParallel" id="section-2-4.1.1">
            <dt id="section-2-4.1.1.1">Simple PKI Request:</dt>
            <dd style="margin-left: 1.5em" id="section-2-4.1.1.2">
              <p id="section-2-4.1.1.2.1">the bare PKCS #10 (in the event that no other services are needed),
and<a href="#section-2-4.1.1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-5.1">
          <span class="break"></span><dl class="dlParallel" id="section-2-5.1.1">
            <dt id="section-2-5.1.1.1">Full PKI Request:</dt>
            <dd style="margin-left: 1.5em" id="section-2-5.1.1.2">
              <p id="section-2-5.1.1.2.1">one or more PKCS #10, CRMF or Other Request Messages structures
wrapped in a CMS encapsulation as part of a PKIData.<a href="#section-2-5.1.1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</li>
      </ul>
<p id="section-2-6">PKI Responses are based on SignedData or AuthenticatedData <span>[<a href="#CMS" class="cite xref">CMS</a>]</span>.
The two PKI Responses are<a href="#section-2-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-7.1">
          <span class="break"></span><dl class="dlParallel" id="section-2-7.1.1">
            <dt id="section-2-7.1.1.1">Simple PKI Response:</dt>
            <dd style="margin-left: 1.5em" id="section-2-7.1.1.2">
              <p id="section-2-7.1.1.2.1">a "certs-only" SignedData (in the event no other services are needed),
or<a href="#section-2-7.1.1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-8.1">
          <span class="break"></span><dl class="dlParallel" id="section-2-8.1.1">
            <dt id="section-2-8.1.1.1">Full PKI Response:</dt>
            <dd style="margin-left: 1.5em" id="section-2-8.1.1.2">
              <p id="section-2-8.1.1.2.1">a PKIResponse content type wrapped in a SignedData.<a href="#section-2-8.1.1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</li>
      </ul>
<p id="section-2-9">No special services are provided for either renewal (i.e., a new
certificate with the same key) or rekey (i.e., a new certificate with
a new key) of client certificates. Instead renewal and rekey
requests look the same as any certification request, except that the
identity proof is supplied by existing certificates from a trusted
CA. (This is usually the same CA, but could be a different CA in the
same organization where naming is shared.)<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">No special services are provided to distinguish between a rekey
request and a new certification request (generally for a new
purpose). A control to unpublish a certificate would normally be
included in a rekey request, and be omitted in a new certification
request. CAs or other publishing agents are also expected to have
policies for removing certificates from publication either based on
new certificates being added or the expiration or revocation of a
certificate.<a href="#section-2-10" class="pilcrow">¶</a></p>
<p id="section-2-11">A provision exists for RAs to participate in the protocol by taking
PKI Requests, wrapping them in a second layer of PKI Request with
additional requirements or statements from the RA and then passing
this new expanded PKI Request on to the CA.<a href="#section-2-11" class="pilcrow">¶</a></p>
<p id="section-2-12">This specification makes no assumptions about the underlying
transport mechanism. The use of CMS does not imply an email-based
transport. Several different possible transport methods are defined
in <span>[<a href="#CMC-TRANS" class="cite xref">CMC-TRANS</a>]</span>.<a href="#section-2-12" class="pilcrow">¶</a></p>
<p id="section-2-13">Optional services available through this specification are
transaction management, replay detection (through nonces), deferred
certificate issuance, certificate revocation requests and
certificate/certificate revocation list (CRL) retrieval.<a href="#section-2-13" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-2.1">
        <h3 id="name-terminology">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-2.1-1">There are several different terms, abbreviations, and acronyms used
in this document. These are defined here, in no particular order,
for convenience and consistency of usage:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-2.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-2.1.1.1">
                <p id="section-2.1-2.1.1.1.1">End-Entity (EE) refers to the entity that owns a key pair and for
   whom a certificate is issued.<a href="#section-2.1-2.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-3.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-3.1.1.1">
                <p id="section-2.1-3.1.1.1.1">Registration Authority (RA) or Local RA (LRA) refers to an entity
   that acts as an intermediary between the EE and the CA. Multiple
   RAs can exist between the end-entity and the Certification
   Authority. RAs may perform additional services such as key
   generation or key archival. This document uses the term RA for
   both RA and LRA.<a href="#section-2.1-3.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-4.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-4.1.1.1">
                <p id="section-2.1-4.1.1.1.1">Certification Authority (CA) refers to the entity that issues
   certificates.<a href="#section-2.1-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-5.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-5.1.1.1">
                <p id="section-2.1-5.1.1.1.1">Client refers to an entity that creates a PKI Request. In this
   document, both RAs and EEs can be clients.<a href="#section-2.1-5.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-6.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-6.1.1.1">
                <p id="section-2.1-6.1.1.1.1">Server refers to the entities that process PKI Requests and create
    PKI Responses. In this document, both CAs and RAs can be servers.<a href="#section-2.1-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-7.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-7.1.1.1">
                <p id="section-2.1-7.1.1.1.1">PKCS #10 refers to the Public Key Cryptography Standard #10
   <span>[<a href="#PKCS10" class="cite xref">PKCS10</a>]</span> which defines a certification request syntax.<a href="#section-2.1-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-8.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-8.1.1.1">
                <p id="section-2.1-8.1.1.1.1">CRMF refers to the Certificate Request Message Format RFC <span>[<a href="#CRMF" class="cite xref">CRMF</a>]</span>.
   CMC uses this certification request syntax defined in this
   document as part of the protocol.<a href="#section-2.1-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-9.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-9.1.1.1">
                <p id="section-2.1-9.1.1.1.1">CMS refers to the Cryptographic Message Syntax RFC <span>[<a href="#CMS" class="cite xref">CMS</a>]</span>. This
   document provides for basic cryptographic services including
   encryption and signing with and without key management.<a href="#section-2.1-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-10.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-10.1.1.1">
                <p id="section-2.1-10.1.1.1.1">PKI Request/Response refers to the requests/responses described in
   this document. PKI Requests include certification requests,
   revocation requests, etc. PKI Responses include certs-only
   messages, failure messages, etc.<a href="#section-2.1-10.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-11.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-11.1.1.1">
                <p id="section-2.1-11.1.1.1.1">Proof-of-Identity refers to the client proving they are who they say
   that they are to the server.<a href="#section-2.1-11.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-12.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-12.1.1.1">
                <p id="section-2.1-12.1.1.1.1">Enrollment or certification request refers to the process of a
   client requesting a certificate. A certification request is a
   subset of the PKI Requests.<a href="#section-2.1-12.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-13.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-13.1.1.1">
                <p id="section-2.1-13.1.1.1.1">Proof-of-Possession (POP) refers to a value that can be used to
   prove that the private key corresponding to a public key is in the
   possession and can be used by an end-entity. The different types
   of POP are:<a href="#section-2.1-13.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-14.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-14.1.1.1">
                <ul class="normal">
<li class="normal" id="section-2.1-14.1.1.1.1.1">
                    <p id="section-2.1-14.1.1.1.1.1.1">Signature provides the required POP by a signature operation over
   some data.<a href="#section-2.1-14.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-15.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-15.1.1.1">
                <ul class="normal">
<li class="normal" id="section-2.1-15.1.1.1.1.1">
                    <p id="section-2.1-15.1.1.1.1.1.1">Direct provides the required POP operation by an encrypted
   challenge/response mechanism.<a href="#section-2.1-15.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-16.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-16.1.1.1">
                <ul class="normal">
<li class="normal" id="section-2.1-16.1.1.1.1.1">
                    <p id="section-2.1-16.1.1.1.1.1.1">Indirect provides the required POP operation by returning the
   issued certificate in an encrypted state.  (This method is not
   used by CMC.)<a href="#section-2.1-16.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-17.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-17.1.1.1">
                <ul class="normal">
<li class="normal" id="section-2.1-17.1.1.1.1.1">
                    <p id="section-2.1-17.1.1.1.1.1.1">Publish provides the required POP operation by providing the
   private key to the certificate issuer. (This method is not
   currently used by CMC. It would be used by Key Generation or
   Key Escrow extensions.)<a href="#section-2.1-17.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-18.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-18.1.1.1">
                <ul class="normal">
<li class="normal" id="section-2.1-18.1.1.1.1.1">
                    <p id="section-2.1-18.1.1.1.1.1.1">Attested provides the required POP operation by allowing a
   trusted entity to assert that the POP has been proven by one of
   the above methods.<a href="#section-2.1-18.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-19.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-19.1.1.1">
                <p id="section-2.1-19.1.1.1.1">Object IDentifier (OID) is a primitive type in Abstract Syntax
   Notation One (ASN.1).<a href="#section-2.1-19.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="ProtocolRequestsResponses">
<section id="section-2.2">
        <h3 id="name-protocol-requests-responses">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-protocol-requests-responses" class="section-name selfRef">Protocol Requests/Responses</a>
        </h3>
<p id="section-2.2-1">Figure 1 shows the Simple PKI Requests and Responses. The contents
of Simple PKI Request and Response are detailed in <a href="#SimplePKIRequest" class="auto internal xref">Section 3.1</a> and
<a href="#SimplePKIResponse" class="auto internal xref">Section 4.1</a>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-2">
<pre>
Simple PKI Request                      Simple PKI Response
-------------------------               --------------------------

 +----------+                            +------------------+
 | PKCS #10 |                            | CMS ContentInfo  |
 +----------+--------------+             +------------------+------+
 | Certification Request   |             | CMS Signed Data,        |
 |                         |             |   no SignerInfo         |
 | Subject Name            |             |                         |
 | Subject Public Key Info |             | SignedData contains one |
 |   (K_PUB)               |             | or more certificates in |
 | Attributes              |             | the certificates field  |
 |                         |             | Relevant CA certs and   |
 +-----------+-------------+             | CRLs can be included    |
             | signed with |             | as well.                |
             | matching    |             |                         |
             | K_PRIV      |             | encapsulatedContentInfo |
             +-------------+             | is absent.              |
                                         +--------------+----------+
                                                        | unsigned |
                                                        +----------+

             Figure 1: Simple PKI Requests and Responses
</pre><a href="#section-2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-2.2-3">Figure 2 shows the Full PKI Requests and Responses. The contents of
the Full PKI Request and Response are detailed in <a href="#FullPKIRequest" class="auto internal xref">Section 3.2</a> and
<a href="#FullPKIResponse" class="auto internal xref">Section 4.2</a>.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-4">
<pre>
Full PKI Request                        Full PKI Response
-----------------------                 ------------------------
 +----------------+                      +----------------+
 | CMS ContentInfo|                      | CMS ContentInfo|
 | CMS SignedData |                      | CMS SignedData |
 |   or Auth Data |                      |   or Auth Data |
 |     object     |                      |     object     |
 +----------------+--------+             +----------------+--------+
 |                         |             |                         |
 | PKIData                 |             | PKIResponse             |
 |                         |             |                         |
 | Sequence of:            |             | Sequence of:            |
 | &lt;enrollment control&gt;*   |             | &lt;enrollment control&gt;*   |
 | &lt;certification request&gt;*|             | &lt;CMS object&gt;*           |
 | &lt;CMS object&gt;*           |             | &lt;other message&gt;*        |
 | &lt;other message&gt;*        |             |                         |
 |                         |             | where * == zero or more |
 | where * == zero or more |             |                         |
 |                         |             | All certificates issued |
 | Certification requests  |             | as part of the response |
 | are CRMF, PKCS #10, or  |             | are included in the     |
 | Other.                  |             | "certificates" field    |
 |                         |             | of the SignedData.      |
 +-------+-----------------+             | Relevant CA certs and   |
         | signed (keypair |             | CRLs can be included as |
         | used may be pre-|             | well.                   |
         | existing or     |             |                         |
         | identified in   |             +---------+---------------+
         | the request)    |                       | signed by the |
         +-----------------+                       | CA or an LRA  |
                                                   +---------------+

          Figure 2: Full PKI Requests and Responses
</pre><a href="#section-2.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="PKIRequests">
<section id="section-3">
      <h2 id="name-pki-requests">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-pki-requests" class="section-name selfRef">PKI Requests</a>
      </h2>
<p id="section-3-1">Two types of PKI Requests exist. This section gives the details for
both types.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="SimplePKIRequest">
<section id="section-3.1">
        <h3 id="name-simple-pki-request">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-simple-pki-request" class="section-name selfRef">Simple PKI Request</a>
        </h3>
<p id="section-3.1-1">A Simple PKI Request uses the PKCS #10 syntax CertificationRequest
<span>[<a href="#PKCS10" class="cite xref">PKCS10</a>]</span>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">When a server processes a Simple PKI Request, the PKI Response
returned is:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.1-3.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.1-3.1.1.1">
                <p id="section-3.1-3.1.1.1.1">Simple PKI Response on success.<a href="#section-3.1-3.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.1-4.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.1-4.1.1.1">
                <p id="section-3.1-4.1.1.1.1">Full PKI Response on failure. The server <span class="bcp14">MAY</span> choose not to return a
   PKI Response in this case.<a href="#section-3.1-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-3.1-5">The Simple PKI Request <span class="bcp14">MUST NOT</span> be used if a proof-of-identity needs
to be included.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">The Simple PKI Request cannot be used if the private key is not
capable of producing some type of signature (i.e., Diffie-Hellman
(DH) keys can use the signature algorithms in <span>[<a href="#DH-POP" class="cite xref">DH-POP</a>]</span> for production
of the signature).<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">The Simple PKI Request cannot be used for any of the advanced
services specified in this document.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">The client <span class="bcp14">MAY</span> incorporate one or more X.509v3 extensions in any
certification request based on PKCS #10 as an ExtensionReq attribute.
The ExtensionReq attribute is defined as:<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-9">
<pre>
  ExtensionReq ::= SEQUENCE SIZE (1..MAX) OF Extension
</pre><a href="#section-3.1-9" class="pilcrow">¶</a>
</div>
<p id="section-3.1-10">where Extension is imported from <span>[<a href="#PKIXCERT" class="cite xref">PKIXCERT</a>]</span> and ExtensionReq is
identified by:<a href="#section-3.1-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-11">
<pre>
  id-ExtensionReq OBJECT IDENTIFIER ::= { iso(1) member-body(2)
    us(840) rsadsi(113549) pkcs(1) pkcs-9(9) 14 }
</pre><a href="#section-3.1-11" class="pilcrow">¶</a>
</div>
<p id="section-3.1-12">Servers <span class="bcp14">MUST</span> be able to process all extensions defined, but not
prohibited, in <span>[<a href="#PKIXCERT" class="cite xref">PKIXCERT</a>]</span>. Servers are not required to be able to
process other X.509v3 extensions transmitted using this protocol, nor
are they required to be able to process private extensions. Servers
are not required to put all client-requested extensions into a
certificate. Servers are permitted to modify client-requested
extensions. Servers <span class="bcp14">MUST NOT</span> alter an extension so as to invalidate
the original intent of a client-requested extension. (For example,
changing key usage from keyAgreement to digitalSignature.) If a
certification request is denied due to the inability to handle a
requested extension and a PKI Response is returned, the server <span class="bcp14">MUST</span>
return a PKI Response with a CMCFailInfo value with the value
unsupportedExt.<a href="#section-3.1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="FullPKIRequest">
<section id="section-3.2">
        <h3 id="name-full-pki-request">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-full-pki-request" class="section-name selfRef">Full PKI Request</a>
        </h3>
<p id="section-3.2-1">The Full PKI Request provides the most functionality and flexibility.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The Full PKI Request is encapsulated in either a SignedData or an
AuthenticatedData with an encapsulated content type of 'id-cct-PKIData'
(<a href="#PKIDataContentType" class="auto internal xref">Section 3.2.1</a>).<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">When a server processes a Full PKI Request, a PKI Response <span class="bcp14">MUST</span> be
returned. The PKI Response returned is:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2-4.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2-4.1.1.1">
                <p id="section-3.2-4.1.1.1.1">Simple PKI Response if the enrollment was successful and only
   certificates are returned. (A CMCStatusInfoV2 control with
   success is implied.)<a href="#section-3.2-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2-5.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2-5.1.1.1">
                <p id="section-3.2-5.1.1.1.1">Full PKI Response if the enrollment was successful and information
   is returned in addition to certificates, if the enrollment is
   pending, or if the enrollment failed.<a href="#section-3.2-5.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-3.2-6">If <code>SignedData</code> is used, the signature can be generated using either
the private key material of an embedded signature certification
request (i.e., included in the TaggedRequest tcr or crm fields) or a
previously certified signature key. If the private key of a
signature certification request is used, then:<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-7">
<li id="section-3.2-7.1">
            <p id="section-3.2-7.1.1">The certification request containing the corresponding public key
<span class="bcp14">MUST</span> include a Subject Key Identifier extension.<a href="#section-3.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-7.2">
            <p id="section-3.2-7.2.1">The subjectKeyIdentifier form of the signerIdentifier in
SignerInfo <span class="bcp14">MUST</span> be used.<a href="#section-3.2-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-7.3">
            <p id="section-3.2-7.3.1">The value of the subjectKeyIdentifier form of SignerInfo <span class="bcp14">MUST</span> be
the Subject Key Identifier specified in the corresponding
certification request. (The subjectKeyIdentifier form of
SignerInfo is used here because no certificates have yet been
issued for the signing key.) If the request key is used for
signing, there <span class="bcp14">MUST</span> be only one SignerInfo in the SignedData.<a href="#section-3.2-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.2-8">If <code>AuthenticatedData</code> is used, then:<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-9">
<li id="section-3.2-9.1">
            <p id="section-3.2-9.1.1">The Password Recipient Info option of RecipientInfo <span class="bcp14">MUST</span> be used.<a href="#section-3.2-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-9.2">
            <p id="section-3.2-9.2.1">A randomly generated key is used to compute the Message
Authentication Code (MAC) value on the encapsulated content.<a href="#section-3.2-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-9.3">
            <p id="section-3.2-9.3.1">The input for the key derivation algorithm is a concatenation of
the identifier (encoded as UTF8) and the shared-secret.<a href="#section-3.2-9.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.2-10">When creating a PKI Request to renew or rekey a certificate:<a href="#section-3.2-10" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-11">
<li id="section-3.2-11.1">
            <p id="section-3.2-11.1.1">The Identification and Identity Proof controls are absent. The
same information is provided by the use of an existing
certificate from a CA when signing the PKI Request. In this
case, the CA that issued the original certificate and the CA the
request is made to will usually be the same, but could have a
common operator.<a href="#section-3.2-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-11.2">
            <p id="section-3.2-11.2.1">CAs and RAs can impose additional restrictions on the signing
certificate used. They may require that the most recently issued
signing certificate for a client be used.<a href="#section-3.2-11.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-11.3">
            <p id="section-3.2-11.3.1">Some CAs may prevent renewal operations (i.e., reuse of the same
keys). In this case the CA <span class="bcp14">MUST</span> return a PKI Response with
noKeyReuse as the CMCFailInfo failure code.<a href="#section-3.2-11.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<div id="PKIDataContentType">
<section id="section-3.2.1">
          <h4 id="name-pkidata-content-type">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-pkidata-content-type" class="section-name selfRef">PKIData Content Type</a>
          </h4>
<p id="section-3.2.1-1">The PKIData content type is used for the Full PKI Request. A PKIData
content type is identified by:<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.1-2">
<pre>
  id-cct-PKIData OBJECT IDENTIFIER ::= { id-pkix id-cct(12) 2 }
</pre><a href="#section-3.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1-3">The ASN.1 structure corresponding to the PKIData content type is:<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.1-4">
<pre>
  PKIData ::= SEQUENCE {
    controlSequence    SEQUENCE SIZE(0..MAX) OF TaggedAttribute,
    reqSequence        SEQUENCE SIZE(0..MAX) OF TaggedRequest,
    cmsSequence        SEQUENCE SIZE(0..MAX) OF TaggedContentInfo,
    otherMsgSequence   SEQUENCE SIZE(0..MAX) OF OtherMsg
  }
</pre><a href="#section-3.2.1-4" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1-5">The fields in PKIData have the following meaning:<a href="#section-3.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1-6.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1-6.1.1.1">
                  <p id="section-3.2.1-6.1.1.1.1"><code>controlSequence</code> is a sequence of controls. The controls defined in
   this document are found in <a href="#Controls" class="auto internal xref">Section 6</a>. Controls can be defined by
   other parties. Details on the TaggedAttribute structure can be
   found in <a href="#ControlSyntax" class="auto internal xref">Section 3.2.1.1</a>.<a href="#section-3.2.1-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1-7.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1-7.1.1.1">
                  <p id="section-3.2.1-7.1.1.1.1"><code>reqSequence</code> is a sequence of certification requests. The
   certification requests can be a CertificationRequest (PKCS #10), a
   CertReqMsg (CRMF), or an externally defined PKI request. Full
   details are found in <a href="#CertificationRequestFormats" class="auto internal xref">Section 3.2.1.2</a>. If an externally defined
   certification request is present, but the server does not
   understand the certification request (or will not process it), a
   CMCStatus of noSupport <span class="bcp14">MUST</span> be returned for the certification
   request item and no other certification requests are processed.<a href="#section-3.2.1-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1-8.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1-8.1.1.1">
                  <p id="section-3.2.1-8.1.1.1.1"><code>cmsSequence</code> is a sequence of <span>[<a href="#CMS" class="cite xref">CMS</a>]</span> message objects. See
   <a href="#ContentInfoObjects" class="auto internal xref">Section 3.2.1.3</a> for more details.<a href="#section-3.2.1-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1-9.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1-9.1.1.1">
                  <p id="section-3.2.1-9.1.1.1.1"><code>otherMsgSequence</code> is a sequence of arbitrary data objects. Data
   objects placed here are referred to by one or more controls. This
   allows for controls to use large amounts of data without the data
   being embedded in the control. See <a href="#OtherMessageBodies" class="auto internal xref">Section 3.2.1.4</a> for more
   details.<a href="#section-3.2.1-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.2.1-10">All certification requests encoded into a single PKIData <span class="bcp14">SHOULD</span> be
for the same identity. RAs that batch process (see <a href="#BatchRequestandResponseControls" class="auto internal xref">Section 6.17</a>) are
expected to place the PKI Requests received into the cmsSequence of a
PKIData.<a href="#section-3.2.1-10" class="pilcrow">¶</a></p>
<p id="section-3.2.1-11">Processing of the PKIData by a recipient is as follows:<a href="#section-3.2.1-11" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2.1-12">
<li id="section-3.2.1-12.1">
              <p id="section-3.2.1-12.1.1">All controls should be examined and processed in an appropriate
manner. The appropriate processing is to complete processing at
this time, to ignore the control, or to place the control on a
to-do list for later processing. Controls can be processed in
any order; the order in the sequence is not significant.<a href="#section-3.2.1-12.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-12.2">
              <p id="section-3.2.1-12.2.1">Items in the reqSequence are not referenced by a control. These
items, which are certification requests, also need to be
processed. As with controls, the appropriate processing can be
either immediate processing or addition to a to-do list for later
processing.<a href="#section-3.2.1-12.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-12.3">
              <p id="section-3.2.1-12.3.1">Finally, the to-do list is processed. In many cases, the to-do
list will be ordered by grouping specific tasks together.<a href="#section-3.2.1-12.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.2.1-13">No processing is required for cmsSequence or otherMsgSequence members
of PKIData if they are present and are not referenced by a control.
In this case, the cmsSequence and otherMsgSequence members are
ignored.<a href="#section-3.2.1-13" class="pilcrow">¶</a></p>
<div id="ControlSyntax">
<section id="section-3.2.1.1">
            <h5 id="name-control-syntax">
<a href="#section-3.2.1.1" class="section-number selfRef">3.2.1.1. </a><a href="#name-control-syntax" class="section-name selfRef">Control Syntax</a>
            </h5>
<p id="section-3.2.1.1-1">The actions to be performed for a PKI Request/Response are based on
the included controls. Each control consists of an object identifier
and a value based on the object identifier.<a href="#section-3.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.1-2">The syntax of a control is:<a href="#section-3.2.1.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.1.1-3">
<pre>
  TaggedAttribute ::= SEQUENCE {
    bodyPartID         BodyPartID,
    attrType           OBJECT IDENTIFIER,
    attrValues         SET OF AttributeValue
  }

  AttributeValue ::= ANY
</pre><a href="#section-3.2.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1.1-4">The fields in TaggedAttribute have the following meaning:<a href="#section-3.2.1.1-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.1-5.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.1-5.1.1.1">
                    <p id="section-3.2.1.1-5.1.1.1.1">bodyPartID is a unique integer that identifies this control.<a href="#section-3.2.1.1-5.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.1-6.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.1-6.1.1.1">
                    <p id="section-3.2.1.1-6.1.1.1.1">attrType is the OID that identifies the control.<a href="#section-3.2.1.1-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.1-7.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.1-7.1.1.1">
                    <p id="section-3.2.1.1-7.1.1.1.1">attrValues is the data values used in processing the control. The
   structure of the data is dependent on the specific
   control.<a href="#section-3.2.1.1-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<p id="section-3.2.1.1-8">The final server <span class="bcp14">MUST</span> fail the processing of an entire PKIData if any
included control is not recognized, that control is not already
marked as processed by a Control Processed control (see <a href="#ControlProcessedControl" class="auto internal xref">Section 6.19</a>)
and no other error is generated. The PKI Response <span class="bcp14">MUST</span> include a
CMCFailInfo value with the value badRequest and the bodyList <span class="bcp14">MUST</span>
contain the bodyPartID of the invalid or unrecognized control(s). A
server is the final server if and only if it is not passing the PKI
Request on to another server. A server is not considered to be the
final server if the server would have passed the PKI Request on, but
instead it returned a processing error.<a href="#section-3.2.1.1-8" class="pilcrow">¶</a></p>
<p id="section-3.2.1.1-9">The controls defined by this document are found in Section 6.<a href="#section-3.2.1.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CertificationRequestFormats">
<section id="section-3.2.1.2">
            <h5 id="name-certification-request-forma">
<a href="#section-3.2.1.2" class="section-number selfRef">3.2.1.2. </a><a href="#name-certification-request-forma" class="section-name selfRef">Certification Request Formats</a>
            </h5>
<p id="section-3.2.1.2-1">Certification Requests are based on PKCS #10, CRMF, or Other Request
formats. <a href="#PKCS10CertificationSyntax" class="auto internal xref">Section 3.2.1.2.1</a> specifies the requirements for clients
and servers dealing with PKCS #10. <a href="#CRMFCertificationSyntax" class="auto internal xref">Section 3.2.1.2.2</a> specifies the
requirements for clients and servers dealing with CRMF.
<a href="#OtherCertificationRequest" class="auto internal xref">Section 3.2.1.2.3</a> specifies the requirements for clients and servers
dealing with Other Request.<a href="#section-3.2.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.1.2-2">
<pre>
  TaggedRequest ::= CHOICE {
    tcr               [0] TaggedCertificationRequest,
    crm               [1] CertReqMsg,
    orm               [2] SEQUENCE {
      bodyPartID            BodyPartID,
      requestMessageType    OBJECT IDENTIFIER,
      requestMessageValue   ANY DEFINED BY requestMessageType
    }
  }
</pre><a href="#section-3.2.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1.2-3">The fields in TaggedRequest have the following meaning:<a href="#section-3.2.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2-4.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2-4.1.1.1">
                    <p id="section-3.2.1.2-4.1.1.1.1"><code>tcr</code> is a certification request that uses the PKCS #10 syntax.
   Details on PKCS #10 are found in <a href="#PKCS10CertificationSyntax" class="auto internal xref">Section 3.2.1.2.1</a>.<a href="#section-3.2.1.2-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2-5.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2-5.1.1.1">
                    <p id="section-3.2.1.2-5.1.1.1.1"><code>crm</code> is a certification request that uses the CRMF syntax. Details
   on CRMF are found in <a href="#CRMFCertificationSyntax" class="auto internal xref">Section 3.2.1.2.2</a>.<a href="#section-3.2.1.2-5.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2-6.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2-6.1.1.1">
                    <p id="section-3.2.1.2-6.1.1.1.1"><code>orm</code> is an externally defined certification request. One example is
    an attribute certification request.  The fields of this structure
    are:<a href="#section-3.2.1.2-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2-7.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2-7.1.1.1">
                    <ul class="normal">
<li class="normal" id="section-3.2.1.2-7.1.1.1.1.1">
                        <p id="section-3.2.1.2-7.1.1.1.1.1.1"><code>bodyPartID</code> is the identifier number for this certification
    request. Details on body part identifiers are found in
    <a href="#BodyPartIdentification" class="auto internal xref">Section 3.2.2</a>.<a href="#section-3.2.1.2-7.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2-8.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2-8.1.1.1">
                    <ul class="normal">
<li class="normal" id="section-3.2.1.2-8.1.1.1.1.1">
                        <p id="section-3.2.1.2-8.1.1.1.1.1.1"><code>requestMessageType</code> identifies the other request type. These
   values are defined outside of this document.<a href="#section-3.2.1.2-8.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2-9.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2-9.1.1.1">
                    <ul class="normal">
<li class="normal" id="section-3.2.1.2-9.1.1.1.1.1">
                        <p id="section-3.2.1.2-9.1.1.1.1.1.1"><code>requestMessageValue</code> is the data associated with the other request
   type.<a href="#section-3.2.1.2-9.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
<div id="PKCS10CertificationSyntax">
<section id="section-3.2.1.2.1">
              <h6 id="name-pkcs-10-certification-synta">
<a href="#section-3.2.1.2.1" class="section-number selfRef">3.2.1.2.1. </a><a href="#name-pkcs-10-certification-synta" class="section-name selfRef">PKCS #10 Certification Syntax</a>
              </h6>
<p id="section-3.2.1.2.1-1">A certification request based on PKCS #10 uses the following ASN.1
structure:<a href="#section-3.2.1.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.1.2.1-2">
<pre>
  TaggedCertificationRequest ::= SEQUENCE {
    bodyPartID            BodyPartID,
    certificationRequest  CertificationRequest
  }
</pre><a href="#section-3.2.1.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1.2.1-3">The fields in TaggedCertificationRequest have the following meaning:<a href="#section-3.2.1.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2.1-4.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2.1-4.1.1.1">
                      <p id="section-3.2.1.2.1-4.1.1.1.1"><code>bodyPartID</code> is the identifier number for this certification request.
   Details on body part identifiers are found in <a href="#BodyPartIdentification" class="auto internal xref">Section 3.2.2</a>.<a href="#section-3.2.1.2.1-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2.1-5.1">
                  <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2.1-5.1.1.1">
                      <p id="section-3.2.1.2.1-5.1.1.1.1"><code>certificationRequest</code> contains the PKCS-#10-based certification
   request.  Its fields are described in <span>[<a href="#PKCS10" class="cite xref">PKCS10</a>]</span>.<a href="#section-3.2.1.2.1-5.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<p id="section-3.2.1.2.1-6">When producing a certification request based on PKCS #10, clients
<span class="bcp14">MUST</span> produce the certification request with a subject name and public
key. Some PKI products are operated using a central repository of
information to assign subject names upon receipt of a certification
request. To accommodate this mode of operation, the subject field in
a CertificationRequest <span class="bcp14">MAY</span> be NULL, but <span class="bcp14">MUST</span> be present. CAs that
receive a CertificationRequest with a NULL subject field <span class="bcp14">MAY</span> reject
such certification requests. If rejected and a PKI Response is
returned, the CA <span class="bcp14">MUST</span> return a PKI Response with the CMCFailInfo
value with the value badRequest.<a href="#section-3.2.1.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CRMFCertificationSyntax">
<section id="section-3.2.1.2.2">
              <h6 id="name-crmf-certification-syntax">
<a href="#section-3.2.1.2.2" class="section-number selfRef">3.2.1.2.2. </a><a href="#name-crmf-certification-syntax" class="section-name selfRef">CRMF Certification Syntax</a>
              </h6>
<p id="section-3.2.1.2.2-1">A CRMF message uses the following ASN.1 structure (defined in <span>[<a href="#CRMF" class="cite xref">CRMF</a>]</span>
and included here for convenience):<a href="#section-3.2.1.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.1.2.2-2">
<pre>
  CertReqMsg ::= SEQUENCE {
    certReq   CertRequest,
    popo      ProofOfPossession  OPTIONAL,
    -- content depends upon key type
    regInfo   SEQUENCE SIZE(1..MAX) OF
                AttributeTypeAndValue OPTIONAL }

  CertRequest ::= SEQUENCE {
    certReqId     INTEGER,
                    -- ID for matching request and reply
    certTemplate  CertTemplate,
                    -- Selected fields of cert to be issued
    controls      Controls OPTIONAL }
                    -- Attributes affecting issuance

  CertTemplate ::= SEQUENCE {
    version      [0] Version               OPTIONAL,
    serialNumber [1] INTEGER               OPTIONAL,
    signingAlg   [2] AlgorithmIdentifier   OPTIONAL,
    issuer       [3] Name                  OPTIONAL,
    validity     [4] OptionalValidity      OPTIONAL,
    subject      [5] Name                  OPTIONAL,
    publicKey    [6] SubjectPublicKeyInfo  OPTIONAL,
    issuerUID    [7] UniqueIdentifier      OPTIONAL,
    subjectUID   [8] UniqueIdentifier      OPTIONAL,
    extensions   [9] Extensions            OPTIONAL }
</pre><a href="#section-3.2.1.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1.2.2-3">The fields in CertReqMsg are explained in <span>[<a href="#CRMF" class="cite xref">CRMF</a>]</span>.<a href="#section-3.2.1.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.1.2.2-4">This document imposes the following additional restrictions on the
construction and processing of CRMF certification requests:<a href="#section-3.2.1.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2.2-5.1">
                  <p id="section-3.2.1.2.2-5.1.1">When a Full PKI Request includes a CRMF certification request,
  both the subject and publicKey fields in the CertTemplate <span class="bcp14">MUST</span> be
  defined. The subject field can be encoded as NULL, but <span class="bcp14">MUST</span> be
  present.<a href="#section-3.2.1.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2.2-6.1">
                  <p id="section-3.2.1.2.2-6.1.1">When both CRMF and CMC controls exist with equivalent
  functionality, the CMC control <span class="bcp14">SHOULD</span> be used. The CMC control
  <span class="bcp14">MUST</span> override the CRMF control.<a href="#section-3.2.1.2.2-6.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2.2-7.1">
                  <p id="section-3.2.1.2.2-7.1.1">The regInfo field <span class="bcp14">MUST NOT</span> be used on a CRMF certification
  request. Equivalent functionality is provided in the CMC regInfo
  control (<a href="#RegistrationandResponseInformationControls" class="auto internal xref">Section 6.12</a>).<a href="#section-3.2.1.2.2-7.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2.2-8.1">
                  <p id="section-3.2.1.2.2-8.1.1">The indirect method of proving POP is not supported in this
  protocol. One of the other methods (including the direct method
  described in this document) <span class="bcp14">MUST</span> be used. The value of encrCert
  in SubsequentMessage <span class="bcp14">MUST NOT</span> be used.<a href="#section-3.2.1.2.2-8.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.2.2-9.1">
                  <p id="section-3.2.1.2.2-9.1.1">Since the subject and publicKeyValues are always present, the
  POPOSigningKeyInput <span class="bcp14">MUST NOT</span> be used when computing the value for
  POPSigningKey.<a href="#section-3.2.1.2.2-9.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-3.2.1.2.2-10">A server is not required to use all of the values suggested by the
client in the CRMF certification request. Servers <span class="bcp14">MUST</span> be able to
process all extensions defined, but not prohibited in <span>[<a href="#PKIXCERT" class="cite xref">PKIXCERT</a>]</span>.
Servers are not required to be able to process other X.509v3
extensions transmitted using this protocol, nor are they required to
be able to process private extensions. Servers are permitted to
modify client-requested extensions. Servers <span class="bcp14">MUST NOT</span> alter an
extension so as to invalidate the original intent of a client-
requested extension. (For example, change key usage from
keyAgreement to digitalSignature.) If a certification request is
denied due to the inability to handle a requested extension, the
server <span class="bcp14">MUST</span> respond with a Full PKI Response with a CMCFailInfo value
with the value of unsupportedExt.<a href="#section-3.2.1.2.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="OtherCertificationRequest">
<section id="section-3.2.1.2.3">
              <h6 id="name-other-certification-request">
<a href="#section-3.2.1.2.3" class="section-number selfRef">3.2.1.2.3. </a><a href="#name-other-certification-request" class="section-name selfRef">Other Certification Request</a>
              </h6>
<p id="section-3.2.1.2.3-1">This document allows for other certification request formats to be
defined and used as well. An example of an other certification
request format is one for Attribute Certificates. These other
certification request formats are defined by specifying an OID for
identification and the structure to contain the data to be passed.<a href="#section-3.2.1.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ContentInfoObjects">
<section id="section-3.2.1.3">
            <h5 id="name-content-info-objects">
<a href="#section-3.2.1.3" class="section-number selfRef">3.2.1.3. </a><a href="#name-content-info-objects" class="section-name selfRef">Content Info Objects</a>
            </h5>
<p id="section-3.2.1.3-1">The <code>cmsSequence</code> field of the <code>PKIData</code> and <code>PKIResponse</code> messages
contains zero or more tagged content info objects. The syntax for
this structure is:<a href="#section-3.2.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.1.3-2">
<pre>
  TaggedContentInfo ::= SEQUENCE {
    bodyPartID              BodyPartID,
    contentInfo             ContentInfo
  }
</pre><a href="#section-3.2.1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1.3-3">The fields in <code>TaggedContentInfo</code> have the following meaning:<a href="#section-3.2.1.3-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.3-4.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.3-4.1.1.1">
                    <p id="section-3.2.1.3-4.1.1.1.1"><code>bodyPartID</code> is a unique integer that identifies this content info
   object.<a href="#section-3.2.1.3-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.3-5.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.3-5.1.1.1">
                    <p id="section-3.2.1.3-5.1.1.1.1"><code>contentInfo</code> is a ContentInfo object (defined in <span>[<a href="#CMS" class="cite xref">CMS</a>]</span>).<a href="#section-3.2.1.3-5.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<p id="section-3.2.1.3-6">The four content types used in <code>cmsSequence</code> are <code>AuthenticatedData</code>,
<code>Data</code>, <code>EnvelopedData</code>, and <code>SignedData</code>. All of these content types are
defined in <span>[<a href="#CMS" class="cite xref">CMS</a>]</span>.<a href="#section-3.2.1.3-6" class="pilcrow">¶</a></p>
<div id="AuthenticatedData">
<section id="section-3.2.1.3.1">
              <h6 id="name-authenticated-data">
<a href="#section-3.2.1.3.1" class="section-number selfRef">3.2.1.3.1. </a><a href="#name-authenticated-data" class="section-name selfRef">Authenticated Data</a>
              </h6>
<p id="section-3.2.1.3.1-1">The <code>AuthenticatedData</code> content type provides a method of doing pre-
shared-secret-based validation of data being sent between two
parties. Unlike <code>SignedData</code>, it does not specify which party actually
generated the information.<a href="#section-3.2.1.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3.1-2"><code>AuthenticatedData</code> provides origination authentication in those
circumstances where a shared-secret exists, but a PKI-based trust has
not yet been established. No PKI-based trust may have been
established because a trust anchor has not been installed on the
client or no certificate exists for a signing key.<a href="#section-3.2.1.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3.1-3"><code>AuthenticatedData</code> content type is used by this document for:<a href="#section-3.2.1.3.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.3.1-4.1">
                  <p id="section-3.2.1.3.1-4.1.1">The id-cmc-authData control (<a href="#AuthenticatedDataControl" class="auto internal xref">Section 6.16</a>), and<a href="#section-3.2.1.3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.3.1-5.1">
                  <p id="section-3.2.1.3.1-5.1.1">The top-level wrapper in environments where an encryption-only key
  is being certified or where a shared-secret exists, but a PKI-based
  trust (needed for SignedData) has not yet been established.<a href="#section-3.2.1.3.1-5.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-3.2.1.3.1-6">This content type can include both PKIData and PKIResponse as the
encapsulated content types. These embedded content types can contain
additional controls that need to be processed.<a href="#section-3.2.1.3.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Data">
<section id="section-3.2.1.3.2">
              <h6 id="name-data">
<a href="#section-3.2.1.3.2" class="section-number selfRef">3.2.1.3.2. </a><a href="#name-data" class="section-name selfRef">Data</a>
              </h6>
<p id="section-3.2.1.3.2-1">The Data content type allows for general transport of unstructured
data.<a href="#section-3.2.1.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3.2-2">The Data content type is used by this document for:<a href="#section-3.2.1.3.2-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.3.2-3.1">
                  <p id="section-3.2.1.3.2-3.1.1">Holding the encrypted random value y for POP proof in the
  encrypted POP control (see <a href="#EncryptedandDecryptedPOPControls" class="auto internal xref">Section 6.7</a>).<a href="#section-3.2.1.3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</section>
</div>
<div id="EnvelopedData">
<section id="section-3.2.1.3.3">
              <h6 id="name-enveloped-data">
<a href="#section-3.2.1.3.3" class="section-number selfRef">3.2.1.3.3. </a><a href="#name-enveloped-data" class="section-name selfRef">Enveloped Data</a>
              </h6>
<p id="section-3.2.1.3.3-1">The <code>EnvelopedData</code> content type provides for shrouding of data.<a href="#section-3.2.1.3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3.3-2">The <code>EnvelopedData</code> content type is the primary confidentiality method
for sensitive information in this protocol. <code>EnvelopedData</code> can
provide encryption of an entire PKI Request (see <a href="#ApplicationofEncryptiontoaPKIRequestResponse" class="auto internal xref">Section 5</a>).
<code>EnvelopedData</code> can also be used to wrap private key material for key
archival. If the decryption on an EnvelopedData fails, a Full PKI
Response is returned with a <code>CMCFailInfo</code> value of <code>badMessageCheck</code> and
a <code>bodyPartID</code> of 0.<a href="#section-3.2.1.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SignedData">
<section id="section-3.2.1.3.4">
              <h6 id="name-signed-data">
<a href="#section-3.2.1.3.4" class="section-number selfRef">3.2.1.3.4. </a><a href="#name-signed-data" class="section-name selfRef">Signed Data</a>
              </h6>
<p id="section-3.2.1.3.4-1">The <code>SignedData</code> content type provides for authentication and
integrity.<a href="#section-3.2.1.3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3.4-2">The <code>SignedData</code> content type is used by this document for:<a href="#section-3.2.1.3.4-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.3.4-3.1">
                  <p id="section-3.2.1.3.4-3.1.1">The outer wrapper for a PKI Request.<a href="#section-3.2.1.3.4-3.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.3.4-4.1">
                  <p id="section-3.2.1.3.4-4.1.1">The outer wrapper for a PKI Response.<a href="#section-3.2.1.3.4-4.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-3.2.1.3.4-5">As part of processing a PKI Request/Response, the signature(s) <span class="bcp14">MUST</span>
be verified. If the signature does not verify and the PKI Request/
Response contains anything other than a CMC Status Info control, a
Full PKI Response containing a CMC Status Info control <span class="bcp14">MUST</span> be
returned using a <code>CMCFailInfo</code> with a value of <code>badMessageCheck</code> and a
<code>bodyPartID</code> of 0.<a href="#section-3.2.1.3.4-5" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3.4-6">For the PKI Response, <code>SignedData</code> allows the server to sign the
returning data, if any exists, and to carry the certificates and CRLs
corresponding to the PKI Request. If no data is being returned
beyond the certificates and CRLs, there is no 'eContent' field in the
'EncapsulatedContentInfo' and no 'SignerInfo'.<a href="#section-3.2.1.3.4-6" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3.4-7">Only if the server is unable to sign the response (and unable to use
any <code>RecipientInfo</code> options of the <code>AuthenticatedData</code> content type),
and at the same time it should send a negative response,
Full PKI Response <code>SignedData</code> type containing a CMC Status Info control
<span class="bcp14">MUST</span> be returned using a <code>CMCFailInfo</code> with a value of internalCAError and
a <code>bodyPartID</code> of 0, and the eContent field in the <code>EncapsulatedContentInfo</code>
as well as <code>SignerInfo</code> fields <span class="bcp14">MUST</span> not be populated.<a href="#section-3.2.1.3.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="OtherMessageBodies">
<section id="section-3.2.1.4">
            <h5 id="name-other-message-bodies">
<a href="#section-3.2.1.4" class="section-number selfRef">3.2.1.4. </a><a href="#name-other-message-bodies" class="section-name selfRef">Other Message Bodies</a>
            </h5>
<p id="section-3.2.1.4-1">The otherMsgSequence field of the PKI Request/Response allows for
arbitrary data objects to be carried as part of a PKI Request/
Response. This is intended to contain a data object that is not
already wrapped in a cmsSequence field <a href="#ContentInfoObjects" class="auto internal xref">Section 3.2.1.3</a>. The data
object is ignored unless a control references the data object by
bodyPartID.<a href="#section-3.2.1.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.1.4-2">
<pre>
  OtherMsg ::= SEQUENCE {
    bodyPartID        BodyPartID,
    otherMsgType      OBJECT IDENTIFIER,
    otherMsgValue     ANY DEFINED BY otherMsgType }
</pre><a href="#section-3.2.1.4-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1.4-3">The fields in OtherMsg have the following meaning:<a href="#section-3.2.1.4-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.4-4.1">
                <p id="section-3.2.1.4-4.1.1">bodyPartID is the unique id identifying this data object.<a href="#section-3.2.1.4-4.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.4-5.1">
                <p id="section-3.2.1.4-5.1.1">otherMsgType is the OID that defines the type of message body.<a href="#section-3.2.1.4-5.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.1.4-6.1">
                <p id="section-3.2.1.4-6.1.1">otherMsgValue is the data.<a href="#section-3.2.1.4-6.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="BodyPartIdentification">
<section id="section-3.2.2">
          <h4 id="name-body-part-identification">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-body-part-identification" class="section-name selfRef">Body Part Identification</a>
          </h4>
<p id="section-3.2.2-1">Each element of a PKIData or PKIResponse has an associated body part
identifier. The body part identifier is a 4-octet integer using the
ASN.1 of:<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.2-2">
<pre>
  bodyIdMax INTEGER ::= 4294967295

  BodyPartID ::= INTEGER(0..bodyIdMax)
</pre><a href="#section-3.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.2-3">Body part identifiers are encoded in the certReqIds field for
CertReqMsg objects (in a TaggedRequest) or in the bodyPartID field of
the other objects. The body part identifier <span class="bcp14">MUST</span> be unique within a
single PKIData or PKIResponse. Body part identifiers can be
duplicated in different layers (for example, a PKIData embedded
within another).<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2-4">The bodyPartID value of 0 is reserved for use as the reference to the
current PKIData object.<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2.2-5">Some controls, such as the Add Extensions control <a href="#AddExtensionsControl" class="auto internal xref">Section 6.5.2</a>,
use the body part identifier in the pkiDataReference field to refer
to a PKI Request in the current PKIData. Some controls, such as the
Extended CMC Status Info control <a href="#extCMCStatusInfo" class="auto internal xref">Section 6.1.1</a>, will also use body
part identifiers to refer to elements in the previous PKI Request/
Response. This allows an error to be explicit about the control or
PKI Request to which the error applies.<a href="#section-3.2.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2.2-6">A BodyPartList contains a list of body parts in a PKI Request/
Response (i.e., the Batch Request control in <a href="#BatchRequestandResponseControls" class="auto internal xref">Section 6.17</a>). The
ASN.1 type BodyPartList is defined as:<a href="#section-3.2.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.2-7">
<pre>
  BodyPartList ::= SEQUENCE SIZE (1..MAX) OF BodyPartID
</pre><a href="#section-3.2.2-7" class="pilcrow">¶</a>
</div>
<p id="section-3.2.2-8">A BodyPartPath contains a path of body part identifiers moving
through nesting (i.e., the Modify Certification Request control in
<a href="#ModifyCertificationRequestControl" class="auto internal xref">Section 6.5.1</a>). The ASN.1 type BodyPartPath is defined as:<a href="#section-3.2.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.2-9">
<pre>
  BodyPartPath ::= SEQUENCE SIZE (1..MAX) OF BodyPartID
</pre><a href="#section-3.2.2-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="CMCUnsignedDataAttribute">
<section id="section-3.2.3">
          <h4 id="name-cmc-unsigned-data-attribute">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-cmc-unsigned-data-attribute" class="section-name selfRef">CMC Unsigned Data Attribute</a>
          </h4>
<p id="section-3.2.3-1">There is sometimes a need to include data in a PKI Request designed
to be removed by an RA during processing. An example of this is the
inclusion of an encrypted private key, where a Key Archive Agent
removes the encrypted private key before sending it on to the CA.
One side effect of this desire is that every RA that encapsulates
this information needs to move the data so that it is not covered by
that RA's signature. (A client PKI Request encapsulated by an RA
cannot have a signed control removed by the Key Archive Agent without
breaking the RA's signature.) The CMC Unsigned Data attribute
addresses this problem.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.3-2">The CMC Unsigned Data attribute contains information that is not
directly signed by a client. When an RA encounters this attribute in
the unsigned or unauthenticated attribute field of a request it is
aggregating, the CMC Unsigned Data attribute is removed from the
request prior to placing the request in a cmsSequence and placed in
the unsigned or unauthenticated attributes of the RA's signed or
authenticated data wrapper.<a href="#section-3.2.3-2" class="pilcrow">¶</a></p>
<p id="section-3.2.3-3">The CMC Unsigned Data attribute is identified by:<a href="#section-3.2.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.3-4">
<pre>
  id-aa-cmc-unsignedData OBJECT IDENTIFIER ::= { id-aa 34 }
</pre><a href="#section-3.2.3-4" class="pilcrow">¶</a>
</div>
<p id="section-3.2.3-5">The CMC Unsigned Data attribute has the ASN.1 definition:<a href="#section-3.2.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.3-6">
<pre>
  CMCUnsignedData ::= SEQUENCE {
    bodyPartPath        BodyPartPath,
    identifier          OBJECT IDENTIFIER,
    content             ANY DEFINED BY identifier
  }
</pre><a href="#section-3.2.3-6" class="pilcrow">¶</a>
</div>
<p id="section-3.2.3-7">The fields in CMCUnsignedData have the following meaning:<a href="#section-3.2.3-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.3-8.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.3-8.1.1.1">
                  <p id="section-3.2.3-8.1.1.1.1">bodyPartPath is the path pointing to the control associated with
   this data. When an RA moves the control in an unsigned or
   unauthenticated attribute up one level as part of wrapping the
   data in a new SignedData or AuthenticatedData, the body part
   identifier of the embedded item in the PKIData is prepended to the
   bodyPartPath sequence.<a href="#section-3.2.3-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.3-9.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.3-9.1.1.1">
                  <p id="section-3.2.3-9.1.1.1.1">identifier is the OID that defines the associated data.<a href="#section-3.2.3-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.3-10.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2.3-10.1.1.1">
                  <p id="section-3.2.3-10.1.1.1.1">content is the data.<a href="#section-3.2.3-10.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.2.3-11">There <span class="bcp14">MUST</span> be at most one CMC Unsigned Data attribute in the
UnsignedAttribute sequence of a SignerInfo or in the
UnauthenticatedAttribute sequence of an AuthenticatedData.
UnsignedAttribute consists of a set of values; the attribute can have
any number of values greater than zero in that set. If the CMC
Unsigned Data attribute is in one SignerInfo or AuthenticatedData, it
<span class="bcp14">MUST</span> appear with the same values(s) in all SignerInfo and
AuthenticatedData items.<a href="#section-3.2.3-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="PKIResponses">
<section id="section-4">
      <h2 id="name-pki-responses">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-pki-responses" class="section-name selfRef">PKI Responses</a>
      </h2>
<p id="section-4-1">Two types of PKI Responses exist. This section gives the details on
both types.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="SimplePKIResponse">
<section id="section-4.1">
        <h3 id="name-simple-pki-response">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-simple-pki-response" class="section-name selfRef">Simple PKI Response</a>
        </h3>
<p id="section-4.1-1">Clients <span class="bcp14">MUST</span> be able to process the Simple PKI Response. The Simple
PKI Response consists of a SignedData with no EncapsulatedContentInfo
and no SignerInfo. The certificates requested in the PKI Response
are returned in the certificate field of the SignedData.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Clients <span class="bcp14">MUST NOT</span> assume the certificates are in any order. Servers
<span class="bcp14">SHOULD</span> include all intermediate certificates needed to form complete
certification paths to one or more trust anchors, not just the newly
issued certificate(s). The server <span class="bcp14">MAY</span> additionally return CRLs in
the CRL bag. Servers <span class="bcp14">MAY</span> include the self-signed certificates.
Clients <span class="bcp14">MUST NOT</span> implicitly trust included self-signed certificate(s)
merely due to its presence in the certificate bag. In the event
clients receive a new self-signed certificate from the server,
clients <span class="bcp14">SHOULD</span> provide a mechanism to enable the user to use the
certificate as a trust anchor. (The Publish Trust Anchors control
(<a href="#PublishTrustAnchorsControl" class="auto internal xref">Section 6.15</a>) should be used in the event that the server intends
the client to accept one or more certificates as trust anchors. This
requires the use of the Full PKI Response message.)<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="FullPKIResponse">
<section id="section-4.2">
        <h3 id="name-full-pki-response">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-full-pki-response" class="section-name selfRef">Full PKI Response</a>
        </h3>
<p id="section-4.2-1">Clients <span class="bcp14">MUST</span> be able to process a Full PKI Response.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The Full PKI Response consists of a SignedData or AuthenticatedData
encapsulating a PKIResponse content type. The certificates issued in
a PKI Response are returned in the certificates field of the
immediately encapsulating SignedData.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Clients <span class="bcp14">MUST NOT</span> assume the certificates are in any order. Servers
<span class="bcp14">SHOULD</span> include all intermediate certificates needed to form complete
chains to one or more trust anchors, not just the newly issued
certificate(s). The server <span class="bcp14">MAY</span> additionally return CRLs in the CRL
bag. Servers <span class="bcp14">MAY</span> include self-signed certificates. Clients <span class="bcp14">MUST NOT</span>
implicitly trust included self-signed certificate(s) merely due to
its presence in the certificate bag. In the event clients receive a
new self-signed certificate from the server, clients <span class="bcp14">MAY</span> provide a
mechanism to enable the user to explicitly use the certificate as a
trust anchor. (The Publish Trust Anchors control (<a href="#PublishTrustAnchorsControl" class="auto internal xref">Section 6.15</a>)
exists for the purpose of allowing for distribution of trust anchor
certificates. If a trusted anchor publishes a new trusted anchor,
this is one case where automated trust of the new trust anchor could
be allowed.)<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<div id="PKIResponseContentType">
<section id="section-4.2.1">
          <h4 id="name-pkiresponse-content-type">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-pkiresponse-content-type" class="section-name selfRef">PKIResponse Content Type</a>
          </h4>
<p id="section-4.2.1-1">The PKIResponse content type is used for the Full PKI Response. The
PKIResponse content type is identified by:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-2">
<pre>
  id-cct-PKIResponse OBJECT IDENTIFIER ::= { id-pkix id-cct(12) 3  }
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-3">The ASN.1 structure corresponding to the PKIResponse content type is:<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-4">
<pre>
  PKIResponse ::= SEQUENCE {
    controlSequence   SEQUENCE SIZE(0..MAX) OF TaggedAttribute,
    cmsSequence       SEQUENCE SIZE(0..MAX) OF TaggedContentInfo,
    otherMsgSequence  SEQUENCE SIZE(0..MAX) OF OtherMsg
    }

    ReponseBody ::= PKIResponse
</pre><a href="#section-4.2.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-5">Note: In <span>[<a href="#RFC2797" class="cite xref">RFC2797</a>]</span>, this ASN.1 type was named ResponseBody. It has
been renamed to PKIResponse for clarity and the old name kept as a
synonym.<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
<p id="section-4.2.1-6">The fields in PKIResponse have the following meaning:<a href="#section-4.2.1-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-7.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-7.1.1.1">
                  <p id="section-4.2.1-7.1.1.1.1">controlSequence is a sequence of controls. The controls defined in
   this document are found in Section 6. Controls can be defined by
   other parties. Details on the TaggedAttribute structure are found
  in <a href="#ControlSyntax" class="auto internal xref">Section 3.2.1.1</a>.<a href="#section-4.2.1-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-8.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-8.1.1.1">
                  <p id="section-4.2.1-8.1.1.1.1">cmsSequence is a sequence of <span>[<a href="#CMS" class="cite xref">CMS</a>]</span> message objects. See
   <a href="#ContentInfoObjects" class="auto internal xref">Section 3.2.1.3</a> for more details.<a href="#section-4.2.1-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-9.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-9.1.1.1">
                  <p id="section-4.2.1-9.1.1.1.1">otherMsgSequence is a sequence of arbitrary data objects. Data
   objects placed here are referred to by one or more controls. This
   allows for controls to use large amounts of data without the data
   being embedded in the control. See <a href="#OtherMessageBodies" class="auto internal xref">Section 3.2.1.4</a> for more
   details.<a href="#section-4.2.1-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.1-10">Processing of PKIResponse by a recipient is as follows:<a href="#section-4.2.1-10" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.1-11">
<li id="section-4.2.1-11.1">
              <p id="section-4.2.1-11.1.1">All controls should be examined and processed in an appropriate
manner. The appropriate processing is to complete processing at
this time, to ignore the control, or to place the control on a
to-do list for later processing.<a href="#section-4.2.1-11.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.1-11.2">
              <p id="section-4.2.1-11.2.1">Additional processing of non-element items includes the saving of
certificates and CRLs present in wrapping layers. This type of
processing is based on the consumer of the element and should not
be relied on by generators.<a href="#section-4.2.1-11.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-4.2.1-12">No processing is required for cmsSequence or otherMsgSequence members
of the PKIResponse, if items are present and are not referenced by a
control. In this case, the cmsSequence and otherMsgSequence members
are to be ignored.<a href="#section-4.2.1-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ApplicationofEncryptiontoaPKIRequestResponse">
<section id="section-5">
      <h2 id="name-application-of-encryption-t">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-application-of-encryption-t" class="section-name selfRef">Application of Encryption to a PKI Request/Response</a>
      </h2>
<p id="section-5-1">There are occasions when a PKI Request or Response must be encrypted
in order to prevent disclosure of information in the PKI Request/
Response from being accessible to unauthorized entities. This
section describes the means to encrypt Full PKI Requests and
Responses (Simple PKI Requests cannot be encrypted). Data portions
of PKI Requests and Responses that are placed in the cmsSequence
field can be encrypted separately.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Confidentiality is provided by wrapping the PKI Request/Response (a
SignedData) in an EnvelopedData. The nested content type in the
EnvelopedData is id-SignedData. Note that this is different from
S/MIME where there is a MIME layer placed between the encrypted and
signed data. It is recommended that if an EnvelopedData layer is
applied to a PKI Request/Response, a second signature layer be placed
outside of the EnvelopedData layer. The following figure shows how
this nesting would be done:<a href="#section-5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-3">
<pre>
  Normal              Option 1                  Option 2
  ------              --------                  --------
   SignedData          EnvelopedData             SignedData
     PKIData             SignedData                EnvelopedData
                           PKIData                   SignedData
                                                       PKIData
</pre><a href="#section-5-3" class="pilcrow">¶</a>
</div>
<p id="section-5-4">Note: PKIResponse can be substituted for PKIData in the above figure.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">Options 1 and 2 prevent leakage of sensitive data by encrypting the
Full PKI Request/Response. An RA that receives a PKI Request that it
cannot decrypt <span class="bcp14">MAY</span> reject the PKI Request unless it can process the
PKI Request without knowledge of the contents (i.e., all it does is
amalgamate multiple PKI Requests and forward them to a server).<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">After the RA removes the envelope and completes processing, it may
then apply a new EnvelopedData layer to protect PKI Requests for
transmission to the next processing agent. Section 7 contains more
information about RA processing.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">Full PKI Requests/Responses can be encrypted or transmitted in the
clear. Servers <span class="bcp14">MUST</span> provide support for all three options.<a href="#section-5-7" class="pilcrow">¶</a></p>
<p id="section-5-8">Alternatively, an authenticated, secure channel could exist between
the parties that require confidentiality. Clients and servers <span class="bcp14">MAY</span>
use such channels instead of the technique described above to provide
secure, private communication of Simple and Full PKI Requests/
Responses.<a href="#section-5-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Controls">
<section id="section-6">
      <h2 id="name-controls">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-controls" class="section-name selfRef">Controls</a>
      </h2>
<p id="section-6-1">Controls are carried as part of both Full PKI Requests and Responses.
Each control is encoded as a unique OID followed by the data for the
control (see syntax in <a href="#ControlSyntax" class="auto internal xref">Section 3.2.1.1</a>). The encoding of the data is
based on the control. Processing systems would first detect the OID
(TaggedAttribute attrType) and process the corresponding control
value (TaggedAttribute attrValues) prior to processing the message
body.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The OIDs are all defined under the following arc:<a href="#section-6-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-3">
<pre>
  id-pkix OBJECT IDENTIFIER  ::= { iso(1) identified-organization(3)
    dod(6) internet(1) security(5) mechanisms(5) pkix(7) }

  id-cmc OBJECT IDENTIFIER ::= { id-pkix 7 }
</pre><a href="#section-6-3" class="pilcrow">¶</a>
</div>
<p id="section-6-4">The following table lists the names, OID, and syntactic structure for
each of the controls described in this document.<a href="#section-6-4" class="pilcrow">¶</a></p>
<span id="name-cmc-control-attributes"></span><div id="ctrl-attrs">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-cmc-control-attributes" class="selfRef">CMC Control Attributes</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Identifier Description</th>
            <th class="text-left" rowspan="1" colspan="1">OID</th>
            <th class="text-left" rowspan="1" colspan="1">ASN.1 Structure</th>
            <th class="text-left" rowspan="1" colspan="1">Section</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-statusInfo</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 1</td>
            <td class="text-left" rowspan="1" colspan="1">CMCStatusInfo</td>
            <td class="text-left" rowspan="1" colspan="1">6.1.2</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-identification</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 2</td>
            <td class="text-left" rowspan="1" colspan="1">UTF8String</td>
            <td class="text-left" rowspan="1" colspan="1">6.2.3</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-identityProof</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 3</td>
            <td class="text-left" rowspan="1" colspan="1">OCTET STRING</td>
            <td class="text-left" rowspan="1" colspan="1">6.2.2</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-dataReturn</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 4</td>
            <td class="text-left" rowspan="1" colspan="1">OCTET STRING</td>
            <td class="text-left" rowspan="1" colspan="1">6.4</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-transactionId</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 5</td>
            <td class="text-left" rowspan="1" colspan="1">INTEGER</td>
            <td class="text-left" rowspan="1" colspan="1">6.6</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-senderNonce</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 6</td>
            <td class="text-left" rowspan="1" colspan="1">OCTET STRING</td>
            <td class="text-left" rowspan="1" colspan="1">6.6</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-recipientNonce</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 7</td>
            <td class="text-left" rowspan="1" colspan="1">OCTET STRING</td>
            <td class="text-left" rowspan="1" colspan="1">6.6</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-addExtensions</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 8</td>
            <td class="text-left" rowspan="1" colspan="1">AddExtensions</td>
            <td class="text-left" rowspan="1" colspan="1">6.5.2</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-encryptedPOP</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 9</td>
            <td class="text-left" rowspan="1" colspan="1">EncryptedPOP</td>
            <td class="text-left" rowspan="1" colspan="1">6.7</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-decryptedPOP</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 10</td>
            <td class="text-left" rowspan="1" colspan="1">DecryptedPOP</td>
            <td class="text-left" rowspan="1" colspan="1">6.7</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-lraPOPWitness</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 11</td>
            <td class="text-left" rowspan="1" colspan="1">LraPOPWitness</td>
            <td class="text-left" rowspan="1" colspan="1">6.8</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-getCert</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 15</td>
            <td class="text-left" rowspan="1" colspan="1">GetCert</td>
            <td class="text-left" rowspan="1" colspan="1">6.9</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-getCRL</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 16</td>
            <td class="text-left" rowspan="1" colspan="1">GetCRL</td>
            <td class="text-left" rowspan="1" colspan="1">6.10</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-revokeRequest</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 17</td>
            <td class="text-left" rowspan="1" colspan="1">RevokeRequest</td>
            <td class="text-left" rowspan="1" colspan="1">6.11</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-regInfo</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 18</td>
            <td class="text-left" rowspan="1" colspan="1">OCTET STRING</td>
            <td class="text-left" rowspan="1" colspan="1">6.12</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-responseInfo</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 19</td>
            <td class="text-left" rowspan="1" colspan="1">OCTET STRING</td>
            <td class="text-left" rowspan="1" colspan="1">6.12</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-queryPending</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 21</td>
            <td class="text-left" rowspan="1" colspan="1">OCTET STRING</td>
            <td class="text-left" rowspan="1" colspan="1">6.13</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-popLinkRandom</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 22</td>
            <td class="text-left" rowspan="1" colspan="1">OCTET STRING</td>
            <td class="text-left" rowspan="1" colspan="1">6.3.1</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-popLinkWitness</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 23</td>
            <td class="text-left" rowspan="1" colspan="1">OCTET STRING</td>
            <td class="text-left" rowspan="1" colspan="1">6.3.1</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-popLinkWitnessV2</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 33</td>
            <td class="text-left" rowspan="1" colspan="1">OCTET STRING</td>
            <td class="text-left" rowspan="1" colspan="1">6.3.1.1</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-confirmCertAcceptance</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 24</td>
            <td class="text-left" rowspan="1" colspan="1">CMCCertId</td>
            <td class="text-left" rowspan="1" colspan="1">6.14</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-statusInfoV2</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 25</td>
            <td class="text-left" rowspan="1" colspan="1">CMCStatusInfoV2</td>
            <td class="text-left" rowspan="1" colspan="1">6.1.1</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-trustedAnchors</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 26</td>
            <td class="text-left" rowspan="1" colspan="1">PublishTrustAnchors</td>
            <td class="text-left" rowspan="1" colspan="1">6.15</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-authData</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 27</td>
            <td class="text-left" rowspan="1" colspan="1">AuthPublish</td>
            <td class="text-left" rowspan="1" colspan="1">6.16</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-batchRequests</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 28</td>
            <td class="text-left" rowspan="1" colspan="1">BodyPartList</td>
            <td class="text-left" rowspan="1" colspan="1">6.17</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-batchResponses</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 29</td>
            <td class="text-left" rowspan="1" colspan="1">BodyPartList</td>
            <td class="text-left" rowspan="1" colspan="1">6.17</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-publishCert</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 30</td>
            <td class="text-left" rowspan="1" colspan="1">CMCPublicationInfo</td>
            <td class="text-left" rowspan="1" colspan="1">6.18</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-modCertTemplate</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 31</td>
            <td class="text-left" rowspan="1" colspan="1">ModCertTemplate</td>
            <td class="text-left" rowspan="1" colspan="1">6.5.1</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-controlProcessed</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 32</td>
            <td class="text-left" rowspan="1" colspan="1">ControlsProcessed</td>
            <td class="text-left" rowspan="1" colspan="1">6.19</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-identityProofV2</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 34</td>
            <td class="text-left" rowspan="1" colspan="1">IdentityProofV2</td>
            <td class="text-left" rowspan="1" colspan="1">6.2.1</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-raIdentityWitness</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 35</td>
            <td class="text-left" rowspan="1" colspan="1">BodyPartPath</td>
            <td class="text-left" rowspan="1" colspan="1">6.20</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-cmc-responseBody</td>
            <td class="text-left" rowspan="1" colspan="1">id-cmc 37</td>
            <td class="text-left" rowspan="1" colspan="1">BodyPartPath</td>
            <td class="text-left" rowspan="1" colspan="1">6.21</td>
          </tr>
        </tbody>
      </table>
</div>
<div id="xtCMCStatusInfo">
<section id="section-6.1">
        <h3 id="name-cmc-status-info-controls">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-cmc-status-info-controls" class="section-name selfRef">CMC Status Info Controls</a>
        </h3>
<p id="section-6.1-1">The CMC Status Info controls return information about the status of a
client/server request/response. Two controls are described in this
section. The Extended CMC Status Info control is the preferred
control; the CMC Status Info control is included for backwards
compatibility with RFC 2797.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Servers <span class="bcp14">MAY</span> emit multiple CMC status info controls referring to a
single body part. Clients <span class="bcp14">MUST</span> be able to deal with multiple CMC
status info controls in a PKI Response. Servers <span class="bcp14">MUST</span> use the
Extended CMC Status Info control, but <span class="bcp14">MAY</span> additionally use the CMC
Status Info control. Clients <span class="bcp14">MUST</span> be able to process the Extended<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">CMC Status Info control.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<div id="extCMCStatusInfo">
<section id="section-6.1.1">
          <h4 id="name-extended-cmc-status-info-co">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-extended-cmc-status-info-co" class="section-name selfRef">Extended CMC Status Info Control</a>
          </h4>
<p id="section-6.1.1-1">The Extended CMC Status Info control is identified by the OID:<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.1-2">
<pre>
  id-cmc-statusInfoV2 OBJECT IDENTIFIER ::= { id-cmc 25 }
</pre><a href="#section-6.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1.1-3">The Extended CMC Status Info control has the ASN.1 definition:<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.1-4">
<pre>
   CMCStatusInfoV2 ::= SEQUENCE {
      cMCStatus             CMCStatus,
      bodyList              SEQUENCE SIZE (1..MAX) OF
                              BodyPartReference,
      statusString          UTF8String OPTIONAL,
      otherInfo             OtherStatusInfo OPTIONAL
   }

   OtherStatusInfo ::= CHOICE {
      failInfo              CMCFailInfo,
      pendInfo              PendInfo,
      extendedFailInfo      ExtendedFailInfo
   }

   PendInfo ::= SEQUENCE {
      pendToken           OCTET STRING,
      pendTime            GeneralizedTime
   }

   ExtendedFailInfo ::= SEQUENCE {
      failInfoOID            OBJECT IDENTIFIER,
      failInfoValue          ANY DEFINED BY failInfoOID
   }

  BodyPartReference ::= CHOICE {
    bodyPartID           BodyPartID,
    bodyPartPath         BodyPartPath
   }
</pre><a href="#section-6.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-6.1.1-5">The fields in CMCStatusInfoV2 have the following meaning:<a href="#section-6.1.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-6.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-6.1.1.1">
                  <p id="section-6.1.1-6.1.1.1.1">cMCStatus contains the returned status value. Details are in
   <a href="#CMCStatusValues" class="auto internal xref">Section 6.1.3</a>.<a href="#section-6.1.1-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-7.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-7.1.1.1">
                  <p id="section-6.1.1-7.1.1.1.1">bodyList identifies the controls or other elements to which the
   status value applies. If an error is returned for a Simple PKI
   Request, this field is the bodyPartID choice of BodyPartReference
   with the single integer of value 1.<a href="#section-6.1.1-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-8.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-8.1.1.1">
                  <p id="section-6.1.1-8.1.1.1.1">statusString contains additional description information. This
   string is human readable.<a href="#section-6.1.1-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-9.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-9.1.1.1">
                  <p id="section-6.1.1-9.1.1.1.1">otherInfo contains additional information that expands on the CMC
   status code returned in the cMCStatus field.<a href="#section-6.1.1-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.1.1-10">The fields in OtherStatusInfo have the following meaning:<a href="#section-6.1.1-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-11.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-11.1.1.1">
                  <p id="section-6.1.1-11.1.1.1.1">failInfo is described in <a href="#CMCFailInfo" class="auto internal xref">Section 6.1.4</a>. It provides an error code
   that details what failure occurred. This choice is present only
   if cMCStatus contains the value failed.<a href="#section-6.1.1-11.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-12.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-12.1.1.1">
                  <p id="section-6.1.1-12.1.1.1.1">pendInfo contains information about when and how the client should
   request the result of this request. It is present when the
   cMCStatus is either pending or partial. pendInfo uses the
   structure PendInfo, which has the fields:<a href="#section-6.1.1-12.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-13.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-13.1.1.1">
                  <ul class="normal">
<li class="normal" id="section-6.1.1-13.1.1.1.1.1">
                      <p id="section-6.1.1-13.1.1.1.1.1.1">pendToken is the token used in the Query Pending control
   (<a href="#QueryPendingControl" class="auto internal xref">Section 6.13</a>).<a href="#section-6.1.1-13.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-14.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-14.1.1.1">
                  <ul class="normal">
<li class="normal" id="section-6.1.1-14.1.1.1.1.1">
                      <p id="section-6.1.1-14.1.1.1.1.1.1">pendTime contains the suggested time the server wants to be
   queried about the status of the certification request.<a href="#section-6.1.1-14.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-15.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-15.1.1.1">
                  <p id="section-6.1.1-15.1.1.1.1">extendedFailInfo includes application-dependent detailed error
   information.  This choice is present only if cMCStatus contains
   the value failed.  Caution should be used when defining new values
   as they may not be correctly recognized by all clients and
   servers.  The CMCFailInfo value of internalCAError may be assumed
   if the extended error is not recognized.  This field uses the type
   ExtendedFailInfo.  ExtendedFailInfo has the fields:<a href="#section-6.1.1-15.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-16.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-16.1.1.1">
                  <ul class="normal">
<li class="normal" id="section-6.1.1-16.1.1.1.1.1">
                      <p id="section-6.1.1-16.1.1.1.1.1.1">failInfoOID contains an OID that is associated with a set of
   extended error values.<a href="#section-6.1.1-16.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-17.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.1-17.1.1.1">
                  <ul class="normal">
<li class="normal" id="section-6.1.1-17.1.1.1.1.1">
                      <p id="section-6.1.1-17.1.1.1.1.1.1">failInfoValue contains an extended error code from the defined
   set of extended error codes.<a href="#section-6.1.1-17.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.1.1-18">If the cMCStatus field is success, the Extended CMC Status Info
control <span class="bcp14">MAY</span> be omitted unless it is the only item in the response.<a href="#section-6.1.1-18" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMCStatusInfoControl">
<section id="section-6.1.2">
          <h4 id="name-cmc-status-info-control">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-cmc-status-info-control" class="section-name selfRef">CMC Status Info Control</a>
          </h4>
<p id="section-6.1.2-1">The CMC Status Info control is identified by the OID:<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.2-2">
<pre>
  id-cmc-statusInfo OBJECT IDENTIFIER ::= { id-cmc 1 }
</pre><a href="#section-6.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1.2-3">The CMC Status Info control has the ASN.1 definition:<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.2-4">
<pre>
  CMCStatusInfo ::= SEQUENCE {
    cMCStatus           CMCStatus,
    bodyList            BodyPartList,
    statusString        UTF8String OPTIONAL,
    otherInfo           CHOICE {
      failInfo            CMCFailInfo,
      pendInfo            PendInfo } OPTIONAL
    }
</pre><a href="#section-6.1.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.1.2-5">The fields in CMCStatusInfo have the following meaning:<a href="#section-6.1.2-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.2-6.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.2-6.1.1.1">
                  <p id="section-6.1.2-6.1.1.1.1">cMCStatus contains the returned status value. Details are in
   <a href="#CMCStatusValues" class="auto internal xref">Section 6.1.3</a>.<a href="#section-6.1.2-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.2-7.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.2-7.1.1.1">
                  <p id="section-6.1.2-7.1.1.1.1">bodyList contains the list of controls or other elements to which
   the status value applies. If an error is being returned for a
   Simple PKI Request, this field contains a single integer of value 1.<a href="#section-6.1.2-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.2-8.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.2-8.1.1.1">
                  <p id="section-6.1.2-8.1.1.1.1">statusString contains additional description information. This
   string is human readable.<a href="#section-6.1.2-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.2-9.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.2-9.1.1.1">
                  <p id="section-6.1.2-9.1.1.1.1">otherInfo provides additional information that expands on the CMC
   status code returned in the cMCStatus field.<a href="#section-6.1.2-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.2-10.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.2-10.1.1.1">
                  <ul class="normal">
<li class="normal" id="section-6.1.2-10.1.1.1.1.1">
                      <p id="section-6.1.2-10.1.1.1.1.1.1">failInfo is described in <a href="#CMCFailInfo" class="auto internal xref">Section 6.1.4</a>. It provides an error
   code that details what failure occurred. This choice is
   present only if cMCStatus is failed.<a href="#section-6.1.2-10.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.2-11.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.2-11.1.1.1">
                  <ul class="normal">
<li class="normal" id="section-6.1.2-11.1.1.1.1.1">
                      <p id="section-6.1.2-11.1.1.1.1.1.1">pendInfo uses the PendInfo ASN.1 structure in <a href="#extCMCStatusInfo" class="auto internal xref">Section 6.1.1</a>. It
   contains information about when and how the client should
   request results of this request. The pendInfo field <span class="bcp14">MUST</span> be
   populated for a cMCStatus value of pending or partial. Further
   details can be found in <a href="#extCMCStatusInfo" class="auto internal xref">Section 6.1.1</a> (Extended CMC Status Info
   Control) and <a href="#QueryPendingControl" class="auto internal xref">Section 6.13</a> (Query Pending Control ).<a href="#section-6.1.2-11.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.1.2-12">If the cMCStatus field is success, the CMC Status Info control <span class="bcp14">MAY</span> be
omitted unless it is the only item in the response. If no status
exists for a Simple or Full PKI Request, then the value of success is
assumed.<a href="#section-6.1.2-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMCStatusValues">
<section id="section-6.1.3">
          <h4 id="name-cmcstatus-values">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-cmcstatus-values" class="section-name selfRef">CMCStatus Values</a>
          </h4>
<p id="section-6.1.3-1">CMCStatus is a field in the Extended CMC Status Info and CMC Status
Info controls. This field contains a code representing the success
or failure of a specific operation. CMCStatus has the ASN.1
structure:<a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.3-2">
<pre>
  CMCStatus ::= INTEGER {
    success                (0),
    -- reserved            (1),
    failed                 (2),
    pending                (3),
    noSupport              (4),
    confirmRequired        (5),
    popRequired            (6),
    partial                (7)
    }
</pre><a href="#section-6.1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1.3-3">The values of CMCStatus have the following meaning:<a href="#section-6.1.3-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-4.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-4.1.1.1">
                  <p id="section-6.1.3-4.1.1.1.1">success indicates the request was granted or the action was
   completed.<a href="#section-6.1.3-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-5.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-5.1.1.1">
                  <p id="section-6.1.3-5.1.1.1.1">failed indicates the request was not granted or the action was not
   completed. More information is included elsewhere in the
   response.<a href="#section-6.1.3-5.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-6.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-6.1.1.1">
                  <p id="section-6.1.3-6.1.1.1.1">pending indicates the PKI Request has yet to be processed. The
   requester is responsible to poll back on this Full PKI request.
   pending may only be returned for certification request operations.<a href="#section-6.1.3-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-7.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-7.1.1.1">
                  <p id="section-6.1.3-7.1.1.1.1">noSupport indicates the requested operation is not supported.<a href="#section-6.1.3-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-8.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-8.1.1.1">
                  <p id="section-6.1.3-8.1.1.1.1">confirmRequired indicates a Confirm Certificate Acceptance control
   (<a href="#ConfirmCertificateAcceptanceControl" class="auto internal xref">Section 6.14</a>) must be returned before the certificate can be
   used.<a href="#section-6.1.3-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-9.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-9.1.1.1">
                  <p id="section-6.1.3-9.1.1.1.1">popRequired indicates a direct POP operation is required
   (<a href="#POPLinkRandomControl" class="auto internal xref">Section 6.3.1.3</a>).<a href="#section-6.1.3-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-10.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.3-10.1.1.1">
                  <p id="section-6.1.3-10.1.1.1.1">partial indicates a partial PKI Response is returned. The requester
   is responsible to poll back for the unfulfilled portions of the
   Full PKI Request.<a href="#section-6.1.3-10.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="CMCFailInfo">
<section id="section-6.1.4">
          <h4 id="name-cmcfailinfo">
<a href="#section-6.1.4" class="section-number selfRef">6.1.4. </a><a href="#name-cmcfailinfo" class="section-name selfRef">CMCFailInfo</a>
          </h4>
<p id="section-6.1.4-1">CMCFailInfo is a field in the Extended CMC Status Info and CMC Status
Info controls. CMCFailInfo conveys more detailed information
relevant to the interpretation of a failure condition. The
CMCFailInfo has the following ASN.1 structure:<a href="#section-6.1.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.4-2">
<pre>
  CMCFailInfo ::= INTEGER {
    badAlg            (0),
    badMessageCheck   (1),
    badRequest        (2),
    badTime           (3),
    badCertId         (4),
    unsupportedExt     (5),
    mustArchiveKeys   (6),
    badIdentity       (7),
    popRequired       (8),
    popFailed         (9),
    noKeyReuse        (10),
    internalCAError   (11),
    tryLater          (12),
    authDataFail      (13)
    }
</pre><a href="#section-6.1.4-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1.4-3">The values of CMCFailInfo have the following meanings:<a href="#section-6.1.4-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-4.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-4.1.1.1">
                  <p id="section-6.1.4-4.1.1.1.1">badAlg indicates unrecognized or unsupported algorithm.<a href="#section-6.1.4-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-5.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-5.1.1.1">
                  <p id="section-6.1.4-5.1.1.1.1">badMessageCheck indicates integrity check failed.<a href="#section-6.1.4-5.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-6.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-6.1.1.1">
                  <p id="section-6.1.4-6.1.1.1.1">badRequest indicates transaction was not permitted or supported.<a href="#section-6.1.4-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-7.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-7.1.1.1">
                  <p id="section-6.1.4-7.1.1.1.1">badTime indicates message time field was not sufficiently close to
   the system time.<a href="#section-6.1.4-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-8.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-8.1.1.1">
                  <p id="section-6.1.4-8.1.1.1.1">badCertId indicates no certificate could be identified matching the
   provided criteria.<a href="#section-6.1.4-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-9.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-9.1.1.1">
                  <p id="section-6.1.4-9.1.1.1.1">unsupportedExt indicates a requested X.509 extension is not
   supported by the recipient CA.<a href="#section-6.1.4-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-10.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-10.1.1.1">
                  <p id="section-6.1.4-10.1.1.1.1">mustArchiveKeys indicates private key material must be supplied.<a href="#section-6.1.4-10.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-11.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-11.1.1.1">
                  <p id="section-6.1.4-11.1.1.1.1">badIdentity indicates identification control failed to verify.<a href="#section-6.1.4-11.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-12.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-12.1.1.1">
                  <p id="section-6.1.4-12.1.1.1.1">popRequired indicates server requires a POP proof before issuing
   certificate.<a href="#section-6.1.4-12.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-13.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-13.1.1.1">
                  <p id="section-6.1.4-13.1.1.1.1">popFailed indicates POP processing failed.<a href="#section-6.1.4-13.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-14.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-14.1.1.1">
                  <p id="section-6.1.4-14.1.1.1.1">noKeyReuse indicates server policy does not allow key reuse.<a href="#section-6.1.4-14.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-15.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-15.1.1.1">
                  <p id="section-6.1.4-15.1.1.1.1">internalCAError indicates that the CA had an unknown internal
  failure.<a href="#section-6.1.4-15.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-16.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-16.1.1.1">
                  <p id="section-6.1.4-16.1.1.1.1">tryLater indicates that the server is not accepting requests at this
   time and the client should try at a later time.<a href="#section-6.1.4-16.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-17.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1.4-17.1.1.1">
                  <p id="section-6.1.4-17.1.1.1.1">authDataFail indicates failure occurred during processing of
   authenticated data.<a href="#section-6.1.4-17.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.1.4-18">If additional failure reasons are needed, they <span class="bcp14">SHOULD</span> use the
ExtendedFailureInfo item in the Extended CMC Status Info control.
However, for closed environments they can be defined using this type.
Such codes <span class="bcp14">MUST</span> be in the range from 1000 to 1999.<a href="#section-6.1.4-18" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IdentificationandIdentityProofControls">
<section id="section-6.2">
        <h3 id="name-identification-and-identity">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-identification-and-identity" class="section-name selfRef">Identification and Identity Proof Controls</a>
        </h3>
<p id="section-6.2-1">Some CAs and RAs require that a proof-of-identity be included in a
certification request. Many different ways of doing this exist with
different degrees of security and reliability. Most are familiar
with a bank's request to provide your mother's maiden name as a form
of identity proof. The reasoning behind requiring a proof-of-
identity can be found in Appendix C of <span>[<a href="#CRMF" class="cite xref">CRMF</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">CMC provides a method to prove the client's identity based on a
client/server shared-secret. If clients support the Full PKI
Request, clients <span class="bcp14">MUST</span> implement this method of identity proof
(<a href="#IdentityProofControl" class="auto internal xref">Section 6.2.2</a>). Servers <span class="bcp14">MUST</span> provide this method, but <span class="bcp14">MAY</span>
additionally support bilateral methods of similar strength.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">This document also provides an Identification control
(<a href="#IdentificationControl" class="auto internal xref">Section 6.2.3</a>). This control is a simple method to allow a client
to state who they are to the server. Generally, a shared-secret AND
an identifier of that shared-secret are passed from the server to the
client. The identifier is placed in the Identification control, and
the shared-secret is used to compute the Identity Proof control.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<div id="IdentityProofVersion2Control">
<section id="section-6.2.1">
          <h4 id="name-identity-proof-version-2-co">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-identity-proof-version-2-co" class="section-name selfRef">Identity Proof Version 2 Control</a>
          </h4>
<p id="section-6.2.1-1">The Identity Proof Version 2 control is identified by the OID:<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-2">
<pre>
  id-cmc-identityProofV2 OBJECT IDENTIFIER ::= { id-cmc 34 }
</pre><a href="#section-6.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.1-3">The Identity Proof Version 2 control has the ASN.1 definition:<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-4">
<pre>
  IdentifyProofV2 ::= SEQUENCE {
    hashAlgID        AlgorithmIdentifier,
    macAlgID         AlgorithmIdentifier,
    witness          OCTET STRING
    }
</pre><a href="#section-6.2.1-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2.1-5">The fields of IdentityProofV2 have the following meaning:<a href="#section-6.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.1-6.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.1-6.1.1.1">
                  <p id="section-6.2.1-6.1.1.1.1">hashAlgID is the identifier and parameters for the hash algorithm
   used to convert the shared-secret into a key for the MAC
   algorithm.<a href="#section-6.2.1-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.1-7.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.1-7.1.1.1">
                  <p id="section-6.2.1-7.1.1.1.1">macAlgID is the identifier and the parameters for the message
   authentication code algorithm used to compute the value of the
   witness field.<a href="#section-6.2.1-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.1-8.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.1-8.1.1.1">
                  <p id="section-6.2.1-8.1.1.1.1">witness is the identity proof.<a href="#section-6.2.1-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.2.1-9">The required method starts with an out-of-band transfer of a token
(the shared-secret). The shared-secret should be generated in a
random manner. The distribution of this token is beyond the scope of
this document. The client then uses this token for an identity proof
as follows:<a href="#section-6.2.1-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2.1-10">
<li id="section-6.2.1-10.1">
              <p id="section-6.2.1-10.1.1">The PKIData reqSequence field (encoded exactly as it appears in
the Full PKI Request including the sequence type and length) is
the value to be validated.<a href="#section-6.2.1-10.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.2.1-10.2">
              <p id="section-6.2.1-10.2.1">A hash of the shared-secret as a UTF8 string is computed using
hashAlgID.<a href="#section-6.2.1-10.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.2.1-10.3">
              <p id="section-6.2.1-10.3.1">A MAC is then computed using the value produced in Step 1 as the
message and the value from Step 2 as the key.<a href="#section-6.2.1-10.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.2.1-10.4">
              <p id="section-6.2.1-10.4.1">The result from Step 3 is then encoded as the witness value in
the Identity Proof Version 2 control.<a href="#section-6.2.1-10.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-6.2.1-11">When the server verifies the Identity Proof Version 2 control, it
computes the MAC value in the same way and compares it to the witness
value contained in the PKI Request.<a href="#section-6.2.1-11" class="pilcrow">¶</a></p>
<p id="section-6.2.1-12">If a server fails the verification of an Identity Proof Version 2
control, the CMCFailInfo value <span class="bcp14">MUST</span> be present in the Full PKI
Response and <span class="bcp14">MUST</span> have a value of badIdentity.<a href="#section-6.2.1-12" class="pilcrow">¶</a></p>
<p id="section-6.2.1-13">Reuse of the shared-secret on certification request retries allows
the client and server to maintain the same view of acceptable
identity proof values. However, reuse of the shared-secret can
potentially open the door for some types of attacks.<a href="#section-6.2.1-13" class="pilcrow">¶</a></p>
<p id="section-6.2.1-14">Implementations <span class="bcp14">MUST</span> be able to support tokens at least 16 characters
long. Guidance on the amount of entropy actually obtained from a
given length token based on character sets can be found in Appendix A
of <span>[<a href="#PASSWORD" class="cite xref">PASSWORD</a>]</span>.<a href="#section-6.2.1-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IdentityProofControl">
<section id="section-6.2.2">
          <h4 id="name-identity-proof-control">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-identity-proof-control" class="section-name selfRef">Identity Proof Control</a>
          </h4>
<p id="section-6.2.2-1">The Identity Proof control is identified by the OID:<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.2-2">
<pre>
  id-cmc-identityProof OBJECT IDENTIFIER ::= { id-cmc 3 }
</pre><a href="#section-6.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2-3">The Identity Proof control has the ASN.1 definition:<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.2-4">
<pre>
  IdentifyProof ::= OCTET STRING
</pre><a href="#section-6.2.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2-5">This control is processed in the same way as the Identity Proof
Version 2 control. In this case, the hash algorithm is fixed to
SHA-1 and the MAC algorithm is fixed to HMAC-SHA1.<a href="#section-6.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IdentificationControl">
<section id="section-6.2.3">
          <h4 id="name-identification-control">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-identification-control" class="section-name selfRef">Identification Control</a>
          </h4>
<p id="section-6.2.3-1">Optionally, servers <span class="bcp14">MAY</span> require the inclusion of the unprotected
Identification control with an Identification Proof control. The
Identification control is intended to contain a text string that
assists the server in locating the shared-secret needed to validate
the contents of the Identity Proof control. If the Identification
control is included in the Full PKI Request, the derivation of the
key in Step 2 (from <a href="#IdentityProofVersion2Control" class="auto internal xref">Section 6.2.1</a>) is altered so that the hash of the
concatenation of the shared-secret and the UTF8 identity value
(without the type and length bytes) are hashed rather than just the
shared-secret.<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2">The Identification control is identified by the OID:<a href="#section-6.2.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3-3">
<pre>
  id-cmc-identification OBJECT IDENTIFIER ::= { id-cmc 2 }
</pre><a href="#section-6.2.3-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3-4">The Identification control has the ASN.1 definition:<a href="#section-6.2.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3-5">
<pre>
  Identification ::= UTF8String
</pre><a href="#section-6.2.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="HardwareShared-SecretTokenGeneration">
<section id="section-6.2.4">
          <h4 id="name-hardware-shared-secret-toke">
<a href="#section-6.2.4" class="section-number selfRef">6.2.4. </a><a href="#name-hardware-shared-secret-toke" class="section-name selfRef">Hardware Shared-Secret Token Generation</a>
          </h4>
<p id="section-6.2.4-1">The shared-secret between the EE and the server is sometimes computed
using a hardware device that generates a series of tokens. The EE
can therefore prove its identity by transferring this token in plain
text along with a name string. The above protocol can be used with a
hardware shared-secret token generation device by the following
modifications:<a href="#section-6.2.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2.4-2">
<li id="section-6.2.4-2.1">
              <p id="section-6.2.4-2.1.1">The Identification control <span class="bcp14">MUST</span> be included and <span class="bcp14">MUST</span> contain the
hardware-generated token.<a href="#section-6.2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.2.4-2.2">
              <p id="section-6.2.4-2.2.1">The shared-secret value used above is the same hardware-generated
token.<a href="#section-6.2.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.2.4-2.3">
              <p id="section-6.2.4-2.3.1">All certification requests <span class="bcp14">MUST</span> have a subject name, and the
subject name <span class="bcp14">MUST</span> contain the fields required to identify the
holder of the hardware token device.<a href="#section-6.2.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.2.4-2.4">
              <p id="section-6.2.4-2.4.1">The entire certification request <span class="bcp14">MUST</span> be shrouded in some fashion
to prevent eavesdropping. Although the token is time critical,
an active eavesdropper cannot be permitted to extract the token
and submit a different certification request with the same token
value.<a href="#section-6.2.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="LinkingIdentityandPOPInfomation">
<section id="section-6.3">
        <h3 id="name-linking-identity-and-pop-in">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-linking-identity-and-pop-in" class="section-name selfRef">Linking Identity and POP Information</a>
        </h3>
<p id="section-6.3-1">In a CMC Full PKI Request, identity proof information about the
client is carried in the certificate associated with the signature of
the SignedData containing the certification requests, one of the two
identity proof controls or the MAC computed for the AuthenticatedData
containing the certification requests.  Proof-of-possession (POP)
information for key pairs, however, is carried separately for each
PKCS #10 or CRMF certification request.  (For keys capable of
generating a digital signature, the POP is provided by the signature
on the PKCS #10 or CRMF request.  For encryption-only keys, the
controls described in <a href="#EncryptedandDecryptedPOPControls" class="auto internal xref">Section 6.7</a> are used.)  In order to prevent
substitution-style attacks, the protocol must guarantee that the same
entity supplied both the POP and proof-of-identity information.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">We describe three mechanisms for linking identity and POP
information: witness values cryptographically derived from a shared-
secret (<a href="#CryptographicLinkage" class="auto internal xref">Section 6.3.1</a>), shared-secret/subject name matching (<a href="#Shared-Secret_SubjectDNLinking" class="auto internal xref">Section 6.3.2</a>)
, and subject name matching to an existing certificate (<a href="#ExistingCertificateLinking" class="auto internal xref">Section 6.3.3</a>)
.  Clients and servers <span class="bcp14">MUST</span> support the witness value and the
certificate linking techniques.  Clients and servers <span class="bcp14">MAY</span> support
shared-secret/name matching or <span class="bcp14">MAY</span> support other bilateral techniques
of similar strength.  The idea behind the first two mechanisms is to
force the client to sign some data into each certification request
that can be directly associated with the shared-secret; this will
defeat attempts to include certification requests from different
entities in a single Full PKI Request.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<div id="CryptographicLinkage">
<section id="section-6.3.1">
          <h4 id="name-cryptographic-linkage">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-cryptographic-linkage" class="section-name selfRef">Cryptographic Linkage</a>
          </h4>
<p id="section-6.3.1-1">The first technique that links identity and POP information forces
the client to include a piece of information cryptographically
derived from the shared-secret as a signed extension within each
certification request (PKCS #10 or CRMF).<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<div id="POPLinkWitnessVersion2Controls">
<section id="section-6.3.1.1">
            <h5 id="name-pop-link-witness-version-2-">
<a href="#section-6.3.1.1" class="section-number selfRef">6.3.1.1. </a><a href="#name-pop-link-witness-version-2-" class="section-name selfRef">POP Link Witness Version 2 Controls</a>
            </h5>
<p id="section-6.3.1.1-1">The POP Link Witness Version 2 control is identified by the OID:<a href="#section-6.3.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.1.1-2">
<pre>
  id-cmc-popLinkWitnessV2 OBJECT IDENTIFIER ::= { id-cmc 33 }
</pre><a href="#section-6.3.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3.1.1-3">The POP Link Witness Version 2 control has the ASN.1 definition:<a href="#section-6.3.1.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.1.1-4">
<pre>
  PopLinkWitnessV2 ::= SEQUENCE {
    keyGenAlgorithm   AlgorithmIdentifier,
    macAlgorithm      AlgorithmIdentifier,
    witness           OCTET STRING
    }
</pre><a href="#section-6.3.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3.1.1-5">The fields of PopLinkWitnessV2 have the following meanings:<a href="#section-6.3.1.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.3.1.1-6.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.3.1.1-6.1.1.1">
                    <p id="section-6.3.1.1-6.1.1.1.1">keyGenAlgorithm contains the algorithm used to generate the key for
   the MAC algorithm. This will generally be a hash algorithm, but
   could be a more complex algorithm.<a href="#section-6.3.1.1-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.3.1.1-7.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.3.1.1-7.1.1.1">
                    <p id="section-6.3.1.1-7.1.1.1.1">macAlgorithm contains the algorithm used to create the witness
   value.<a href="#section-6.3.1.1-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.3.1.1-8.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.3.1.1-8.1.1.1">
                    <p id="section-6.3.1.1-8.1.1.1.1">witness contains the computed witness value.<a href="#section-6.3.1.1-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<p id="section-6.3.1.1-9">This technique is useful if null subject DNs are used (because, for
example, the server can generate the subject DN for the certificate
based only on the shared-secret). Processing begins when the client
receives the shared-secret out-of-band from the server. The client
then computes the following values:<a href="#section-6.3.1.1-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3.1.1-10">
<li id="section-6.3.1.1-10.1">
                <p id="section-6.3.1.1-10.1.1">The client generates a random byte-string, R, which <span class="bcp14">SHOULD</span> be at
least 512 bits in length.<a href="#section-6.3.1.1-10.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.3.1.1-10.2">
                <p id="section-6.3.1.1-10.2.1">The key is computed from the shared-secret using the algorithm in
keyGenAlgorithm.<a href="#section-6.3.1.1-10.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.3.1.1-10.3">
                <p id="section-6.3.1.1-10.3.1">A MAC is then computed over the random value produced in Step 1,
using the key computed in Step 2.<a href="#section-6.3.1.1-10.3.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.3.1.1-10.4">
                <p id="section-6.3.1.1-10.4.1">The random value produced in Step 1 is encoded as the value of a
POP Link Random control. This control <span class="bcp14">MUST</span> be included in the
Full PKI Request.<a href="#section-6.3.1.1-10.4.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.3.1.1-10.5">
                <p id="section-6.3.1.1-10.5.1">The MAC value produced in Step 3 is placed in either the POP Link
Witness control or the witness field of the POP Link Witness V2
control.<a href="#section-6.3.1.1-10.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.1.1-10.5.2.1">
                    <p id="section-6.3.1.1-10.5.2.1.1">For CRMF, the POP Link Witness/POP Link Witness V2 control is
included in the controls field of the CertRequest structure.<a href="#section-6.3.1.1-10.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-6.3.1.1-10.5.2.2">
                    <p id="section-6.3.1.1-10.5.2.2.1">For PKCS #10, the POP Link Witness/POP Link Witness V2 control
is included in the attributes field of the
CertificationRequestInfo structure.<a href="#section-6.3.1.1-10.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ol>
<p id="section-6.3.1.1-11">Upon receipt, servers <span class="bcp14">MUST</span> verify that each certification request
contains a copy of the POP Link Witness/POP Link Witness V2 control
and that its value was derived using the above method from the
shared-secret and the random string included in the POP Link Random
control.<a href="#section-6.3.1.1-11" class="pilcrow">¶</a></p>
<p id="section-6.3.1.1-12">The Identification control (<a href="#IdentificationControl" class="auto internal xref">Section 6.2.3</a>) or the subject DN of a
certification request can be used to help identify which shared-
secret was used.<a href="#section-6.3.1.1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="POPLinkWitnessControl">
<section id="section-6.3.1.2">
            <h5 id="name-pop-link-witness-control">
<a href="#section-6.3.1.2" class="section-number selfRef">6.3.1.2. </a><a href="#name-pop-link-witness-control" class="section-name selfRef">POP Link Witness Control</a>
            </h5>
<p id="section-6.3.1.2-1">The POP Link Witness control is identified by the OID:<a href="#section-6.3.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.1.2-2">
<pre>
  id-cmc-popLinkWitness OBJECT IDENTIFIER ::= { id-cmc 23 }
</pre><a href="#section-6.3.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3.1.2-3">The POP Link Witness control has the ASN.1 definition:<a href="#section-6.3.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.1.2-4">
<pre>
  PopLinkWitness ::= OCTET STRING
</pre><a href="#section-6.3.1.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3.1.2-5">For this control, SHA-1 is used as the key generation algorithm.
HMAC-SHA1 is used as the mac algorithm.<a href="#section-6.3.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="POPLinkRandomControl">
<section id="section-6.3.1.3">
            <h5 id="name-pop-link-random-control">
<a href="#section-6.3.1.3" class="section-number selfRef">6.3.1.3. </a><a href="#name-pop-link-random-control" class="section-name selfRef">POP Link Random Control</a>
            </h5>
<p id="section-6.3.1.3-1">The POP Link Random control is identified by the OID:<a href="#section-6.3.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.1.3-2">
<pre>
  id-cmc-popLinkRandom OBJECT IDENTIFIER ::= { id-cmc 22 }
</pre><a href="#section-6.3.1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3.1.3-3">The POP Link Random control has the ASN.1 definition:<a href="#section-6.3.1.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.1.3-4">
<pre>
  PopLinkRandom ::= OCTET STRING
</pre><a href="#section-6.3.1.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="Shared-Secret_SubjectDNLinking">
<section id="section-6.3.2">
          <h4 id="name-shared-secret-subject-dn-li">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-shared-secret-subject-dn-li" class="section-name selfRef">Shared-Secret/Subject DN Linking</a>
          </h4>
<p id="section-6.3.2-1">The second technique to link identity and POP information is to link
a particular subject distinguished name (subject DN) to the shared-
secrets that are distributed out-of-band and to require that clients
using the shared-secret to prove identity include that exact subject
DN in every certification request. It is expected that many client-
server connections that use shared-secret-based proof-of-identity
will use this mechanism. (It is common not to omit the subject DN
information from the certification request.)<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<p id="section-6.3.2-2">When the shared-secret is generated and transferred out-of-band to
initiate the registration process (<a href="#IdentificationandIdentityProofControls" class="auto internal xref">Section 6.2</a>), a particular subject
DN is also associated with the shared-secret and communicated to the
client. (The subject DN generated <span class="bcp14">MUST</span> be unique per entity in
accordance with the CA policy; a null subject DN cannot be used. A
common practice could be to place the identification value as part of
the subject DN.) When the client generates the Full PKI Request, it
<span class="bcp14">MUST</span> use these two pieces of information as follows:<a href="#section-6.3.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3.2-3">
<li id="section-6.3.2-3.1">
              <p id="section-6.3.2-3.1.1">The client <span class="bcp14">MUST</span> include the specific subject DN that it received
along with the shared-secret as the subject name in every
certification request (PKCS #10 and/or CRMF) in the Full PKI
Request. The subject names in the certification requests <span class="bcp14">MUST NOT</span> be null.<a href="#section-6.3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.3.2-3.2">
              <p id="section-6.3.2-3.2.1">The client <span class="bcp14">MUST</span> include an Identity Proof control (<a href="#IdentityProofControl" class="auto internal xref">Section 6.2.2</a>)
or Identity Proof Version 2 control (<a href="#IdentityProofVersion2Control" class="auto internal xref">Section 6.2.1</a>), derived from
the shared-secret, in the Full PKI Request.<a href="#section-6.3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-6.3.2-4">The server receiving this message <span class="bcp14">MUST</span> (a) validate the Identity
Proof control and then, (b) check that the subject DN included in
each certification request matches that associated with the shared-
secret. If either of these checks fails, the certification request
<span class="bcp14">MUST</span> be rejected.<a href="#section-6.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ExistingCertificateLinking">
<section id="section-6.3.3">
          <h4 id="name-existing-certificate-linkin">
<a href="#section-6.3.3" class="section-number selfRef">6.3.3. </a><a href="#name-existing-certificate-linkin" class="section-name selfRef">Existing Certificate Linking</a>
          </h4>
<p id="section-6.3.3-1">Linking between the POP and an identity is easy when an existing
certificate is used.  The client copies all of the naming information
from the existing certificate (subject name and subject alternative
name) into the new certification request.  The POP on the new public
key is then performed by using the new key to sign the identity
information (linking the POP to a specific identity).  The identity
information is then tied to the POP information by signing the entire
enrollment request with the private key of the existing certificate.<a href="#section-6.3.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3.3-2">Existing certificate linking can be used in the following
circumstances:<a href="#section-6.3.3-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.3.3-3.1">
              <p id="section-6.3.3-3.1.1">When replacing a certificate by doing a renewal or rekey
   certification request.<a href="#section-6.3.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.3.3-4.1">
              <p id="section-6.3.3-4.1.1">Using an existing certificate to get a new certificate.  An
  example of this would be to get a key establishment certificate
  after having gotten a signature certificate.<a href="#section-6.3.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.3.3-5.1">
              <p id="section-6.3.3-5.1.1">Using a third-party certificate to get a new certificate from a
  CA.  An example of this would be using a certificate and key pair
  distributed with a device to prove an identity.  This requires
  that the CA have an out-of-band channel to map the identity in the
  device certificate to the new EE identity.<a href="#section-6.3.3-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="DataReturnControl">
<section id="section-6.4">
        <h3 id="name-data-return-control">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-data-return-control" class="section-name selfRef">Data Return Control</a>
        </h3>
<p id="section-6.4-1">The Data Return control allows clients to send arbitrary data
(usually some type of internal state information) to the server and
to have the data returned as part of the Full PKI Response. Data
placed in a Data Return control is considered to be opaque to the
server. The same control is used for both Full PKI Requests and
Responses. If the Data Return control appears in a Full PKI Request,
the server <span class="bcp14">MUST</span> return it as part of the PKI Response.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">In the event that the information in the Data Return control needs to
be confidential, it is expected that the client would apply some type
of encryption to the contained data, but the details of this are
outside the scope of this specification.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">The Data Return control is identified by the OID:<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4-4">
<pre>
  id-cmc-dataReturn OBJECT IDENTIFIER ::= { id-cmc 4 }
</pre><a href="#section-6.4-4" class="pilcrow">¶</a>
</div>
<p id="section-6.4-5">The Data Return control has the ASN.1 definition:<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4-6">
<pre>
  DataReturn ::= OCTET STRING
</pre><a href="#section-6.4-6" class="pilcrow">¶</a>
</div>
<p id="section-6.4-7">A client could use this control to place an identifier marking the
exact source of the private key material. This might be the
identifier of a hardware device containing the private key.<a href="#section-6.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RACertificateModificationControls">
<section id="section-6.5">
        <h3 id="name-ra-certificate-modification">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-ra-certificate-modification" class="section-name selfRef">RA Certificate Modification Controls</a>
        </h3>
<p id="section-6.5-1">These controls exist for RAs to be able to modify the contents of a
certification request. Modifications might be necessary for various
reasons. These include addition of certificate extensions or
modification of subject and/or subject alternative names.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">Two controls exist for this purpose. The first control, Modify
Certification Request (<a href="#ModifyCertificationRequestControl" class="auto internal xref">Section 6.5.1</a>), allows the RA to replace or
remove any field in the certificate. The second control, Add
Extensions (<a href="#AddExtensionsControl" class="auto internal xref">Section 6.5.2</a>), only allows for the addition of
extensions.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<div id="ModifyCertificationRequestControl">
<section id="section-6.5.1">
          <h4 id="name-modify-certification-reques">
<a href="#section-6.5.1" class="section-number selfRef">6.5.1. </a><a href="#name-modify-certification-reques" class="section-name selfRef">Modify Certification Request Control</a>
          </h4>
<p id="section-6.5.1-1">The Modify Certification Request control is used by RAs to change
fields in a requested certificate.<a href="#section-6.5.1-1" class="pilcrow">¶</a></p>
<p id="section-6.5.1-2">The Modify Certification Request control is identified by the OID:<a href="#section-6.5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.5.1-3">
<pre>
  id-cmc-modCertTemplate OBJECT IDENTIFIER ::= { id-cmc 31 }
</pre><a href="#section-6.5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-6.5.1-4">The Modify Certification Request has the ASN.1 definition:<a href="#section-6.5.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.5.1-5">
<pre>
  ModCertTemplate ::= SEQUENCE {
    pkiDataReference             BodyPartPath,
    certReferences               BodyPartList,
    replace                      BOOLEAN DEFAULT TRUE,
    certTemplate                 CertTemplate
    }
</pre><a href="#section-6.5.1-5" class="pilcrow">¶</a>
</div>
<p id="section-6.5.1-6">The fields in ModCertTemplate have the following meaning:<a href="#section-6.5.1-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.1-7.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.1-7.1.1.1">
                  <p id="section-6.5.1-7.1.1.1.1">pkiDataReference is the path to the PKI Request containing
   certification request(s) to be modified.<a href="#section-6.5.1-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.1-8.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.1-8.1.1.1">
                  <p id="section-6.5.1-8.1.1.1.1">certReferences refers to one or more certification requests in the
   PKI Request referenced by pkiDataReference to be modified. Each
   BodyPartID of the certReferences sequence <span class="bcp14">MUST</span> be equal to either
   the bodyPartID of a TaggedCertificationRequest (PKCS #10) or the
   certReqId of the CertRequest within a CertReqMsg (CRMF). By
   definition, the certificate extensions included in the
   certTemplate field are applied to every certification request
   referenced in the certReferences sequence. If a request
   corresponding to bodyPartID cannot be found, the CMCFailInfo with
   a value of badRequest is returned that references this control.<a href="#section-6.5.1-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.1-9.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.1-9.1.1.1">
                  <p id="section-6.5.1-9.1.1.1.1">replace specifies if the target certification request is to be
  modified by replacing or deleting fields. If the value is TRUE,
  the data in this control replaces the data in the target
  certification request. If the value is FALSE, the data in the
  target certification request is deleted. The action is slightly
  different for the extensions field of certTemplate; each extension
  is treated individually rather than as a single unit.<a href="#section-6.5.1-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.1-10.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.1-10.1.1.1">
                  <p id="section-6.5.1-10.1.1.1.1">certTemplate is a certificate template object <span>[<a href="#CRMF" class="cite xref">CRMF</a>]</span>. If a field is
   present and replace is TRUE, it replaces that field in the
   certification request. If the field is present and replace is
   FALSE, the field in the certification request is removed. If the
   field is absent, no action is performed. Each extension is
   treated as a single field.<a href="#section-6.5.1-10.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.5.1-11">Servers <span class="bcp14">MUST</span> be able to process all extensions defined, but not
prohibited, in <span>[<a href="#PKIXCERT" class="cite xref">PKIXCERT</a>]</span>. Servers are not required to be able to
process every X.509v3 extension transmitted using this protocol, nor
are they required to be able to process other, private extensions.
Servers are not required to put all RA-requested extensions into a
certificate. Servers are permitted to modify RA-requested
extensions. Servers <span class="bcp14">MUST NOT</span> alter an extension so as to reverse the
meaning of a client-requested extension. If a certification request
is denied due to the inability to handle a requested extension and a
Full PKI Response is returned, the server <span class="bcp14">MUST</span> return a CMCFailInfo
value with the value of unsupportedExt.<a href="#section-6.5.1-11" class="pilcrow">¶</a></p>
<p id="section-6.5.1-12">If a certification request is the target of multiple Modify
Certification Request controls, the behavior is:<a href="#section-6.5.1-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5.1-13.1">
              <p id="section-6.5.1-13.1.1">If control A exists in a layer that contains the layer of control
B, control A <span class="bcp14">MUST</span> override control B. In other words, controls
should be applied from the innermost layer to the outermost layer.<a href="#section-6.5.1-13.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.5.1-13.2">
              <p id="section-6.5.1-13.2.1">If control A and control B are in the same PKIData (i.e., the same
wrapping layer), the order of application is non-determinate.<a href="#section-6.5.1-13.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.5.1-14">The same order of application is used if a certification request is
the target of both a Modify Certification Request control and an Add
Extensions control.<a href="#section-6.5.1-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AddExtensionsControl">
<section id="section-6.5.2">
          <h4 id="name-add-extensions-control">
<a href="#section-6.5.2" class="section-number selfRef">6.5.2. </a><a href="#name-add-extensions-control" class="section-name selfRef">Add Extensions Control</a>
          </h4>
<p id="section-6.5.2-1">The Add Extensions control has been deprecated in favor of the Modify
Certification Request control. It was replaced so that fields in the
certification request other than extensions could be modified.<a href="#section-6.5.2-1" class="pilcrow">¶</a></p>
<p id="section-6.5.2-2">The Add Extensions control is used by RAs to specify additional
extensions that are to be included in certificates.<a href="#section-6.5.2-2" class="pilcrow">¶</a></p>
<p id="section-6.5.2-3">The Add Extensions control is identified by the OID:<a href="#section-6.5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.5.2-4">
<pre>
id-cmc-addExtensions OBJECT IDENTIFIER ::= { id-cmc 8 }
</pre><a href="#section-6.5.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.5.2-5">The Add Extensions control has the ASN.1 definition:<a href="#section-6.5.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.5.2-6">
<pre>
  AddExtensions ::= SEQUENCE {
    pkiDataReference             BodyPartID,
    certReferences               SEQUENCE OF BodyPartID,
    extensions                   SEQUENCE OF Extension
    }
</pre><a href="#section-6.5.2-6" class="pilcrow">¶</a>
</div>
<p id="section-6.5.2-7">The fields in AddExtensions have the following meaning:<a href="#section-6.5.2-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.2-8.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.2-8.1.1.1">
                  <p id="section-6.5.2-8.1.1.1.1">pkiDataReference contains the body part identity of the embedded
   certification request.<a href="#section-6.5.2-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.2-9.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.2-9.1.1.1">
                  <p id="section-6.5.2-9.1.1.1.1">certReferences is a list of references to one or more of the
   certification requests contained within a PKIData. Each body part
   identifier of the certReferences sequence <span class="bcp14">MUST</span> be equal to either
   the bodyPartID of a TaggedCertificationRequest (PKCS #10) or the
   certReqId of the CertRequest within a CertReqMsg (CRMF). By
   definition, the listed extensions are to be applied to every
   certification request referenced in the certReferences sequence.
   If a certification request corresponding to bodyPartID cannot be
   found, the CMCFailInfo with a value of badRequest is returned
   referencing this control.<a href="#section-6.5.2-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.2-10.1">
              <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5.2-10.1.1.1">
                  <p id="section-6.5.2-10.1.1.1.1">extensions is a sequence of extensions to be applied to the
   referenced certification requests.<a href="#section-6.5.2-10.1.1.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.5.2-11">Servers <span class="bcp14">MUST</span> be able to process all extensions defined, but not
prohibited, in <span>[<a href="#PKIXCERT" class="cite xref">PKIXCERT</a>]</span>. Servers are not required to be able to
process every X.509v3 extension transmitted using this protocol, nor
are they required to be able to process other, private extensions.
Servers are not required to put all RA-requested extensions into a
certificate. Servers are permitted to modify RA-requested
extensions. Servers <span class="bcp14">MUST NOT</span> alter an extension so as to reverse the
meaning of a client-requested extension. If a certification request
is denied due to the inability to handle a requested extension and a
response is returned, the server <span class="bcp14">MUST</span> return a CMCFailInfo with the
value of unsupportedExt.<a href="#section-6.5.2-11" class="pilcrow">¶</a></p>
<p id="section-6.5.2-12">If multiple Add Extensions controls exist in a Full PKI Request, the
exact behavior is left up to the CA policy. However, it is
recommended that the following policy be used. These rules would be
applied to individual extensions within an Add Extensions control (as
opposed to an "all or nothing" approach).<a href="#section-6.5.2-12" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.5.2-13">
<li id="section-6.5.2-13.1">
              <p id="section-6.5.2-13.1.1">If the conflict is within a single PKIData, the certification
request would be rejected with a CMCFailInfo value of badRequest.<a href="#section-6.5.2-13.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.5.2-13.2">
              <p id="section-6.5.2-13.2.1">If the conflict is between different PKIData, the outermost
version of the extension would be used (allowing an RA to
override the requested extension).<a href="#section-6.5.2-13.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="TransactionIdentifierControlandSenderandRecipientNonceControls">
<section id="section-6.6">
        <h3 id="name-transaction-identifier-cont">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-transaction-identifier-cont" class="section-name selfRef">Transaction Identifier Control and Sender and Recipient Nonce Controls</a>
        </h3>
<p id="section-6.6-1">Transactions are identified and tracked with a transaction
identifier. If used, clients generate transaction identifiers and
retain their value until the server responds with a Full PKI Response
that completes the transaction. Servers correspondingly include
received transaction identifiers in the Full PKI Response.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<p id="section-6.6-2">The Transaction Identifier control is identified by the OID:<a href="#section-6.6-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.6-3">
<pre>
  id-cmc-transactionId  OBJECT IDENTIFIER ::= { id-cmc 5 }
</pre><a href="#section-6.6-3" class="pilcrow">¶</a>
</div>
<p id="section-6.6-4">The Transaction Identifier control has the ASN.1 definition:<a href="#section-6.6-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.6-5">
<pre>
  TransactionId ::= INTEGER
</pre><a href="#section-6.6-5" class="pilcrow">¶</a>
</div>
<p id="section-6.6-6">The Transaction Identifier control identifies a given transaction.
It is used by client and server to manage the state of an operation.
Clients <span class="bcp14">MAY</span> include a Transaction Identifier control in a request.
If the original request contains a Transaction Identifier control,
all subsequent requests and responses <span class="bcp14">MUST</span> include the same
Transaction Identifier control.<a href="#section-6.6-6" class="pilcrow">¶</a></p>
<p id="section-6.6-7">Replay protection is supported through the use of the Sender and
Recipient Nonce controls. If nonces are used, in the first message
of a transaction, a Recipient Nonce control is not transmitted; a
Sender Nonce control is included by the transaction originator and
retained for later reference. The recipient of a Sender Nonce
control reflects this value back to the originator as a Recipient
Nonce control and includes its own Sender Nonce control. Upon
receipt by the transaction originator of this response, the
transaction originator compares the value of Recipient Nonce control
to its retained value. If the values match, the message can be
accepted for further security processing. The received value for a
Sender Nonce control is also retained for inclusion in the next
message associated with the same transaction.<a href="#section-6.6-7" class="pilcrow">¶</a></p>
<p id="section-6.6-8">The Sender Nonce and Recipient Nonce controls are identified by the
OIDs:<a href="#section-6.6-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.6-9">
<pre>
  id-cmc-senderNonce    OBJECT IDENTIFIER ::= { id-cmc 6 }
  id-cmc-recipientNonce OBJECT IDENTIFIER ::= { id-cmc 7 }
</pre><a href="#section-6.6-9" class="pilcrow">¶</a>
</div>
<p id="section-6.6-10">The Sender Nonce control has the ASN.1 definition:<a href="#section-6.6-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.6-11">
<pre>
  SenderNonce ::= OCTET STRING
</pre><a href="#section-6.6-11" class="pilcrow">¶</a>
</div>
<p id="section-6.6-12">The Recipient Nonce control has the ASN.1 definition:<a href="#section-6.6-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.6-13">
<pre>
  RecipientNonce ::= OCTET STRING
</pre><a href="#section-6.6-13" class="pilcrow">¶</a>
</div>
<p id="section-6.6-14">Clients <span class="bcp14">MAY</span> include a Sender Nonce control in the initial PKI
Request. If a message includes a Sender Nonce control, the response
<span class="bcp14">MUST</span> include the transmitted value of the previously received Sender
Nonce control as a Recipient Nonce control and include a new value as
its Sender Nonce control.<a href="#section-6.6-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="EncryptedandDecryptedPOPControls">
<section id="section-6.7">
        <h3 id="name-encrypted-and-decrypted-pop">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-encrypted-and-decrypted-pop" class="section-name selfRef">Encrypted and Decrypted POP Controls</a>
        </h3>
<p id="section-6.7-1">Servers <span class="bcp14">MAY</span> require that this POP method be used only if another POP
method is unavailable. Servers <span class="bcp14">SHOULD</span> reject all certification
requests contained within a PKIData if any required POP is missing
for any element within the PKIData.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
<p id="section-6.7-2">Many servers require proof that the entity that generated the
certification request actually possesses the corresponding private
component of the key pair. For keys that can be used as signature
keys, signing the certification request with the private key serves
as a POP on that key pair. With keys that can only be used for
encryption operations, POP <span class="bcp14">MUST</span> be performed by forcing the client to
decrypt a value. See <span><a href="https://rfc-editor.org/rfc/rfc4211#section-5" class="relref">Section 5</a> of [<a href="#CRMF" class="cite xref">CRMF</a>]</span> for a detailed discussion
of POP.<a href="#section-6.7-2" class="pilcrow">¶</a></p>
<p id="section-6.7-3">By necessity, POP for encryption-only keys cannot be done in one
round-trip, since there are four distinct steps:<a href="#section-6.7-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.7-4">
<li id="section-6.7-4.1">
            <p id="section-6.7-4.1.1">Client tells the server about the public component of a new
encryption key pair.<a href="#section-6.7-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.7-4.2">
            <p id="section-6.7-4.2.1">Server sends the client a POP challenge, encrypted with the
presented public encryption key.<a href="#section-6.7-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.7-4.3">
            <p id="section-6.7-4.3.1">Client decrypts the POP challenge using the private key that
corresponds to the presented public key and sends the plaintext
back to the server.<a href="#section-6.7-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.7-4.4">
            <p id="section-6.7-4.4.1">Server validates the decrypted POP challenge and continues
processing the certification request.<a href="#section-6.7-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-6.7-5">CMC defines two different controls. The first deals with the
encrypted challenge sent from the server to the user in Step 2. The
second deals with the decrypted challenge sent from the client to the
server in Step 3.<a href="#section-6.7-5" class="pilcrow">¶</a></p>
<p id="section-6.7-6">The Encrypted POP control is used to send the encrypted challenge
from the server to the client as part of the PKIResponse. (Note that
it is assumed that the message sent in Step 1 above is a Full PKI
Request and that the response in Step 2 is a Full PKI Response
including a CMCFailInfo specifying that a POP is explicitly required,
and providing the POP challenge in the encryptedPOP control.)<a href="#section-6.7-6" class="pilcrow">¶</a></p>
<p id="section-6.7-7">The Encrypted POP control is identified by the OID:<a href="#section-6.7-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7-8">
<pre>
    id-cmc-encryptedPOP OBJECT IDENTIFIER ::= { id-cmc 9 }
</pre><a href="#section-6.7-8" class="pilcrow">¶</a>
</div>
<p id="section-6.7-9">The Encrypted POP control has the ASN.1 definition:<a href="#section-6.7-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7-10">
<pre>
  EncryptedPOP ::= SEQUENCE {
    request        TaggedRequest,
    cms            ContentInfo,
    thePOPAlgID    AlgorithmIdentifier,
    witnessAlgID   AlgorithmIdentifier,
    witness        OCTET STRING
    }
</pre><a href="#section-6.7-10" class="pilcrow">¶</a>
</div>
<p id="section-6.7-11">The Decrypted POP control is identified by the OID:<a href="#section-6.7-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7-12">
<pre>
  id-cmc-decryptedPOP  OBJECT IDENTIFIER ::= { id-cmc 10 }
</pre><a href="#section-6.7-12" class="pilcrow">¶</a>
</div>
<p id="section-6.7-13">The Decrypted POP control has the ASN.1 definition:<a href="#section-6.7-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7-14">
<pre>
  DecryptedPOP ::= SEQUENCE {
    bodyPartID     BodyPartID,
    thePOPAlgID    AlgorithmIdentifier,
    thePOP         OCTET STRING
    }
</pre><a href="#section-6.7-14" class="pilcrow">¶</a>
</div>
<p id="section-6.7-15">The encrypted POP algorithm works as follows:<a href="#section-6.7-15" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.7-16">
<li id="section-6.7-16.1">
            <p id="section-6.7-16.1.1">The server randomly generates the POP Proof Value and associates
it with the request.<a href="#section-6.7-16.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.7-16.2">
            <p id="section-6.7-16.2.1">The server returns the Encrypted POP control with the following
fields set:<a href="#section-6.7-16.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7-16.2.2.1">
                <p id="section-6.7-16.2.2.1.1">request is the original certification request (it is included
here so the client need not keep a copy of the request).<a href="#section-6.7-16.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.7-16.2.2.2">
                <p id="section-6.7-16.2.2.2.1">cms is an EnvelopedData, the encapsulated content type being id-
   data and the content being the POP Proof Value; this value
   needs to be long enough that one cannot reverse the value from
   the witness hash. If the certification request contains a
   Subject Key Identifier (SKI) extension, then the recipient
   identifier <span class="bcp14">SHOULD</span> be the SKI. If the issuerAndSerialNumber
   form is used, the IssuerName <span class="bcp14">MUST</span> be encoded as NULL and the
   SerialNumber as the bodyPartID of the certification request.<a href="#section-6.7-16.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.7-16.2.2.3">
                <p id="section-6.7-16.2.2.3.1">thePOPAlgID identifies the algorithm to be used in computing the
return POP value.<a href="#section-6.7-16.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.7-16.2.2.4">
                <p id="section-6.7-16.2.2.4.1">witnessAlgID identifies the hash algorithm used on the POP Proof
Value to create the field witness.<a href="#section-6.7-16.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.7-16.2.2.5">
                <p id="section-6.7-16.2.2.5.1">witness is the hashed value of the POP Proof Value.<a href="#section-6.7-16.2.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-6.7-16.3">
            <p id="section-6.7-16.3.1">The client decrypts the cms field to obtain the POP Proof Value.
The client computes H(POP Proof Value) using the witnessAlgID and
compares to the value of witness. If the values do not compare
or the decryption is not successful, the client <span class="bcp14">MUST</span> abort the
enrollment process. The client aborts the process by sending a
request containing a CMC Status Info control with CMCFailInfo
value of popFailed.<a href="#section-6.7-16.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.7-16.4">
            <p id="section-6.7-16.4.1">The client creates the Decrypted POP control as part of a new
PKIData. The fields in the DecryptedPOP are:<a href="#section-6.7-16.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7-16.4.2.1">
                <p id="section-6.7-16.4.2.1.1">bodyPartID refers to the certification request in the new PKI
Request.<a href="#section-6.7-16.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.7-16.4.2.2">
                <p id="section-6.7-16.4.2.2.1">thePOPAlgID is copied from the encryptedPOP.<a href="#section-6.7-16.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.7-16.4.2.3">
                <p id="section-6.7-16.4.2.3.1">thePOP contains the possession proof. This value is computed by
thePOPAlgID using the POP Proof Value and the request.<a href="#section-6.7-16.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-6.7-16.5">
            <p id="section-6.7-16.5.1">The server then re-computes the value of thePOP from its cached
value and the request and compares to the value of thePOP. If
the values do not match, the server <span class="bcp14">MUST NOT</span> issue the
certificate. The server <span class="bcp14">MAY</span> re-issue a new challenge or <span class="bcp14">MAY</span> fail
the request altogether.<a href="#section-6.7-16.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-6.7-17">When defining the algorithms for thePOPAlgID and witnessAlgID, care
must be taken to ensure that the result of witnessAlgID is not a
useful value to shortcut the computation with thePOPAlgID. The POP
Proof Value is used as the secret value in the HMAC algorithm and the
request is used as the data. If the POP Proof Value is greater than
64 bytes, only the first 64 bytes of the POP Proof Value is used as
the secret.<a href="#section-6.7-17" class="pilcrow">¶</a></p>
<p id="section-6.7-18">One potential problem with the algorithm above is the amount of state
that a CA needs to keep in order to verify the returned POP value.
The following describes one of many possible ways of addressing the
problem by reducing the amount of state kept on the CA to a single
(or small set) of values.<a href="#section-6.7-18" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.7-19">
<li id="section-6.7-19.1">
            <p id="section-6.7-19.1.1">Server generates random seed x, constant across all requests.
(The value of x would normally be altered on a regular basis and
kept for a short time afterwards.)<a href="#section-6.7-19.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.7-19.2">
            <p id="section-6.7-19.2.1">For certification request R, server computes y = F(x,R). F can
be, for example, HMAC-SHA1(x,R). All that's important for
statelessness is that y be consistently computable with only
known state constant x and function F, other inputs coming from
the certification request structure. y should not be predictable
based on knowledge of R, thus the use of a one-way function like
HMAC-SHA1.<a href="#section-6.7-19.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="RAPOPWitnessControl">
<section id="section-6.8">
        <h3 id="name-ra-pop-witness-control">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-ra-pop-witness-control" class="section-name selfRef">RA POP Witness Control</a>
        </h3>
<p id="section-6.8-1">In a certification request scenario that involves an RA, the CA may
allow (or require) that the RA perform the POP protocol with the
entity that generated the certification request. In this case, the
RA needs a way to inform the CA that it has done the POP. The RA POP
Witness control addresses this issue.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
<p id="section-6.8-2">The RA POP Witness control is identified by the OID:<a href="#section-6.8-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.8-3">
<pre>
  id-cmc-lraPOPWitness OBJECT IDENTIFIER ::= { id-cmc 11 }
</pre><a href="#section-6.8-3" class="pilcrow">¶</a>
</div>
<p id="section-6.8-4">The RA POP Witness control has the ASN.1 definition:<a href="#section-6.8-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.8-5">
<pre>
  LraPopWitness ::= SEQUENCE {
    pkiDataBodyid   BodyPartID,
    bodyIds         SEQUENCE of BodyPartID
    }
</pre><a href="#section-6.8-5" class="pilcrow">¶</a>
</div>
<p id="section-6.8-6">The fields in LraPOPWitness have the following meaning:<a href="#section-6.8-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.8-7.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.8-7.1.1.1">
                <p id="section-6.8-7.1.1.1.1">pkiDataBodyid contains the body part identifier of the nested
   TaggedContentInfo containing the client's Full PKI Request.
   pkiDataBodyid is set to 0 if the request is in the current
   PKIData.<a href="#section-6.8-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.8-8.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.8-8.1.1.1">
                <p id="section-6.8-8.1.1.1.1">bodyIds is a list of certification requests for which the RA has
   performed an out-of-band authentication. The method of
   authentication could be archival of private key material,
   challenge-response, or other means.<a href="#section-6.8-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.8-9">If a certification server does not allow an RA to do the POP
verification, it returns a CMCFailInfo with the value of popFailed.
The CA <span class="bcp14">MUST NOT</span> start a challenge-response to re-verify the POP
itself.<a href="#section-6.8-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="GetCertificateControl">
<section id="section-6.9">
        <h3 id="name-get-certificate-control">
<a href="#section-6.9" class="section-number selfRef">6.9. </a><a href="#name-get-certificate-control" class="section-name selfRef">Get Certificate Control</a>
        </h3>
<p id="section-6.9-1">Everything described in this section is optional to implement.<a href="#section-6.9-1" class="pilcrow">¶</a></p>
<p id="section-6.9-2">The Get Certificate control is used to retrieve a previously issued
certificate from a certificate repository. A CA, an RA, or an
independent service may provide this repository. The clients
expected to use this facility are those where a fully deployed
directory is either infeasible or undesirable.<a href="#section-6.9-2" class="pilcrow">¶</a></p>
<p id="section-6.9-3">The Get Certificate control is identified by the OID:<a href="#section-6.9-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.9-4">
<pre>
  id-cmc-getCert OBJECT IDENTIFIER ::= { id-cmc 15 }
</pre><a href="#section-6.9-4" class="pilcrow">¶</a>
</div>
<p id="section-6.9-5">The Get Certificate control has the ASN.1 definition:<a href="#section-6.9-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.9-6">
<pre>
  GetCert ::= SEQUENCE {
    issuerName    GeneralName,
    serialNumber  INTEGER }
</pre><a href="#section-6.9-6" class="pilcrow">¶</a>
</div>
<p id="section-6.9-7">The fields in GetCert have the following meaning:<a href="#section-6.9-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.9-8.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.9-8.1.1.1">
                <p id="section-6.9-8.1.1.1.1">issuerName is the name of the certificate issuer.<a href="#section-6.9-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.9-9.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.9-9.1.1.1">
                <p id="section-6.9-9.1.1.1.1">serialNumber identifies the certificate to be retrieved.<a href="#section-6.9-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.9-10">The server that responds to this request places the requested
certificate in the certificates field of a SignedData. If the Get
Certificate control is the only control in a Full PKI Request, the
response should be a Simple PKI Response.<a href="#section-6.9-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="GetCRLControl">
<section id="section-6.10">
        <h3 id="name-get-crl-control">
<a href="#section-6.10" class="section-number selfRef">6.10. </a><a href="#name-get-crl-control" class="section-name selfRef">Get CRL Control</a>
        </h3>
<p id="section-6.10-1">Everything described in this section is optional to implement.<a href="#section-6.10-1" class="pilcrow">¶</a></p>
<p id="section-6.10-2">The Get CRL control is used to retrieve CRLs from a repository of
CRLs. A CA, an RA, or an independent service may provide this
repository. The clients expected to use this facility are those
where a fully deployed directory is either infeasible or undesirable.<a href="#section-6.10-2" class="pilcrow">¶</a></p>
<p id="section-6.10-3">The Get CRL control is identified by the OID:<a href="#section-6.10-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.10-4">
<pre>
  id-cmc-getCRL OBJECT IDENTIFIER ::= { id-cmc 16 }
</pre><a href="#section-6.10-4" class="pilcrow">¶</a>
</div>
<p id="section-6.10-5">The Get CRL control has the ASN.1 definition:<a href="#section-6.10-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.10-6">
<pre>
  GetCRL ::= SEQUENCE {
    issuerName    Name,
    cRLName       GeneralName OPTIONAL,
    time          GeneralizedTime OPTIONAL,
    reasons       ReasonFlags OPTIONAL }
</pre><a href="#section-6.10-6" class="pilcrow">¶</a>
</div>
<p id="section-6.10-7">The fields in a GetCRL have the following meanings:<a href="#section-6.10-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.10-8.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.10-8.1.1.1">
                <p id="section-6.10-8.1.1.1.1">issuerName is the name of the CRL issuer.<a href="#section-6.10-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.10-9.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.10-9.1.1.1">
                <p id="section-6.10-9.1.1.1.1">cRLName may be the value of CRLDistributionPoints in the subject
   certificate or equivalent value in the event the certificate does
   not contain such a value.<a href="#section-6.10-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.10-10.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.10-10.1.1.1">
                <p id="section-6.10-10.1.1.1.1">time is used by the client to specify from among potentially several
   issues of CRL that one whose thisUpdate value is less than but
   nearest to the specified time. In the absence of a time
   component, the CA always returns with the most recent CRL.<a href="#section-6.10-10.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.10-11.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.10-11.1.1.1">
                <p id="section-6.10-11.1.1.1.1">reasons is used to specify from among CRLs partitioned by revocation
   reason. Implementers should bear in mind that while a specific
   revocation request has a single CRLReason code -- and consequently
   entries in the CRL would have a single CRLReason code value -- a
   single CRL can aggregate information for one or more reasonFlags.<a href="#section-6.10-11.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.10-12">A server responding to this request places the requested CRL in the
crls field of a SignedData. If the Get CRL control is the only
control in a Full PKI Request, the response should be a Simple PKI
Response.<a href="#section-6.10-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RevocationRequestControl">
<section id="section-6.11">
        <h3 id="name-revocation-request-control">
<a href="#section-6.11" class="section-number selfRef">6.11. </a><a href="#name-revocation-request-control" class="section-name selfRef">Revocation Request Control</a>
        </h3>
<p id="section-6.11-1">The Revocation Request control is used to request that a certificate
be revoked.<a href="#section-6.11-1" class="pilcrow">¶</a></p>
<p id="section-6.11-2">The Revocation Request control is identified by the OID:<a href="#section-6.11-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.11-3">
<pre>
  id-cmc-revokeRequest OBJECT IDENTIFIER ::= { id-cmc 17 }
</pre><a href="#section-6.11-3" class="pilcrow">¶</a>
</div>
<p id="section-6.11-4">The Revocation Request control has the ASN.1 definition:<a href="#section-6.11-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.11-5">
<pre>
  RevokeRequest ::= SEQUENCE {
    issuerName      Name,
    serialNumber    INTEGER,
    reason          CRLReason,
    invalidityDate  GeneralizedTime OPTIONAL,
    sharedSecret    OCTET STRING OPTIONAL,
    comment         UTF8string OPTIONAL }
</pre><a href="#section-6.11-5" class="pilcrow">¶</a>
</div>
<p id="section-6.11-6">The fields of RevokeRequest have the following meaning:<a href="#section-6.11-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.11-7.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.11-7.1.1.1">
                <p id="section-6.11-7.1.1.1.1">issuerName is the issuerName of the certificate to be revoked.<a href="#section-6.11-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.11-8.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.11-8.1.1.1">
                <p id="section-6.11-8.1.1.1.1">serialNumber is the serial number of the certificate to be revoked.<a href="#section-6.11-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.11-9.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.11-9.1.1.1">
                <p id="section-6.11-9.1.1.1.1">reason is the suggested CRLReason code for why the certificate is
   being revoked. The CA can use this value at its discretion in
   building the CRL.<a href="#section-6.11-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.11-10.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.11-10.1.1.1">
                <p id="section-6.11-10.1.1.1.1">invalidityDate is the suggested value for the Invalidity Date CRL
   Extension. The CA can use this value at its discretion in
   building the CRL.<a href="#section-6.11-10.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.11-11.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.11-11.1.1.1">
                <p id="section-6.11-11.1.1.1.1">sharedSecret is a secret value registered by the EE when the
   certificate was obtained to allow for revocation of a certificate
   in the event of key loss.<a href="#section-6.11-11.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.11-12">comment is a human-readable comment.<a href="#section-6.11-12" class="pilcrow">¶</a></p>
<p id="section-6.11-13">For a revocation request to be reliable in the event of a dispute, a
strong proof-of-origin is required. However, in the instance when an
EE has lost use of its signature private key, it is impossible for
the EE to produce a digital signature (prior to the certification of
a new signature key pair). The Revoke Request control allows the EE
to send the CA a shared-secret that may be used as an alternative
authenticator in the instance of loss of use of the EE's signature
private key. The acceptability of this practice is a matter of local
security policy.<a href="#section-6.11-13" class="pilcrow">¶</a></p>
<p id="section-6.11-14">It is possible to sign the revocation for the lost certificate with a
different certificate in some circumstances. A client can sign a
revocation for an encryption key with a signing certificate if the
name information matches. Similarly, an administrator or RA can be
assigned the ability to revoke the certificate of a third party.
Acceptance of the revocation by the server depends on local policy in
these cases.<a href="#section-6.11-14" class="pilcrow">¶</a></p>
<p id="section-6.11-15">Clients <span class="bcp14">MUST</span> provide the capability to produce a digitally signed
Revocation Request control. Clients <span class="bcp14">SHOULD</span> be capable of producing
an unsigned Revocation Request control containing the EE shared-
secret (the unsigned message consisting of a SignedData with no
signatures). If a client provides shared-secret-based self-
revocation, the client <span class="bcp14">MUST</span> be capable of producing a Revocation
Request control containing the shared-secret. Servers <span class="bcp14">MUST</span> be
capable of accepting both forms of revocation requests.<a href="#section-6.11-15" class="pilcrow">¶</a></p>
<p id="section-6.11-16">The structure of an unsigned, shared-secret-based revocation request
is a matter of local implementation. The shared-secret does not need
to be encrypted when sent in a Revocation Request control. The
shared-secret has a one-time use (i.e., it is used to request
revocation of the certificate), and public knowledge of the shared-
secret after the certificate has been revoked is not a problem.
Clients need to inform users that the same shared-secret <span class="bcp14">SHOULD NOT</span>
be used for multiple certificates.<a href="#section-6.11-16" class="pilcrow">¶</a></p>
<p id="section-6.11-17">A Full PKI Response <span class="bcp14">MUST</span> be returned for a revocation request.<a href="#section-6.11-17" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RegistrationandResponseInformationControls">
<section id="section-6.12">
        <h3 id="name-registration-and-response-i">
<a href="#section-6.12" class="section-number selfRef">6.12. </a><a href="#name-registration-and-response-i" class="section-name selfRef">Registration and Response Information Controls</a>
        </h3>
<p id="section-6.12-1">The Registration Information control allows for clients to pass
additional information as part of a Full PKI Request.<a href="#section-6.12-1" class="pilcrow">¶</a></p>
<p id="section-6.12-2">The Registration Information control is identified by the OID:<a href="#section-6.12-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.12-3">
<pre>
  id-cmc-regInfo OBJECT IDENTIFIER ::= { id-cmc 18 }
</pre><a href="#section-6.12-3" class="pilcrow">¶</a>
</div>
<p id="section-6.12-4">The Registration Information control has the ASN.1 definition:<a href="#section-6.12-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.12-5">
<pre>
  RegInfo ::= OCTET STRING
</pre><a href="#section-6.12-5" class="pilcrow">¶</a>
</div>
<p id="section-6.12-6">The content of this data is based on bilateral agreement between the
client and server.<a href="#section-6.12-6" class="pilcrow">¶</a></p>
<p id="section-6.12-7">The Response Information control allows a server to return additional
information as part of a Full PKI Response.<a href="#section-6.12-7" class="pilcrow">¶</a></p>
<p id="section-6.12-8">The Response Information control is identified by the OID:<a href="#section-6.12-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.12-9">
<pre>
  id-cmc-responseInfo  OBJECT IDENTIFIER ::= { id-cmc 19 }
</pre><a href="#section-6.12-9" class="pilcrow">¶</a>
</div>
<p id="section-6.12-10">The Response Information control has the ASN.1 definition:<a href="#section-6.12-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.12-11">
<pre>
  ResponseInfo ::= OCTET STRING
</pre><a href="#section-6.12-11" class="pilcrow">¶</a>
</div>
<p id="section-6.12-12">The content of this data is based on bilateral agreement between the
client and server.<a href="#section-6.12-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="QueryPendingControl">
<section id="section-6.13">
        <h3 id="name-query-pending-control">
<a href="#section-6.13" class="section-number selfRef">6.13. </a><a href="#name-query-pending-control" class="section-name selfRef">Query Pending Control</a>
        </h3>
<p id="section-6.13-1">In some environments, process requirements for manual intervention or
other identity checks can delay the return of the certificate. The
Query Pending control allows clients to query a server about the
state of a pending certification request. The server returns a
pendToken as part of the Extended CMC Status Info and the CMC Status
Info controls (in the otherInfo field). The client copies the
pendToken into the Query Pending control to identify the correct
certification request to the server. The server returns a suggested
time for the client to query for the state of a pending certification
request.<a href="#section-6.13-1" class="pilcrow">¶</a></p>
<p id="section-6.13-2">The Query Pending control is identified by the OID:<a href="#section-6.13-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.13-3">
<pre>
  id-cmc-queryPending  OBJECT IDENTIFIER ::= { id-cmc 21 }
</pre><a href="#section-6.13-3" class="pilcrow">¶</a>
</div>
<p id="section-6.13-4">The Query Pending control has the ASN.1 definition:<a href="#section-6.13-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.13-5">
<pre>
  QueryPending ::= OCTET STRING
</pre><a href="#section-6.13-5" class="pilcrow">¶</a>
</div>
<p id="section-6.13-6">If a server returns a pending or partial CMCStatusInfo (the
transaction is still pending), the otherInfo <span class="bcp14">MAY</span> be omitted. If the
otherInfo is not omitted, the value of 'pendInfo' <span class="bcp14">MUST</span> be the same as
the original pendInfo value.<a href="#section-6.13-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ConfirmCertificateAcceptanceControl">
<section id="section-6.14">
        <h3 id="name-confirm-certificate-accepta">
<a href="#section-6.14" class="section-number selfRef">6.14. </a><a href="#name-confirm-certificate-accepta" class="section-name selfRef">Confirm Certificate Acceptance Control</a>
        </h3>
<p id="section-6.14-1">Some CAs require that clients give a positive confirmation that the
certificates issued to the EE are acceptable. The Confirm
Certificate Acceptance control is used for that purpose. If the CMC
Status Info on a PKI Response is confirmRequired, then the client
<span class="bcp14">MUST</span> return a Confirm Certificate Acceptance control contained in a
Full PKI Request.<a href="#section-6.14-1" class="pilcrow">¶</a></p>
<p id="section-6.14-2">Clients <span class="bcp14">SHOULD</span> wait for the PKI Response from the server that the
confirmation has been received before using the certificate for any
purpose.<a href="#section-6.14-2" class="pilcrow">¶</a></p>
<p id="section-6.14-3">The Confirm Certificate Acceptance control is identified by the OID:<a href="#section-6.14-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.14-4">
<pre>
  id-cmc-confirmCertAcceptance  OBJECT IDENTIFIER ::= { id-cmc 24 }
</pre><a href="#section-6.14-4" class="pilcrow">¶</a>
</div>
<p id="section-6.14-5">The Confirm Certificate Acceptance control has the ASN.1 definition:<a href="#section-6.14-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.14-6">
<pre>
  CMCCertId ::= IssuerAndSerialNumber
</pre><a href="#section-6.14-6" class="pilcrow">¶</a>
</div>
<p id="section-6.14-7">CMCCertId contains the issuer and serial number of the certificate
being accepted.<a href="#section-6.14-7" class="pilcrow">¶</a></p>
<p id="section-6.14-8">Servers <span class="bcp14">MUST</span> return a Full PKI Response for a Confirm Certificate
Acceptance control.<a href="#section-6.14-8" class="pilcrow">¶</a></p>
<p id="section-6.14-9">Note that if the CA includes this control, there will be two full
round-trips of messages.<a href="#section-6.14-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.14-10">
<li id="section-6.14-10.1">
            <p id="section-6.14-10.1.1">The client sends the certification request to the CA.<a href="#section-6.14-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.14-10.2">
            <p id="section-6.14-10.2.1">The CA returns a Full PKI Response with the certificate and this
control.<a href="#section-6.14-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.14-10.3">
            <p id="section-6.14-10.3.1">The client sends a Full PKI Request to the CA with an Extended
CMC Status Info control accepting and a Confirm Certificate
Acceptance control or an Extended CMC Status Info control
rejecting the certificate.<a href="#section-6.14-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.14-10.4">
            <p id="section-6.14-10.4.1">The CA sends a Full PKI Response to the client with an Extended
CMC Status Info of success.<a href="#section-6.14-10.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="PublishTrustAnchorsControl">
<section id="section-6.15">
        <h3 id="name-publish-trust-anchors-contr">
<a href="#section-6.15" class="section-number selfRef">6.15. </a><a href="#name-publish-trust-anchors-contr" class="section-name selfRef">Publish Trust Anchors Control</a>
        </h3>
<p id="section-6.15-1">The Publish Trust Anchors control allows for the distribution of set
trust anchors from a central authority to an EE. The same control is
also used to update the set of trust anchors. Trust anchors are
distributed in the form of certificates. These are expected, but not
required, to be self-signed certificates. Information is extracted
from these certificates to set the inputs to the certificates
validation algorithm in Section 6.1.1 of <span>[<a href="#PKIXCERT" class="cite xref">PKIXCERT</a>]</span>.<a href="#section-6.15-1" class="pilcrow">¶</a></p>
<p id="section-6.15-2">The Publish Trust Anchors control is identified by the OID:<a href="#section-6.15-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.15-3">
<pre>
  id-cmc-trustedAnchors  OBJECT IDENTIFIER ::= { id-cmc 26 }
</pre><a href="#section-6.15-3" class="pilcrow">¶</a>
</div>
<p id="section-6.15-4">The Publish Trust Anchors control has the ASN.1 definition:<a href="#section-6.15-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.15-5">
<pre>
  PublishTrustAnchors ::= SEQUENCE {
    seqNumber      INTEGER,
    hashAlgorithm  AlgorithmIdentifier,
    anchorHashes   SEQUENCE OF OCTET STRING
  }
</pre><a href="#section-6.15-5" class="pilcrow">¶</a>
</div>
<p id="section-6.15-6">The fields in PublishTrustAnchors have the following meaning:<a href="#section-6.15-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.15-7.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.15-7.1.1.1">
                <p id="section-6.15-7.1.1.1.1">seqNumber is an integer indicating the location within a sequence of
   updates.<a href="#section-6.15-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.15-8.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.15-8.1.1.1">
                <p id="section-6.15-8.1.1.1.1">hashAlgorithm is the identifier and parameters for the hash
   algorithm that is used in computing the values of the anchorHashes
   field. All implementations <span class="bcp14">MUST</span> implement SHA-256 for this field.<a href="#section-6.15-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.15-9.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.15-9.1.1.1">
                <p id="section-6.15-9.1.1.1.1">anchorHashes are the hashes for the certificates that are to be
   treated as trust anchors by the client. The actual certificates
   are transported in the certificate bag of the containing
   SignedData structure.<a href="#section-6.15-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.15-10">While it is recommended that the sender place the certificates that
are to be trusted in the PKI Response, it is not required as the
certificates should be obtainable using normal discovery techniques.<a href="#section-6.15-10" class="pilcrow">¶</a></p>
<p id="section-6.15-11">Prior to accepting the trust anchors changes, a client <span class="bcp14">MUST</span> at least
do the following: validate the signature on the PKI Response to a
current trusted anchor, check with policy to ensure that the signer
is permitted to use the control, validate that the authenticated
publish time in the signature is near to the current time, and
validate that the sequence number is greater than the previously used
one.<a href="#section-6.15-11" class="pilcrow">¶</a></p>
<p id="section-6.15-12">In the event that multiple agents publish a set of trust anchors, it
is up to local policy to determine how the different trust anchors
should be combined. Clients <span class="bcp14">SHOULD</span> be able to handle the update of
multiple trust anchors independently.<a href="#section-6.15-12" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.15-13">
          <dt id="section-6.15-13.1">Note:</dt>
          <dd style="margin-left: 1.5em" id="section-6.15-13.2">
            <p id="section-6.15-13.2.1">Clients that handle this control must use extreme care in
validating that the operation is permissible. Incorrect handling of
this control allows for an attacker to change the set of trust
anchors on the client.<a href="#section-6.15-13.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="AuthenticatedDataControl">
<section id="section-6.16">
        <h3 id="name-authenticated-data-control">
<a href="#section-6.16" class="section-number selfRef">6.16. </a><a href="#name-authenticated-data-control" class="section-name selfRef">Authenticated Data Control</a>
        </h3>
<p id="section-6.16-1">The Authenticated Data control allows a server to provide data back
to the client in an authenticated manner. This control uses the
Authenticated Data structure to allow for validation of the data.
This control is used where the client has a shared-secret and a
secret identifier with the server, but where a trust anchor has not
yet been downloaded onto the client so that a signing certificate for
the server cannot be validated. The specific case that this control
was created for use with is the Publish Trust Anchors control
(<a href="#PublishTrustAnchorsControl" class="auto internal xref">Section 6.15</a>), but it may be used in other cases as well.<a href="#section-6.16-1" class="pilcrow">¶</a></p>
<p id="section-6.16-2">The Authenticated Data control is identified by the OID:<a href="#section-6.16-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.16-3">
<pre>
  id-cmc-authData OBJECT IDENTIFIER ::= { id-cmc 27 }
</pre><a href="#section-6.16-3" class="pilcrow">¶</a>
</div>
<p id="section-6.16-4">The Authenticated Data control has the ASN.1 definition:<a href="#section-6.16-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.16-5">
<pre>
  AuthPublish ::= BodyPartID
</pre><a href="#section-6.16-5" class="pilcrow">¶</a>
</div>
<p id="section-6.16-6">AuthPublish is a body part identifier that refers to a member of the
cmsSequence element for the current PKI Response or PKI Data.  The
cmsSequence element is AuthenticatedData. The encapsulated content
is an id-cct-PKIData. The controls in the controlSequence need to be
processed if the authentication succeeds. (One example is the
Publish Trust Anchors control in <a href="#PublishTrustAnchorsControl" class="auto internal xref">Section 6.15</a>.)<a href="#section-6.16-6" class="pilcrow">¶</a></p>
<p id="section-6.16-7">If the authentication operation fails, the CMCFailInfo authDataFail
is returned.<a href="#section-6.16-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="BatchRequestandResponseControls">
<section id="section-6.17">
        <h3 id="name-batch-request-and-response-">
<a href="#section-6.17" class="section-number selfRef">6.17. </a><a href="#name-batch-request-and-response-" class="section-name selfRef">Batch Request and Response Controls</a>
        </h3>
<p id="section-6.17-1">These controls allow for an RA to collect multiple requests together
into a single Full PKI Request and forward it to a CA. The server
would then process the requests and return the results in a Full PKI
Response.<a href="#section-6.17-1" class="pilcrow">¶</a></p>
<p id="section-6.17-2">The Batch Request control is identified by the OID:<a href="#section-6.17-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.17-3">
<pre>
  id-cmc-batchRequests OBJECT IDENTIFIER ::= { id-cmc 28 }
</pre><a href="#section-6.17-3" class="pilcrow">¶</a>
</div>
<p id="section-6.17-4">The Batch Response control is identified by the OID:<a href="#section-6.17-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.17-5">
<pre>
  id-cmc-batchResponses OBJECT IDENTIFIER ::= { id-cmc 29 }
</pre><a href="#section-6.17-5" class="pilcrow">¶</a>
</div>
<p id="section-6.17-6">Both the Batch Request and Batch Response controls have the ASN.1
definition:<a href="#section-6.17-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.17-7">
<pre>
  BodyPartList ::= SEQUENCE of BodyPartID
</pre><a href="#section-6.17-7" class="pilcrow">¶</a>
</div>
<p id="section-6.17-8">The data associated with these controls is a set of body part
identifiers. Each request/response is placed as an individual entry
in the cmcSequence of the new PKIData/PKIResponse. The body part
identifiers of these entries are then placed in the body part list
associated with the control.<a href="#section-6.17-8" class="pilcrow">¶</a></p>
<p id="section-6.17-9">When a server processes a Batch Request control, it <span class="bcp14">MAY</span> return the
responses in one or more PKI Responses. A CMCStatus value of partial
is returned on all but the last PKI Response. The CMCStatus would be
success if the Batch Requests control was processed; the responses
are created with their own CMCStatus code. Errors on individual
requests are not propagated up to the top level.<a href="#section-6.17-9" class="pilcrow">¶</a></p>
<p id="section-6.17-10">When a PKI Response with a CMCStatus value of partial is returned,
the Query Pending control (<a href="#QueryPendingControl" class="auto internal xref">Section 6.13</a>) is used to retrieve
additional results. The returned status includes a suggested time
after which the client should ask for the additional results.<a href="#section-6.17-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="PublicationInformationControl">
<section id="section-6.18">
        <h3 id="name-publication-information-con">
<a href="#section-6.18" class="section-number selfRef">6.18. </a><a href="#name-publication-information-con" class="section-name selfRef">Publication Information Control</a>
        </h3>
<p id="section-6.18-1">The Publication Information control allows for modifying publication
of already issued certificates, both for publishing and removal from
publication. A common usage for this control is to remove an
existing certificate from publication during a rekey operation. This
control should always be processed after the issuance of new
certificates and revocation requests. This control should not be
processed if a certificate failed to be issued.<a href="#section-6.18-1" class="pilcrow">¶</a></p>
<p id="section-6.18-2">The Publication Information control is identified by the OID:<a href="#section-6.18-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.18-3">
<pre>
  id-cmc-publishCert OBJECT IDENTIFIER ::= { id-cmc 30 }
</pre><a href="#section-6.18-3" class="pilcrow">¶</a>
</div>
<p id="section-6.18-4">The Publication Information control has the ASN.1 definition:<a href="#section-6.18-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.18-5">
<pre>
  CMCPublicationInfo ::= SEQUENCE {
    hashAlg     AlgorithmIdentifier,
    certHashes      SEQUENCE of OCTET STRING,
    pubInfo         PKIPublicationInfo
    }

  PKIPublicationInfo ::= SEQUENCE {
    action     INTEGER {
                        dontPublish (0),
                        pleasePublish (1) },
    pubInfos  SEQUENCE SIZE (1..MAX) OF SinglePubInfo OPTIONAL }

    -- pubInfos MUST NOT be present if action is "dontPublish"
    -- (if action is "pleasePublish" and pubInfos is omitted,
    -- "dontCare" is assumed)

  SinglePubInfo ::= SEQUENCE {
    pubMethod    INTEGER {
                         dontCare    (0),
                         x500        (1),
                         web         (2),
                         ldap        (3) },
     pubLocation  GeneralName OPTIONAL }
  }
</pre><a href="#section-6.18-5" class="pilcrow">¶</a>
</div>
<p id="section-6.18-6">The fields in CMCPublicationInfo have the following meaning:<a href="#section-6.18-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-7.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-7.1.1.1">
                <p id="section-6.18-7.1.1.1.1">hashAlg is the algorithm identifier of the hash algorithm used to
   compute the values in certHashes.<a href="#section-6.18-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-8.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-8.1.1.1">
                <p id="section-6.18-8.1.1.1.1">certHashes are the hashes of the certificates for which publication
   is to change.<a href="#section-6.18-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-9.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-9.1.1.1">
                <p id="section-6.18-9.1.1.1.1">pubInfo is the information where and how the certificates should be
   published. The fields in pubInfo (taken from <span>[<a href="#CRMF" class="cite xref">CRMF</a>]</span>) have the
   following meanings:<a href="#section-6.18-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-10.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-10.1.1.1">
                <ul class="normal">
<li class="normal" id="section-6.18-10.1.1.1.1.1">
                    <p id="section-6.18-10.1.1.1.1.1.1">action indicates the action the service should take. It has two
   values:<a href="#section-6.18-10.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-11.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-11.1.1.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-11.1.1.1.1.1">
                    <ul class="normal">
<li class="normal" id="section-6.18-11.1.1.1.1.1.1.1">
                        <p id="section-6.18-11.1.1.1.1.1.1.1.1">dontPublish indicates that the PKI should not publish the
    certificate (this may indicate that the requester intends to
    publish the certificate him/herself). dontPublish has the
    added connotation of removing from publication the
    certificate if it is already published.<a href="#section-6.18-11.1.1.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-12.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-12.1.1.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-12.1.1.1.1.1">
                    <ul class="normal">
<li class="normal" id="section-6.18-12.1.1.1.1.1.1.1">
                        <p id="section-6.18-12.1.1.1.1.1.1.1.1">pleasePublish indicates that the PKI <span class="bcp14">MAY</span> publish the
    certificate using whatever means it chooses unless pubInfos
    is present. Omission of the CMC Publication Info control
    results in the same behavior.<a href="#section-6.18-12.1.1.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-13.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.18-13.1.1.1">
                <ul class="normal">
<li class="normal" id="section-6.18-13.1.1.1.1.1">
                    <p id="section-6.18-13.1.1.1.1.1.1">pubInfos pubInfos indicates how (e.g., X500, Web, IP Address) the
   PKI <span class="bcp14">SHOULD</span> publish the certificate.<a href="#section-6.18-13.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.18-14">A single certificate <span class="bcp14">SHOULD NOT</span> appear in more than one Publication
Information control. The behavior is undefined in the event that it
does.<a href="#section-6.18-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ControlProcessedControl">
<section id="section-6.19">
        <h3 id="name-control-processed-control">
<a href="#section-6.19" class="section-number selfRef">6.19. </a><a href="#name-control-processed-control" class="section-name selfRef">Control Processed Control</a>
        </h3>
<p id="section-6.19-1">The Control Processed control allows an RA to indicate to subsequent
control processors that a specific control has already been
processed. This permits an RA in the middle of a processing stream
to process a control defined either in a local context or in a
subsequent document.<a href="#section-6.19-1" class="pilcrow">¶</a></p>
<p id="section-6.19-2">The Control Processed control is identified by the OID:<a href="#section-6.19-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.19-3">
<pre>
  id-cmc-controlProcessed  OBJECT IDENTIFIER ::= { id-cmc 32 }
</pre><a href="#section-6.19-3" class="pilcrow">¶</a>
</div>
<p id="section-6.19-4">The Control Processed control has the ASN.1 definition:<a href="#section-6.19-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.19-5">
<pre>
  ControlList ::= SEQUENCE {
    bodyList        SEQUENCE SIZE (1..MAX) OF BodyPartReference
  }
</pre><a href="#section-6.19-5" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.19-6.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.19-6.1.1.1">
                <p id="section-6.19-6.1.1.1.1">bodyList is a series of body part identifiers that form a path to
   each of the controls that were processed by the RA. This control
   is only needed for those controls that are not part of this
   standard and thus would cause an error condition of a server
   attempting to deal with a control not defined in this document.
   No error status is needed since an error causes the RA to return
   the request to the client with the error rather than passing the
   request on to the next server in the processing list.<a href="#section-6.19-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="RAIdentityProofWitnessControl">
<section id="section-6.20">
        <h3 id="name-ra-identity-proof-witness-c">
<a href="#section-6.20" class="section-number selfRef">6.20. </a><a href="#name-ra-identity-proof-witness-c" class="section-name selfRef">RA Identity Proof Witness Control</a>
        </h3>
<p id="section-6.20-1">The RA Identity Proof Witness control allows an RA to indicate to
subsequent control processors that all of the identity proof
requirements have been met.  This permits the identity proof to be
performed at a location closer to the end-entity.  For example, the
identity proof could be done at multiple physical locations, while
the CA could operate on a company-wide basis.  The RA performs the
identity proof, and potentially other tasks that require the secret
to be used, while the CA is prevented from knowing the secret.  If
the identity proof fails, then the RA returns an error to the client
denoting that fact.<a href="#section-6.20-1" class="pilcrow">¶</a></p>
<p id="section-6.20-2">The RA Identity Proof Witness control is identified by the OID:<a href="#section-6.20-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.20-3">
<pre>
 id-cmc-raIdentityWitness OBJECT IDENTIFIER ::= { id-cmc 35 }
</pre><a href="#section-6.20-3" class="pilcrow">¶</a>
</div>
<p id="section-6.20-4">The RA Identity Proof Witness control has the ASN.1 definition:<a href="#section-6.20-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.20-5">
<pre>
  cmc-raIdentityWitness CMC-CONTROL ::=
    { BodyPartPath IDENTIFIED BY id-cmc-raIdentityWitness }
</pre><a href="#section-6.20-5" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-6.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-6.1.1.1">
                <p id="section-6.20-6.1.1.1.1">cmc-raIdentityWitness is a CMC-CONTROL associating the object
   identifier id-cmc-raIdentityWitness and the type BodyPartPath.
   This object is omitted from the 1988 module.  The object is added
   to the object set Cmc-Control-Set.  The control is permitted to
   appear only in the control sequence of a PKIData object.  It <span class="bcp14">MUST NOT</span> appear in the control sequence of a PKIResponse.  The control
   is permitted to be used only by an RA.  The control may appear
   multiple times in a control sequence with each occurrence pointing
   to a different object.<a href="#section-6.20-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-7.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-7.1.1.1">
                <p id="section-6.20-7.1.1.1.1">id-cmc-raIdentityWitness is the object identifier used to identify
   this CMC control.<a href="#section-6.20-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-8.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-8.1.1.1">
                <p id="section-6.20-8.1.1.1.1">BodyPartPath is the type structure associated with the control.  The
   syntax of BodyPartPath is defined in <a href="#BodyPartIdentification" class="auto internal xref">Section 3.2.2</a>.  The path
   contains a sequence of body part identifiers leading to one of the
   following items:<a href="#section-6.20-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-9.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-9.1.1.1">
                <ul class="normal">
<li class="normal" id="section-6.20-9.1.1.1.1.1">
                    <p id="section-6.20-9.1.1.1.1.1.1">Identity Proof control if the RA verified the identity proof in
   this control.<a href="#section-6.20-9.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-10.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-10.1.1.1">
                <ul class="normal">
<li class="normal" id="section-6.20-10.1.1.1.1.1">
                    <p id="section-6.20-10.1.1.1.1.1.1">Identity Proof Version 2 control if the RA verified the identity
   proof in this control.<a href="#section-6.20-10.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-11.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-11.1.1.1">
                <ul class="normal">
<li class="normal" id="section-6.20-11.1.1.1.1.1">
                    <p id="section-6.20-11.1.1.1.1.1.1">Full PKI Request if the RA performed an out-of-band identity
   proof for this request.  The request <span class="bcp14">SHOULD NOT</span> contain either
   Identity Proof control.<a href="#section-6.20-11.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-12.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.20-12.1.1.1">
                <ul class="normal">
<li class="normal" id="section-6.20-12.1.1.1.1.1">
                    <p id="section-6.20-12.1.1.1.1.1.1">Simple PKI Request  if the RA performed an out-of-band identity
   proof for this request.<a href="#section-6.20-12.1.1.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.20-13">The RA Identity Proof Witness control will frequently be associated
with a Modify Certification Request control, which changes the name
fields in the associated certification requests.  This is because the
RA knows the actual name to be assigned to the entity requesting the
certificate, and the end-entity does not yet have the details of the
name.  (The association would be set up by the operator at the time
the shared-secret was generated by the RA.)<a href="#section-6.20-13" class="pilcrow">¶</a></p>
<p id="section-6.20-14">When this control is placed in a message, it is <span class="bcp14">RECOMMENDED</span> that the
Control Processed control be placed in the body sequence as well.
Using the explicit new control, rather than implicitly relying on the
Control Processed control is important due to the need to know
explicitly which identity proofs have been performed.  The new
control also allows an RA to state that out-of-band identity proofs
have been performed.<a href="#section-6.20-14" class="pilcrow">¶</a></p>
<p id="section-6.20-15">When the identity proof is performed by an RA, the RA also <span class="bcp14">MUST</span>
validate the linking between the identity proof and the name
information wrapped inside of the key proof-of-possession.<a href="#section-6.20-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ResponseBodyControl">
<section id="section-6.21">
        <h3 id="name-response-body-control">
<a href="#section-6.21" class="section-number selfRef">6.21. </a><a href="#name-response-body-control" class="section-name selfRef">Response Body Control</a>
        </h3>
<p id="section-6.21-1">The Response Body Control is designed to enable an RA to inform an EE
that there is an embedded response message that <span class="bcp14">MUST</span> be processed as
part of the processing of this message.  This control is designed to
be used in a couple of different cases where an RA has done some
additional processing for the certification request, e.g., as key
generation.  When an RA performs key generation on behalf of an EE,
the RA <span class="bcp14">MUST</span> respond with both the original response message from the
certificate issuer (containing the certificate issuance) as part of
the response generated by the RA (containing the new key).  Another
case where this is useful is when the secret is shared between the RA
and the EE (rather than between the CA and the EE) and the RA returns
the Publish Trust Anchors control (to populate the correct trust
points).<a href="#section-6.21-1" class="pilcrow">¶</a></p>
<p id="section-6.21-2">The Response Body Control is identified by the OID:<a href="#section-6.21-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.21-3">
<pre>
  id-cmc-responseBody OBJECT IDENTIFIER ::= { id-cmc 37 }
</pre><a href="#section-6.21-3" class="pilcrow">¶</a>
</div>
<p id="section-6.21-4">The Response Body Control has the ASN.1 definition:<a href="#section-6.21-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.21-5">
<pre>
  cmc-responseBody CMC-CONTROL ::= {
     BodyPartPath IDENTIFIED BY id-cmc-responseBody
  }
</pre><a href="#section-6.21-5" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.21-6.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.21-6.1.1.1">
                <p id="section-6.21-6.1.1.1.1">cmc-responseBody  is a CMC-CONTROL associating the object identifier
   id-cmc-responseBody with the type BodyPartPath.  This object is
   omitted from the 1988 module.  The object is added to the object
   set Cmc-Control-Set.  The control is permitted to appear only in
   the control sequence of a PKIResponse.  The control <span class="bcp14">MUST NOT</span>
   appear in the control sequence of a PKIData.  It is expected that
   only an intermediary RA will use this control; a CA generally does
   not need the control as it is creating the original innermost
   message.<a href="#section-6.21-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.21-7.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.21-7.1.1.1">
                <p id="section-6.21-7.1.1.1.1">id-cmc-responseBody is the object identifier used to identify this
   CMC control.<a href="#section-6.21-7.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.21-8.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.21-8.1.1.1">
                <p id="section-6.21-8.1.1.1.1">BodyPartPath is the type structure associated with the control.  The
   syntax of BodyPartPath is defined in <a href="#BodyPartIdentification" class="auto internal xref">Section 3.2.2</a>.  The path
   contains a sequence of body part identifiers leading to a
   cmsSequence item which contains a PKIResponse within it.<a href="#section-6.21-8.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="OtherAttributes">
<section id="section-7">
      <h2 id="name-other-attributes">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-other-attributes" class="section-name selfRef">Other Attributes</a>
      </h2>
<p id="section-7-1">There are a number of different locations where various types of
attributes can be placed in either a CMC request or a CMC response
message.  These places include the attribute sequence of a PKCS #10
request, controls in CRMF <span><a href="https://rfc-editor.org/rfc/rfc4211#section-6" class="relref">Section 6</a> of [<a href="#CRMF" class="cite xref">CRMF</a>]</span>, and the various
CMS attribute sequences.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="ChangeSubjectNameAttribute">
<section id="section-7.1">
        <h3 id="name-change-subject-name-attribu">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-change-subject-name-attribu" class="section-name selfRef">Change Subject Name Attribute</a>
        </h3>
<p id="section-7.1-1">The Client Name Change Request attribute is designed for a client to
ask for a change in its name as part of a certification request.
Because of security issues, this cannot be done in the simple way of
just changing the requested subject name in the certificate template.
The name in the certification request <span class="bcp14">MUST</span> match the name in the
certificate used to verify the request, in order that identity and
possession proofs are correctly applied.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">The relevant ASN.1 for the Client Name Change Request attribute is as
follows:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-3">
<pre>
  at-cmc-changeSubjectName ATTRIBUTE ::=
    { ChangeSubjectName IDENTIFIED BY id-cmc-changeSubjectName }

  id-cmc-changeSubjectName OBJECT IDENTIFIER ::= { id-cmc 36 }

  ChangeSubjectName ::= SEQUENCE {
    subject             Name OPTIONAL,
    subjectAlt          SubjectAltName OPTIONAL
  }
  (WITH COMPONENTS {..., subject PRESENT} |
    COMPONENTS {..., subjectAlt PRESENT} )
</pre><a href="#section-7.1-3" class="pilcrow">¶</a>
</div>
<p id="section-7.1-4">The attribute is designed to be used as an ATTRIBUTE object.  As
such, the attribute is placed in one of the following two places:<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.1-5.1">
            <p id="section-7.1-5.1.1">The attributes field in a CertificationRequest.<a href="#section-7.1-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.1-6.1">
            <p id="section-7.1-6.1.1">The controls field of a CertRequest for a CRMF certification
  request.<a href="#section-7.1-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.1-7">The control is identified by the Object Identifier
id-cmc-changeSubjectName.<a href="#section-7.1-7" class="pilcrow">¶</a></p>
<p id="section-7.1-8">The ASN.1 type associated with control is ChangeSubjectName.  The
fields of the structure are configured as follows:<a href="#section-7.1-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.1-9.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.1-9.1.1.1">
                <p id="section-7.1-9.1.1.1.1">subject  contains the requested subject name for the new certificate.<a href="#section-7.1-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.1-10.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.1-10.1.1.1">
                <p id="section-7.1-10.1.1.1.1">subjectAlt  contains the requested subject alternative name for the
   new certificate.<a href="#section-7.1-10.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-7.1-11">At least one of the fields in the sequence <span class="bcp14">MUST</span> be present when
encoding the structure.<a href="#section-7.1-11" class="pilcrow">¶</a></p>
<p id="section-7.1-12">When the CA processes this attribute in a certification request, it
will do the following:<a href="#section-7.1-12" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.1-13">
<li id="section-7.1-13.1">
            <p id="section-7.1-13.1.1">If present, the subject field is copied to the name field of the
template.  If the subject field is absent, the name field of the
template will be set to a empty sequence.<a href="#section-7.1-13.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-13.2">
            <p id="section-7.1-13.2.1">If present, the subjectAlt field is used as the content of a
SubjectAltName extension in the certificate.  If the subjectAlt
field is absent, the subjectAltName extension is removed from the
certificate template.<a href="#section-7.1-13.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="RegistrationAuthorities">
<section id="section-8">
      <h2 id="name-registration-authorities">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-registration-authorities" class="section-name selfRef">Registration Authorities</a>
      </h2>
<p id="section-8-1">This specification permits the use of RAs. An RA sits between the EE
and the CA. From the EE's perspective, the RA appears to be the CA,
and from the server, the RA appears to be a client. RAs receive the
PKI Requests, perform local processing and then forward them onto
CAs. Some of the types of local processing that an RA can perform
include:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">
          <p id="section-8-2.1.1">Batching multiple PKI Requests together,<a href="#section-8-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.2">
          <p id="section-8-2.2.1">Performing challenge/response POP proofs,<a href="#section-8-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.3">
          <p id="section-8-2.3.1">Adding private or standardized certificate extensions to all
certification requests,<a href="#section-8-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.4">
          <p id="section-8-2.4.1">Archiving private key material,<a href="#section-8-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.5">
          <p id="section-8-2.5.1">Routing requests to different CAs.<a href="#section-8-2.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-3">When an RA receives a PKI Request, it has three options: it may
forward the PKI Request without modification, it may add a new
wrapping layer to the PKI Request, or it may remove one or more
existing layers and add a new wrapping layer.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">When an RA adds a new wrapping layer to a PKI Request, it creates a
new PKIData. The new layer contains any controls required (for
example, if the RA does the POP proof for an encryption key or the
Add Extension control to modify a PKI Request) and the client PKI
Request. The client PKI Request is placed in the cmsSequence if it
is a Full PKI Request and in the reqSequence if it is a Simple PKI
Request. If an RA is batching multiple client PKI Requests together,
then each client PKI Request is placed into the appropriate location
in the RA's PKIData object along with all relevant controls.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">If multiple RAs are in the path between the EE and the CA, this will
lead to multiple wrapping layers on the request.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">In processing a PKI Request, an RA <span class="bcp14">MUST NOT</span> alter any certification
requests (PKCS #10 or CRMF) as any alteration would invalidate the
signature on the certification request and thus the POP for the
private key.<a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7">An example of how this would look is illustrated by the following
figure:<a href="#section-8-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8-8">
<pre>
  SignedData (by RA)
     PKIData
       controlSequence
         RA added control statements
       reqSequence
         Zero or more Simple PKI Requests from clients
        cmsSequence
             Zero or more Full PKI Requests from clients
               SignedData (signed by client)
               PKIData
</pre><a href="#section-8-8" class="pilcrow">¶</a>
</div>
<p id="section-8-9">Under some circumstances, an RA is required to remove wrapping
layers. The following sections look at the processing required if
encryption layers and signing layers need to be removed.<a href="#section-8-9" class="pilcrow">¶</a></p>
<div id="EncryptionRemoval">
<section id="section-8.1">
        <h3 id="name-encryption-removal">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-encryption-removal" class="section-name selfRef">Encryption Removal</a>
        </h3>
<p id="section-8.1-1">There are two cases that require an RA to remove or change encryption
in a PKI Request. In the first case, the encryption was applied for
the purposes of protecting the entire PKI Request from unauthorized
entities. If the CA does not have a Recipient Info entry in the
encryption layer, the RA <span class="bcp14">MUST</span> remove the encryption layer. The RA
<span class="bcp14">MAY</span> add a new encryption layer with or without adding a new signing
layer.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">The second change of encryption that may be required is to change the
encryption inside of a signing layer. In this case, the RA <span class="bcp14">MUST</span>
remove all signing layers containing the encryption. All control
statements <span class="bcp14">MUST</span> be merged according to local policy rules as each
signing layer is removed and the resulting merged controls <span class="bcp14">MUST</span> be
placed in a new signing layer provided by the RA. If the signing
layer provided by the EE needs to also be removed, the RA can also
remove this layer.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SignatureRemoval">
<section id="section-8.2">
        <h3 id="name-signature-layer-removal">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-signature-layer-removal" class="section-name selfRef">Signature Layer Removal</a>
        </h3>
<p id="section-8.2-1">Only two instances exist where an RA should remove a signature layer
on a Full PKI Request: if an encryption layer needs to be modified
within the request, or if a CA will not accept secondary delegation
(i.e., multiple RA signatures). In all other situations, RAs <span class="bcp14">SHOULD NOT</span> remove a signing layer from a PKI Request.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">If an RA removes a signing layer from a PKI Request, all control
statements <span class="bcp14">MUST</span> be merged according to local policy rules. The
resulting merged control statements <span class="bcp14">MUST</span> be placed in a new signing
layer provided by the RA.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="CertificateRequirements">
<section id="section-9">
      <h2 id="name-certificate-requirements">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-certificate-requirements" class="section-name selfRef">Certificate Requirements</a>
      </h2>
<p id="section-9-1">Certificates for servers used in the CMC protocol <span class="bcp14">SHOULD</span> conform to
the profile defined in <span>[<a href="#PKIXCERT" class="cite xref">PKIXCERT</a>]</span>.  This document defines some
additional items that <span class="bcp14">MAY</span> appear in CMC server certificates.  <a href="#ExtendedKeyUsage" class="auto internal xref">Section 9.1</a>
defines some additional values for the Extended Key Usage
extension.  <a href="#SubjectInformationAccess" class="auto internal xref">Section 9.2</a> defines a new Subject Information Access
value that allows for a CMC certificate to publish information on how
to contact the services it provides.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="ExtendedKeyUsage">
<section id="section-9.1">
        <h3 id="name-extended-key-usage">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-extended-key-usage" class="section-name selfRef">Extended Key Usage</a>
        </h3>
<p id="section-9.1-1">The Extended Key Usage (EKU) extension is used to restrict the use of
a certificate to specific applications.  We define three different
EKUs in this document.  The ASN.1 to define these EKUs is:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1-2">
<pre>
  id-kp-cmcCA      OBJECT IDENTIFIER ::= { id-kp 27 }
  id-kp-cmcRA      OBJECT IDENTIFIER ::= { id-kp 28 }
  id-kp-cmcArchive OBJECT IDENTIFIER ::= { id-kp 29 }
</pre><a href="#section-9.1-2" class="pilcrow">¶</a>
</div>
<p id="section-9.1-3">The usage description for each of the EKUs is as follows:<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.1-4.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.1-4.1.1.1">
                <p id="section-9.1-4.1.1.1.1">CMC Certification Authorities  are identified by the id-kp-cmcCA
   extended key usage.  The certificate may be the same as or
   different than the CA certificate.  If a different certificate is
   used, the certificates containing the id-kp-cmcCA extended key
   usage <span class="bcp14">SHOULD</span> have the same name as the certificate used for
   issuing the certificates.  (Using a separate key pair for CMC
   protocol operations and for issuing certificates and CRLs
   decreases the number of operations for which the private key used
   to sign certificates and CRLs would be used.)<a href="#section-9.1-4.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.1-5.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.1-5.1.1.1">
                <p id="section-9.1-5.1.1.1.1">CMC Registration Authorities  are identified by the id-kp-cmcRA
   extended key usage.  This usage is placed into RA certificates.<a href="#section-9.1-5.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.1-6.1">
            <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.1-6.1.1.1">
                <p id="section-9.1-6.1.1.1.1">CMC Archive Servers  are identified by the id-kp-cmcArchive extended
   key usage.  CMC Archive Servers and the associated protocol are to
   be defined in a future document.<a href="#section-9.1-6.1.1.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="SubjectInformationAccess">
<section id="section-9.2">
        <h3 id="name-subject-information-access">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-subject-information-access" class="section-name selfRef">Subject Information Access</a>
        </h3>
<p id="section-9.2-1">The subject information access extension indicates how to access
information and services for the subject of the certificate.  We
define a new value for use in this extension, to identify the
different locations that CMC services will be available.  If this
value is placed in a certificate, an appropriate extended key usage
defined in <a href="#ExtendedKeyUsage" class="auto internal xref">Section 9.1</a> <span class="bcp14">MUST</span> be included in the certificate as well.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">The id-ad-cmc OID is used when the subject offers certification
services using the CMC protocol.  If the CMC services are available
via HTTP or FTP, accessLocation <span class="bcp14">MUST</span> be a uniformResourceIdentifier.
If the CMC services are available via electronic mail, accessLocation
<span class="bcp14">MUST</span> be an rfc822Name.  If CMC services are available using TCP/IP,
the dNSName or iPAddress name forms <span class="bcp14">MUST</span> be used.  Since the
GeneralName data structure does not permit the inclusion of a port
number, in the absence of other external configuration information,
the value of 5318 should be used.  (The port registration is in
<a href="#FullPKIRequest" class="auto internal xref">Section 3.2</a>)  The semantics of other name forms of accessLocation
(when accessMethod is id-ad-cmc) are not defined by this
specification.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">The ASN.1 type for this extension is GeneralName see <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.8" class="relref">Section 4.2.1.8</a> of [<a href="#PKIXCERT" class="cite xref">PKIXCERT</a>]</span>.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2-4">
<pre>
  id-ad-cmc OBJECT IDENTIFIER ::= { id-ad 12 }
</pre><a href="#section-9.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="SecurityConsiderations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">Mechanisms for thwarting replay attacks may be required in particular
implementations of this protocol depending on the operational
environment. In cases where the CA maintains significant state
information, replay attacks may be detectable without the inclusion
of the optional nonce mechanisms. Implementers of this protocol need
to carefully consider environmental conditions before choosing
whether or not to implement the senderNonce and recipientNonce
controls described in <a href="#TransactionIdentifierControlandSenderandRecipientNonceControls" class="auto internal xref">Section 6.6</a>.  Developers of state-constrained
PKI clients are strongly encouraged to incorporate the use of these
controls.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Extreme care needs to be taken when archiving a signing key. The
holder of the archived key may have the ability to use the key to
generate forged signatures. There are however reasons why a signing
key should be archived. An archived CA signing key can be recovered
in the event of failure to continue to produced CRLs following a
disaster.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Due care must be taken prior to archiving keys. Once a key is given
to an archiving entity, the archiving entity could use the keys in a
way not conducive to the archiving entity. Users should be made
especially aware that proper verification is made of the certificate
used to encrypt the private key material.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">Clients and servers need to do some checks on cryptographic
parameters prior to issuing certificates to make sure that weak
parameters are not used. A description of the small subgroup attack
is provided in <span>[<a href="#X942" class="cite xref">X942</a>]</span>. Methods of avoiding the small subgroup attack
can be found in <span>[<a href="#SMALL-GROUP" class="cite xref">SMALL-GROUP</a>]</span>. CMC implementations ought to be aware
of this attack when doing parameter validations.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">When using a shared-secret for authentication purposes, the shared-
secret should be generated using good random number techniques
<span>[<a href="#RANDOM" class="cite xref">RANDOM</a>]</span>. User selection of the secret allows for dictionary attacks
to be mounted.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">Extreme care must be used when processing the Publish Trust Anchors
control. Incorrect processing can lead to the practice of slamming
where an attacker changes the set of trusted anchors in order to
weaken security.<a href="#section-10-6" class="pilcrow">¶</a></p>
<p id="section-10-7">One method of controlling the use of the Publish Trust Anchors
control is as follows. The client needs to associate with each trust
anchor accepted by the client the source of the trust anchor.
Additionally, the client should associate with each trust anchor the
types of messages for which the trust anchor is valid (i.e., is the
trust anchor used for validating S/MIME messages, TLS, or CMC
enrollment messages?).<a href="#section-10-7" class="pilcrow">¶</a></p>
<p id="section-10-8">When a new message is received with a Publish Trust Anchors control,
the client would accept the set of new trust anchors for specific
applications only if the signature validates, the signer of the
message has the required policy approval for updating the trust
anchors, and local policy also would allow updating the trust
anchors.<a href="#section-10-8" class="pilcrow">¶</a></p>
<p id="section-10-9">The CMS AuthenticatedData structure provides message integrity, it
does not provide message authentication in all cases. When using
MACs in this document the following restrictions need to be observed.
All messages should be for a single entity. If two entities are
placed in a single message, the entities can generate new messages
that have a valid MAC and might be assumed to be from the original
message sender. All entities that have access to the shared-secret
can generate messages that will have a successful MAC validation.
This means that care must be taken to keep this value secret.
Whenever possible, the SignedData structure should be used in
preference to the AuthenticatedData structure.<a href="#section-10-9" class="pilcrow">¶</a></p>
<p id="section-10-10">A number of controls such as the RA Identity Proof Witness control
exist for an RA to either make assertions about or modify a
certification request.  Any upstream request processor, such as a CA,
<span class="bcp14">MUST</span> verify that the RA is fully identified and authorized to make
the assertion or modification it is claiming.  If it is not
identified or authorized, then any request <span class="bcp14">MUST</span> be rejected.<a href="#section-10-10" class="pilcrow">¶</a></p>
<p id="section-10-11">CMC servers, both RAs and CAs, need to perform due diligence in
checking the contents of a certification request.  At an absolute
minimum, all fields should be checked to ensure that the policies of
the CA/RA are correctly enforced.  While all fields need to be
checked, special care should be taken with names, name forms,
algorithm choices, and algorithm parameters.<a href="#section-10-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANAConsiderations">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">This document defines a number of control objects.  These are
identified by Object Identifiers (OIDs).  The objects are defined
from an arc delegated by IANA to the PKIX Working Group.  No further
action by IANA is necessary for this document or any anticipated
updates.<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="CMS">[CMS]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5652">https://www.rfc-editor.org/rfc/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CMS-ALGS">[CMS-ALGS]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME"</span>, <span class="seriesInfo">RFC 5911</span>, <span class="seriesInfo">DOI 10.17487/RFC5911</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5911">https://www.rfc-editor.org/rfc/rfc5911</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CRMF">[CRMF]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4211">https://www.rfc-editor.org/rfc/rfc4211</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DH-POP">[DH-POP]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">H. Prafullchandra</span>, <span class="refTitle">"Diffie-Hellman Proof-of-Possession Algorithms"</span>, <span class="seriesInfo">RFC 6955</span>, <span class="seriesInfo">DOI 10.17487/RFC6955</span>, <time datetime="2013-05" class="refDate">May 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6955">https://www.rfc-editor.org/rfc/rfc6955</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HMAC-ALGS">[HMAC-ALGS]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 6268</span>, <span class="seriesInfo">DOI 10.17487/RFC6268</span>, <time datetime="2011-07" class="refDate">July 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6268">https://www.rfc-editor.org/rfc/rfc6268</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PKCS10">[PKCS10]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2986">https://www.rfc-editor.org/rfc/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PKIX-ALGS">[PKIX-ALGS]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5912">https://www.rfc-editor.org/rfc/rfc5912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PKIXCERT">[PKIXCERT]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CMC-COMPL">[CMC-COMPL]</dt>
        <dd>
<span class="refAuthor">Mandel, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Certificate Management Messages over CMS (CMC): Compliance Requirements"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mandel-lamps-rfc5274bis-02</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-mandel-lamps-rfc5274bis-02">https://datatracker.ietf.org/doc/html/draft-mandel-lamps-rfc5274bis-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CMC-PROTv1">[CMC-PROTv1]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC)"</span>, <span class="seriesInfo">RFC 5272</span>, <span class="seriesInfo">DOI 10.17487/RFC5272</span>, <time datetime="2008-06" class="refDate">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5272">https://www.rfc-editor.org/rfc/rfc5272</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CMC-TRANS">[CMC-TRANS]</dt>
        <dd>
<span class="refAuthor">Mandel, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Certificate Management over CMS (CMC): Transport Protocols"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mandel-lamps-rfc5273bis-02</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-mandel-lamps-rfc5273bis-02">https://datatracker.ietf.org/doc/html/draft-mandel-lamps-rfc5273bis-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CMC-Updates">[CMC-Updates]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Certificate Management over CMS (CMC) Updates"</span>, <span class="seriesInfo">RFC 6402</span>, <span class="seriesInfo">DOI 10.17487/RFC6402</span>, <time datetime="2011-11" class="refDate">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6402">https://www.rfc-editor.org/rfc/rfc6402</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="erratum2063">[erratum2063]</dt>
        <dd>
<span class="refTitle">"RFC 5272 erratum 2063"</span>, <time datetime="2010-03-04" class="refDate">4 March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2063">https://www.rfc-editor.org/errata/eid2063</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="erratum2731">[erratum2731]</dt>
        <dd>
<span class="refTitle">"RFC 5272 erratum 2731"</span>, <time datetime="2011-02-23" class="refDate">23 February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid2731">https://www.rfc-editor.org/errata/eid2731</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="erratum4775">[erratum4775]</dt>
        <dd>
<span class="refTitle">"RFC 5272 erratum 4775"</span>, <time datetime="2016-08-11" class="refDate">11 August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid4775">https://www.rfc-editor.org/errata/eid4775</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="erratum7379">[erratum7379]</dt>
        <dd>
<span class="refTitle">"RFC 5272 erratum 7379"</span>, <time datetime="2023-03-08" class="refDate">8 March 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid7379">https://www.rfc-editor.org/errata/eid7379</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="erratum7627">[erratum7627]</dt>
        <dd>
<span class="refTitle">"RFC 5272 erratum 7627"</span>, <time datetime="2023-09-04" class="refDate">4 September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid7627">https://www.rfc-editor.org/errata/eid7627</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="erratum7628">[erratum7628]</dt>
        <dd>
<span class="refTitle">"RFC 5272 erratum 7628"</span>, <time datetime="2023-09-04" class="refDate">4 September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid7628">https://www.rfc-editor.org/errata/eid7628</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="erratum7629">[erratum7629]</dt>
        <dd>
<span class="refTitle">"RFC 5272 erratum 7629"</span>, <time datetime="2023-09-04" class="refDate">4 September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid7629">https://www.rfc-editor.org/errata/eid7629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PASSWORD">[PASSWORD]</dt>
        <dd>
<span class="refAuthor">Grassi, P.</span>, <span class="refAuthor">Garcia, M.</span>, and <span class="refAuthor">J. Fenton</span>, <span class="refTitle">"Digital identity guidelines: revision 3"</span>, <span class="refContent">National Institute of Standards and Technology</span>, <span class="seriesInfo">DOI 10.6028/nist.sp.800-63-3</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.sp.800-63-3">https://doi.org/10.6028/nist.sp.800-63-3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RANDOM">[RANDOM]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4086">https://www.rfc-editor.org/rfc/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2797">[RFC2797]</dt>
        <dd>
<span class="refAuthor">Myers, M.</span>, <span class="refAuthor">Liu, X.</span>, <span class="refAuthor">Schaad, J.</span>, and <span class="refAuthor">J. Weinstein</span>, <span class="refTitle">"Certificate Management Messages over CMS"</span>, <span class="seriesInfo">RFC 2797</span>, <span class="seriesInfo">DOI 10.17487/RFC2797</span>, <time datetime="2000-04" class="refDate">April 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2797">https://www.rfc-editor.org/rfc/rfc2797</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SMALL-GROUP">[SMALL-GROUP]</dt>
        <dd>
<span class="refAuthor">Zuccherato, R.</span>, <span class="refTitle">"Methods for Avoiding the "Small-Subgroup" Attacks on the Diffie-Hellman Key Agreement Method for S/MIME"</span>, <span class="seriesInfo">RFC 2785</span>, <span class="seriesInfo">DOI 10.17487/RFC2785</span>, <time datetime="2000-03" class="refDate">March 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2785">https://www.rfc-editor.org/rfc/rfc2785</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X942">[X942]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Diffie-Hellman Key Agreement Method"</span>, <span class="seriesInfo">RFC 2631</span>, <span class="seriesInfo">DOI 10.17487/RFC2631</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2631">https://www.rfc-editor.org/rfc/rfc2631</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="ASN.1">
<section id="appendix-A">
      <h2 id="name-asn1-modules">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-asn1-modules" class="section-name selfRef">ASN.1 Modules</a>
      </h2>
<div id="asn.1-cmc">
<section id="appendix-A.1">
        <h3 id="name-asn1-module-for-cmc">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-asn1-module-for-cmc" class="section-name selfRef">ASN.1 Module for CMC</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-A.1-1">
<pre>
EnrollmentMessageSyntax-2023
    { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-enrollMsgSyntax-2023(TBD) }

DEFINITIONS IMPLICIT TAGS ::=

BEGIN

  EXPORTS ALL;

  IMPORTS

  AttributeSet{}, Extension{}, EXTENSION, ATTRIBUTE
  FROM PKIX-CommonTypes-2009
      { iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0) id-mod-pkixCommon-02(57) }

  AlgorithmIdentifier{}, DIGEST-ALGORITHM, KEY-WRAP, KEY-DERIVATION,
      MAC-ALGORITHM, SIGNATURE-ALGORITHM, PUBLIC-KEY
  FROM AlgorithmInformation-2009
      {iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0)
      id-mod-algorithmInformation-02(58)}

  CertificateSerialNumber, GeneralName, CRLReason, ReasonFlags,
      CertExtensions, GeneralNames
  FROM PKIX1Implicit-2009
      { iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0) id-mod-pkix1-implicit-02(59) }

  Name, id-pkix, PublicKeyAlgorithms, SignatureAlgorithms, id-ad, id-kp
  FROM PKIX1Explicit-2009
      { iso(1) identified-organization(3) dod(6) internet(1) security(5)
        mechanisms(5) pkix(7) id-mod(0) id-mod-pkix1-explicit-02(51) }

  ContentInfo, IssuerAndSerialNumber, CONTENT-TYPE
  FROM CryptographicMessageSyntax-2010
    { iso(1) member-body(2) us(840) rsadsi(113549)
       pkcs(1) pkcs-9(9) smime(16) modules(0) id-mod-cms-2009(58) }

  CertReqMsg, PKIPublicationInfo, CertTemplate
  FROM PKIXCRMF-2009
      { iso(1) identified-organization(3) dod(6) internet(1) security(5)
        mechanisms(5) pkix(7) id-mod(0) id-mod-crmf2005-02(55) }

  mda-sha1
  FROM PKIXAlgs-2009
       { iso(1) identified-organization(3) dod(6)
         internet(1) security(5) mechanisms(5) pkix(7) id-mod(0)
         id-mod-pkix1-algorithms2008-02(56) }

  kda-PBKDF2, maca-hMAC-SHA1
  FROM CryptographicMessageSyntaxAlgorithms-2009
      { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
        smime(16) modules(0) id-mod-cmsalg-2001-02(37) }

  mda-sha256
  FROM PKIX1-PSS-OAEP-Algorithms-2009
       { iso(1) identified-organization(3) dod(6)
         internet(1) security(5) mechanisms(5) pkix(7) id-mod(0)
         id-mod-pkix1-rsa-pkalgs-02(54) }

  maca-hMAC-SHA256
  FROM HMAC-2010
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) mod(0) id-mod-hmac(74) } ;

  --  CMS content types defined in this document

  CMC-ContentTypes CONTENT-TYPE ::= { ct-PKIData | ct-PKIResponse, ... }

  --  Signature Algorithms defined in this document

  SignatureAlgs SIGNATURE-ALGORITHM ::= { sa-noSignature }

  --  CMS Unsigned Attributes

  CMC-UnsignedAtts ATTRIBUTE ::= { aa-cmc-unsignedData }

  id-cmc OBJECT IDENTIFIER ::= { id-pkix 7 }   -- CMC controls
  id-cct OBJECT IDENTIFIER ::= { id-pkix 12 }  -- CMC content types

  -- This is the content type for a request message in the protocol

  ct-PKIData CONTENT-TYPE ::=
      { TYPE PKIData IDENTIFIED BY id-cct-PKIData }

  id-cct-PKIData OBJECT IDENTIFIER ::= { id-cct 2 }

  PKIData ::= SEQUENCE {
      controlSequence    SEQUENCE SIZE(0..MAX) OF TaggedAttribute,
      reqSequence        SEQUENCE SIZE(0..MAX) OF TaggedRequest,
      cmsSequence        SEQUENCE SIZE(0..MAX) OF TaggedContentInfo,
      otherMsgSequence   SEQUENCE SIZE(0..MAX) OF OtherMsg
  }

  BodyPartID ::= INTEGER(0..4294967295)

  TaggedAttribute ::= SEQUENCE {
      bodyPartID         BodyPartID,
      attrType           CMC-CONTROL.&amp;id({Cmc-Control-Set}),
      attrValues         SET OF CMC-CONTROL.
                             &amp;Type({Cmc-Control-Set}{@attrType})
  }

  Cmc-Control-Set CMC-CONTROL ::= {
      cmc-identityProof | cmc-dataReturn | cmc-regInfo |
      cmc-responseInfo | cmc-queryPending | cmc-popLinkRandom |
      cmc-popLinkWitness | cmc-identification | cmc-transactionId |
      cmc-senderNonce | cmc-recipientNonce | cmc-statusInfo |
      cmc-addExtensions | cmc-encryptedPOP | cmc-decryptedPOP |
      cmc-lraPOPWitness | cmc-getCert | cmc-getCRL |
      cmc-revokeRequest | cmc-confirmCertAcceptance |
      cmc-statusInfoV2 | cmc-trustedAnchors | cmc-authData |
      cmc-batchRequests | cmc-batchResponses | cmc-publishCert |
      cmc-modCertTemplate | cmc-controlProcessed |
      cmc-identityProofV2 | cmc-popLinkWitnessV2 |
      cmc-raIdentityWitness | cmc-responseBody, ... }

  OTHER-REQUEST ::= TYPE-IDENTIFIER

  --  We do not define any other requests in this document.
  --  Examples might be attribute certification requests.

  OtherRequests OTHER-REQUEST ::= {...}

  TaggedRequest ::= CHOICE {
      tcr               [0] TaggedCertificationRequest,
      crm               [1] CertReqMsg,
      orm               [2] SEQUENCE {
          bodyPartID            BodyPartID,
          requestMessageType    OTHER-REQUEST.&amp;id({OtherRequests}),
          requestMessageValue   OTHER-REQUEST.&amp;Type({OtherRequests}
                                    {@.requestMessageType})
      }
  }

  TaggedCertificationRequest ::= SEQUENCE {
      bodyPartID            BodyPartID,
      certificationRequest  CertificationRequest
  }

  AttributeList ATTRIBUTE ::= { at-extension-req |
      at-cmc-changeSubjectName, ... }

  CertificationRequest ::= SEQUENCE {
     certificationRequestInfo  SEQUENCE {
         version                   INTEGER,
         subject                   Name,
         subjectPublicKeyInfo      SEQUENCE {
             algorithm                 AlgorithmIdentifier{PUBLIC-KEY,
                                           {PublicKeyAlgorithms}},
             subjectPublicKey          BIT STRING
         },
         attributes                [0] IMPLICIT SET OF
                                       AttributeSet{{AttributeList}}
      },
      signatureAlgorithm        AlgorithmIdentifier
                                    {SIGNATURE-ALGORITHM,
                                        {SignatureAlgorithms}},
      signature                 BIT STRING
  }

  TaggedContentInfo ::= SEQUENCE {
      bodyPartID              BodyPartID,
      contentInfo             ContentInfo
  }

  OTHER-MSG ::= TYPE-IDENTIFIER

  --  No other messages currently defined

  OtherMsgSet OTHER-MSG ::= {...}

  OtherMsg ::= SEQUENCE {
      bodyPartID        BodyPartID,
      otherMsgType      OTHER-MSG.&amp;id({OtherMsgSet}),
      otherMsgValue     OTHER-MSG.&amp;Type({OtherMsgSet}{@otherMsgType}) }

  --  This defines the response message in the protocol

  ct-PKIResponse CONTENT-TYPE ::=
      { TYPE PKIResponse IDENTIFIED BY id-cct-PKIResponse }

  id-cct-PKIResponse OBJECT IDENTIFIER ::= { id-cct 3 }

  ResponseBody ::= PKIResponse

  PKIResponse ::= SEQUENCE {
      controlSequence   SEQUENCE SIZE(0..MAX) OF TaggedAttribute,
      cmsSequence       SEQUENCE SIZE(0..MAX) OF TaggedContentInfo,
      otherMsgSequence  SEQUENCE SIZE(0..MAX) OF OtherMsg
  }

  CMC-CONTROL ::= TYPE-IDENTIFIER

  -- The following controls have the type OCTET STRING

  cmc-identityProof CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-identityProof }

  id-cmc-identityProof OBJECT IDENTIFIER ::= { id-cmc 3 }

  cmc-dataReturn CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-dataReturn }

  id-cmc-dataReturn OBJECT IDENTIFIER ::= { id-cmc 4 }

  cmc-regInfo CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-regInfo }

  id-cmc-regInfo OBJECT IDENTIFIER ::= { id-cmc 18 }

  cmc-responseInfo CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-responseInfo }

  id-cmc-responseInfo OBJECT IDENTIFIER ::= { id-cmc 19 }

  cmc-queryPending CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-queryPending }

  id-cmc-queryPending OBJECT IDENTIFIER ::= { id-cmc 21 }

  cmc-popLinkRandom CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-popLinkRandom }

  id-cmc-popLinkRandom OBJECT IDENTIFIER ::= { id-cmc 22 }

  cmc-popLinkWitness CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-popLinkWitness }

  id-cmc-popLinkWitness OBJECT IDENTIFIER ::= { id-cmc 23 }

  -- The following controls have the type UTF8String

  cmc-identification CMC-CONTROL ::=
      { UTF8String IDENTIFIED BY id-cmc-identification }

  id-cmc-identification OBJECT IDENTIFIER ::= { id-cmc 2 }

  -- The following controls have the type INTEGER

  cmc-transactionId CMC-CONTROL ::=
      { INTEGER IDENTIFIED BY id-cmc-transactionId }

  id-cmc-transactionId OBJECT IDENTIFIER ::= { id-cmc 5 }

  -- The following controls have the type OCTET STRING

  cmc-senderNonce CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-senderNonce }

  id-cmc-senderNonce OBJECT IDENTIFIER ::= { id-cmc 6 }

  cmc-recipientNonce CMC-CONTROL ::=
      { OCTET STRING IDENTIFIED BY id-cmc-recipientNonce }

  id-cmc-recipientNonce OBJECT IDENTIFIER ::= { id-cmc 7 }

  -- Used to return status in a response

  cmc-statusInfo CMC-CONTROL ::=
      { CMCStatusInfo IDENTIFIED BY id-cmc-statusInfo }

  id-cmc-statusInfo OBJECT IDENTIFIER ::= { id-cmc 1 }

  CMCStatusInfo ::= SEQUENCE {
      cMCStatus       CMCStatus,
      bodyList        SEQUENCE SIZE (1..MAX) OF BodyPartID,
      statusString    UTF8String OPTIONAL,
      otherInfo       CHOICE {
         failInfo         CMCFailInfo,
         pendInfo         PendInfo
      } OPTIONAL
  }

  PendInfo ::= SEQUENCE {
      pendToken        OCTET STRING,
      pendTime         GeneralizedTime
  }

  CMCStatus ::= INTEGER {
      success         (0),
      failed          (2),
      pending         (3),
      noSupport       (4),
      confirmRequired (5),
      popRequired     (6),
      partial         (7)
  }

  CMCFailInfo ::= INTEGER {
      badAlg          (0),
      badMessageCheck (1),
      badRequest      (2),
      badTime         (3),
      badCertId       (4),
      unsuportedExt   (5),
      mustArchiveKeys (6),
      badIdentity     (7),
      popRequired     (8),
      popFailed       (9),
      noKeyReuse      (10),
      internalCAError (11),
      tryLater        (12),
      authDataFail    (13)
  }

  -- Used for RAs to add extensions to certification requests

  cmc-addExtensions CMC-CONTROL ::=
      { AddExtensions IDENTIFIED BY id-cmc-addExtensions }

  id-cmc-addExtensions OBJECT IDENTIFIER ::= { id-cmc 8 }

  AddExtensions ::= SEQUENCE {
      pkiDataReference    BodyPartID,
      certReferences      SEQUENCE OF BodyPartID,
      extensions          SEQUENCE OF Extension{{CertExtensions}}
  }

  cmc-encryptedPOP CMC-CONTROL ::=
      { EncryptedPOP IDENTIFIED BY id-cmc-encryptedPOP }

  cmc-decryptedPOP CMC-CONTROL ::=
      { DecryptedPOP IDENTIFIED BY id-cmc-decryptedPOP }

  id-cmc-encryptedPOP OBJECT IDENTIFIER ::= { id-cmc 9 }

  id-cmc-decryptedPOP OBJECT IDENTIFIER ::= { id-cmc 10 }

  EncryptedPOP ::= SEQUENCE {
      request       TaggedRequest,
      cms             ContentInfo,
      thePOPAlgID     AlgorithmIdentifier{MAC-ALGORITHM, {POPAlgs}},
      witnessAlgID    AlgorithmIdentifier{DIGEST-ALGORITHM,
                          {WitnessAlgs}},
      witness         OCTET STRING
  }

  POPAlgs MAC-ALGORITHM ::= { maca-hMAC-SHA1 | maca-hMAC-SHA256, ... }

  WitnessAlgs DIGEST-ALGORITHM ::= { mda-sha1 | mda-sha256, ... }

  DecryptedPOP ::= SEQUENCE {
      bodyPartID      BodyPartID,
      thePOPAlgID     AlgorithmIdentifier{MAC-ALGORITHM, {POPAlgs}},
      thePOP          OCTET STRING
  }

  cmc-lraPOPWitness CMC-CONTROL ::=
      { LraPopWitness IDENTIFIED BY id-cmc-lraPOPWitness }

  id-cmc-lraPOPWitness OBJECT IDENTIFIER ::= { id-cmc 11 }

  LraPopWitness ::= SEQUENCE {
      pkiDataBodyid   BodyPartID,
      bodyIds         SEQUENCE OF BodyPartID
  }

  cmc-getCert CMC-CONTROL ::=
      { GetCert IDENTIFIED BY id-cmc-getCert }

  id-cmc-getCert OBJECT IDENTIFIER ::= { id-cmc 15 }

  GetCert ::= SEQUENCE {
      issuerName      GeneralName,
      serialNumber    INTEGER }

  cmc-getCRL CMC-CONTROL ::=
      { GetCRL IDENTIFIED BY id-cmc-getCRL }

  id-cmc-getCRL OBJECT IDENTIFIER ::= { id-cmc 16 }

  GetCRL ::= SEQUENCE {
      issuerName    Name,
      cRLName       GeneralName OPTIONAL,
      time          GeneralizedTime OPTIONAL,
      reasons       ReasonFlags OPTIONAL }

  cmc-revokeRequest CMC-CONTROL ::=
      { RevokeRequest IDENTIFIED BY id-cmc-revokeRequest}

  id-cmc-revokeRequest OBJECT IDENTIFIER ::= { id-cmc 17 }

  RevokeRequest ::= SEQUENCE {
      issuerName            Name,
      serialNumber          INTEGER,
      reason                CRLReason,
      invalidityDate         GeneralizedTime OPTIONAL,
      passphrase            OCTET STRING OPTIONAL,
      comment               UTF8String OPTIONAL }

  cmc-confirmCertAcceptance CMC-CONTROL ::=
      { CMCCertId IDENTIFIED BY id-cmc-confirmCertAcceptance }

  id-cmc-confirmCertAcceptance OBJECT IDENTIFIER ::= { id-cmc 24 }

  CMCCertId ::= IssuerAndSerialNumber

  -- The following is used to request V3 extensions be added
  -- to a certificate

  at-extension-req ATTRIBUTE ::=
      { TYPE ExtensionReq IDENTIFIED BY id-ExtensionReq }

  id-ExtensionReq OBJECT IDENTIFIER ::= { iso(1) member-body(2) us(840)
      rsadsi(113549) pkcs(1) pkcs-9(9) 14 }

  ExtensionReq ::= SEQUENCE SIZE (1..MAX) OF
      Extension{{CertExtensions}}

  -- The following allows Diffie-Hellman Certification Request
  -- Messages to be well-formed

  sa-noSignature SIGNATURE-ALGORITHM ::= {
      IDENTIFIER id-alg-noSignature
      VALUE NoSignatureValue
      PARAMS TYPE NULL ARE required
      HASHES { mda-sha1 }
  }

  id-alg-noSignature OBJECT IDENTIFIER ::= { id-pkix id-alg(6) 2 }

  NoSignatureValue ::= OCTET STRING

  --  Unauthenticated attribute to carry removable data.

  id-aa OBJECT IDENTIFIER ::= { iso(1) member-body(2) us(840)
      rsadsi(113549) pkcs(1) pkcs-9(9) smime(16) id-aa(2) }

  aa-cmc-unsignedData ATTRIBUTE ::=
      { TYPE CMCUnsignedData IDENTIFIED BY id-aa-cmc-unsignedData }

  id-aa-cmc-unsignedData OBJECT IDENTIFIER ::= { id-aa 34 }

  CMCUnsignedData ::= SEQUENCE {
      bodyPartPath        BodyPartPath,
      identifier          TYPE-IDENTIFIER.&amp;id,
      content             TYPE-IDENTIFIER.&amp;Type
  }

  --  Replaces CMC Status Info
  --

  cmc-statusInfoV2 CMC-CONTROL ::=
      { CMCStatusInfoV2 IDENTIFIED BY id-cmc-statusInfoV2 }

  id-cmc-statusInfoV2 OBJECT IDENTIFIER ::= { id-cmc 25 }

  EXTENDED-FAILURE-INFO ::= TYPE-IDENTIFIER

  ExtendedFailures EXTENDED-FAILURE-INFO ::= {...}

  CMCStatusInfoV2 ::= SEQUENCE {
     cMCStatus             CMCStatus,
     bodyList              SEQUENCE SIZE (1..MAX) OF
                                    BodyPartReference,
     statusString          UTF8String OPTIONAL,
     otherInfo             CHOICE {
         failInfo               CMCFailInfo,
         pendInfo               PendInfo,
         extendedFailInfo       [1] SEQUENCE {
            failInfoOID            TYPE-IDENTIFIER.&amp;id
                                       ({ExtendedFailures}),
            failInfoValue          TYPE-IDENTIFIER.&amp;Type
                                       ({ExtendedFailures}
                                           {@.failInfoOID})
         }
      } OPTIONAL
  }

  BodyPartReference ::= CHOICE {
     bodyPartID           BodyPartID,
     bodyPartPath         BodyPartPath
  }

  BodyPartPath ::= SEQUENCE SIZE (1..MAX) OF BodyPartID

  --  Allow for distribution of trust anchors

  cmc-trustedAnchors CMC-CONTROL ::=
      { PublishTrustAnchors IDENTIFIED BY id-cmc-trustedAnchors }

  id-cmc-trustedAnchors OBJECT IDENTIFIER ::= { id-cmc 26 }

  PublishTrustAnchors ::= SEQUENCE {
      seqNumber      INTEGER,
      hashAlgorithm  AlgorithmIdentifier{DIGEST-ALGORITHM,
                         {HashAlgorithms}},
      anchorHashes   SEQUENCE OF OCTET STRING
  }

  HashAlgorithms DIGEST-ALGORITHM ::= {
     mda-sha1 | mda-sha256, ...
  }

  cmc-authData CMC-CONTROL ::=
      { AuthPublish IDENTIFIED BY id-cmc-authData }

  id-cmc-authData OBJECT IDENTIFIER ::= { id-cmc 27 }

  AuthPublish ::= BodyPartID

  --   These two items use BodyPartList

  cmc-batchRequests CMC-CONTROL ::=
      { BodyPartList IDENTIFIED BY id-cmc-batchRequests }

  id-cmc-batchRequests OBJECT IDENTIFIER ::= { id-cmc 28 }

  cmc-batchResponses CMC-CONTROL ::=
      { BodyPartList IDENTIFIED BY id-cmc-batchResponses }

  id-cmc-batchResponses OBJECT IDENTIFIER ::= { id-cmc 29 }

  BodyPartList ::= SEQUENCE SIZE (1..MAX) OF BodyPartID

  cmc-publishCert CMC-CONTROL ::=
      { CMCPublicationInfo IDENTIFIED BY id-cmc-publishCert }

  id-cmc-publishCert OBJECT IDENTIFIER ::= { id-cmc 30 }

  CMCPublicationInfo ::= SEQUENCE {
      hashAlg        AlgorithmIdentifier{DIGEST-ALGORITHM,
                           {HashAlgorithms}},
      certHashes     SEQUENCE OF OCTET STRING,
      pubInfo        PKIPublicationInfo
  }

  cmc-modCertTemplate CMC-CONTROL ::=
      { ModCertTemplate IDENTIFIED BY id-cmc-modCertTemplate }

  id-cmc-modCertTemplate OBJECT IDENTIFIER ::= { id-cmc 31 }

  ModCertTemplate ::= SEQUENCE {
      pkiDataReference             BodyPartPath,
      certReferences               BodyPartList,
      replace                      BOOLEAN DEFAULT TRUE,
      certTemplate                 CertTemplate
  }

  -- Inform follow-on servers that one or more controls have
  -- already been processed

  cmc-controlProcessed CMC-CONTROL ::=
      { ControlsProcessed IDENTIFIED BY id-cmc-controlProcessed }

  id-cmc-controlProcessed OBJECT IDENTIFIER ::= { id-cmc 32 }

  ControlsProcessed ::= SEQUENCE {
      bodyList              SEQUENCE SIZE(1..MAX) OF BodyPartReference
  }

  --  Identity Proof control w/ algorithm agility

  cmc-identityProofV2 CMC-CONTROL ::=
      { IdentityProofV2 IDENTIFIED BY id-cmc-identityProofV2 }

  id-cmc-identityProofV2 OBJECT IDENTIFIER ::= { id-cmc 33 }

  IdentityProofV2 ::= SEQUENCE {
      proofAlgID       AlgorithmIdentifier{DIGEST-ALGORITHM,
                           {WitnessAlgs}},
      macAlgId         AlgorithmIdentifier{MAC-ALGORITHM, {POPAlgs}},
      witness          OCTET STRING
  }

  cmc-popLinkWitnessV2 CMC-CONTROL ::=
      { PopLinkWitnessV2 IDENTIFIED BY id-cmc-popLinkWitnessV2 }

  id-cmc-popLinkWitnessV2 OBJECT IDENTIFIER ::= { id-cmc 34 }

  PopLinkWitnessV2 ::= SEQUENCE {
      keyGenAlgorithm   AlgorithmIdentifier{KEY-DERIVATION,
                            {KeyDevAlgs}},
      macAlgorithm      AlgorithmIdentifier{MAC-ALGORITHM, {POPAlgs}},
      witness           OCTET STRING
  }

  KeyDevAlgs KEY-DERIVATION ::= { kda-PBKDF2, ... }

  cmc-raIdentityWitness CMC-CONTROL ::=
     { BodyPartPath IDENTIFIED BY id-cmc-raIdentityWitness }

  id-cmc-raIdentityWitness OBJECT IDENTIFIER ::= {id-cmc 35}

  --
  --  Allow for an End-Entity to request a change in name.
  --  This item is added to RegControlSet in CRMF.
  --
  at-cmc-changeSubjectName ATTRIBUTE ::=
     { TYPE ChangeSubjectName IDENTIFIED BY id-cmc-changeSubjectName }

  id-cmc-changeSubjectName OBJECT IDENTIFIER ::= { id-cmc 36 }

  ChangeSubjectName ::= SEQUENCE {
      subject             Name OPTIONAL,
      subjectAlt          GeneralNames OPTIONAL
  }
  (WITH COMPONENTS {..., subject PRESENT} |
   WITH COMPONENTS {..., subjectAlt PRESENT} )

  --
  --  Embedded response from a third party for processing
  --

  cmc-responseBody CMC-CONTROL ::= {
     BodyPartPath IDENTIFIED BY id-cmc-responseBody
  }

  id-cmc-responseBody OBJECT IDENTIFIER ::= { id-cmc 37 }

  --
  --  Key purpose identifiers are in the Extended Key Usage extension
  --

  id-kp-cmcCA OBJECT IDENTIFIER ::= { id-kp 27 }
  id-kp-cmcRA OBJECT IDENTIFIER ::= { id-kp 28 }
  id-kp-cmcArchive OBJECT IDENTIFIER ::= { id-kp 29 }

  --
  --  Subject Information Access identifier
  --

  id-ad-cmc OBJECT IDENTIFIER ::= { id-ad 12 }

END
</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="asn1-module-for-pbkdf2-prfs">
<section id="appendix-A.2">
        <h3 id="name-asn1-module-for-pbkdf2-prfs">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-asn1-module-for-pbkdf2-prfs" class="section-name selfRef">ASN.1 Module for PBKDF2 PRFs</a>
        </h3>
<p id="appendix-A.2-1">The module contained in this appendix extends the PBKDF2-PRFs algorithm
set defined in <span><a href="https://rfc-editor.org/rfc/rfc5911#section-3" class="relref">Section 3</a> of [<a href="#CMS-ALGS" class="cite xref">CMS-ALGS</a>]</span>. Apply this extension prior to
compiling <a href="#asn.1-cmc" class="auto internal xref">Appendix A.1</a> to ensure the imported kda-PBKDF2 includes the
6 HMAC algorithms included in this ASN.1 module.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-2">
<pre>
PBKDF2-PRFs-2023
  { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
    smime(16) modules(0) id-mod-pbkdf2-prfs(TBD) }

DEFINITIONS IMPLICT TAGS ::=
BEGIN
IMPORTS

ALGORITHM
  FROM AlgorithmInformation-2009 -- From [PKIX-Algs]
    { iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0)
      id-mod-algorithmInformation-02(58) }

id-hmacWithSHA224, id-hmacWithSHA256,
id-hmacWithSHA384, id-hmacWithSHA512
  FROM HMAC-2010 -- From [HMAC-Algs]
    { iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) mod(0) id-mod-hmac(74) }
;

--
-- Base OID for algorithms
--

rsadsi OBJECT IDENTIFIER ::= { iso(1) member-body(2) us(840)
                               rsadsi(113549) }

digestAlgorithm   OBJECT IDENTIFIER ::= { rsadsi 2 }

id-hmacWithSHA512-224 OBJECT IDENTIFIER ::= { digestAlgorithm 12 }
id-hmacWithSHA512-256 OBJECT IDENTIFIER ::= { digestAlgorithm 13 }

--
-- PBKF2-PRFs
--

PBKDF2-PRFs ALGORITHM ::= {
  alg-hMAC-SHA224       |
  alg-hMAC-SHA256       |
  alg-hMAC-SHA384       |
  alg-hMAC-SHA512       |
  alg-hMAC-SHA512-224 |
  alg-hMAC-SHA512-256,
  ... }

alg-hMAC-SHA224 ALGORITHM ::=
  { IDENTIFIER id-hmacWithSHA224 PARAMS TYPE NULL ARE preferredAbsent }

alg-hMAC-SHA256 ALGORITHM ::=
  { IDENTIFIER id-hmacWithSHA256 PARAMS TYPE NULL ARE preferredAbsent }

alg-hMAC-SHA384 ALGORITHM ::=
  { IDENTIFIER id-hmacWithSHA384 PARAMS TYPE NULL ARE preferredAbsent }

alg-hMAC-SHA512 ALGORITHM ::=
  { IDENTIFIER id-hmacWithSHA512 PARAMS TYPE NULL ARE preferredAbsent }

alg-hMAC-SHA512-224 ALGORITHM ::=
  { IDENTIFIER id-hmacWithSHA512-224 PARAMS TYPE NULL ARE preferredAbsent }

alg-hMAC-SHA512-256 ALGORITHM ::=
  { IDENTIFIER id-hmacWithSHA512-256 PARAMS TYPE NULL ARE preferredAbsent }

END
</pre><a href="#appendix-A.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="enroll">
<section id="appendix-B">
      <h2 id="name-enrollment-message-flows">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-enrollment-message-flows" class="section-name selfRef">Enrollment Message Flows</a>
      </h2>
<p id="appendix-B-1">This section is informational.  The purpose of this section is to
present, in an abstracted version, the messages that would flow
between the client and server for several different common cases.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="RequestofaSigningCertificate">
<section id="appendix-B.1">
        <h3 id="name-request-of-a-signing-certif">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-request-of-a-signing-certif" class="section-name selfRef">Request of a Signing Certificate</a>
        </h3>
<p id="appendix-B.1-1">This section looks at the messages that would flow in the event that
an enrollment is occurring for a signing-only key.  If the
certificate was designed for both signing and encryption, the only
difference would be the key usage extension in the certification
request.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">Message #2 from client to server:<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-3">
<pre>
   ContentInfo.contentType = id-signedData
   ContentInfo.content
     SignedData.encapContentInfo
       eContentType = id-cct-PKIData
       eContent
         controlSequence
           {102, id-cmc-identityProof, computed value}
           {103, id-cmc-senderNonce, 10001}
         reqSequence
           certRequest
             certReqId = 201
             certTemplate
               subject = My Proposed DN
               publicKey = My Public Key
               extensions
                 {id-ce-subjectPublicKeyIdentifier, 1000}
                 {id-ce-keyUsage, digitalSignature}
     SignedData.SignerInfos
       SignerInfo
         sid.subjectKeyIdentifier = 1000
</pre><a href="#appendix-B.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-4">Response from server to client:<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-5">
<pre>
   ContentInfo.contentType = id-signedData
   ContentInfo.content
     SignedData.encapContentInfo
       eContentType = id-cct-PKIResponse
       eContent
         controlSequence
           {102, id-cmc-statusInfoV2, {success, 201}}
           {103, id-cmc-senderNonce, 10005}
           {104, id-cmc-recipientNonce, 10001}
     certificates
       Newly issued certificate
       Other certificates
     SignedData.SignerInfos
       Signed by CA
</pre><a href="#appendix-B.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="SingleCertificationRequestModifiedbyRA">
<section id="appendix-B.2">
        <h3 id="name-single-certification-reques">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-single-certification-reques" class="section-name selfRef">Single Certification Request, But Modified by RA</a>
        </h3>
<p id="appendix-B.2-1">This section looks at the messages that would flow in the event that
an enrollment has one RA in the middle of the data flow.  That RA
will modify the certification request before passing it on to the CA.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">Message from client to RA:<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-3">
<pre>
   ContentInfo.contentType = id-signedData
   ContentInfo.content
     SignedData.encapContentInfo
       eContentType = id-cct-PKIData
       eContent
         controlSequence
           {102, id-cmc-identityProof, computed value}
           {103, id-cmc-senderNonce, 10001}
         reqSequence
           certRequest
             certReqId = 201
             certTemplate
               subject = My Proposed DN
               publicKey = My Public Key
               extensions
                 {id-ce-subjectPublicKeyIdentifier, 1000}
                 {id-ce-keyUsage, digitalSignature}
     SignedData.SignerInfos
       SignerInfo
         sid.subjectKeyIdentifier = 1000
</pre><a href="#appendix-B.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-4">Message from RA to CA:<a href="#appendix-B.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-5">
<pre>
   ContentInfo.contentType = id-signedData
   ContentInfo.content
     SignedData.encapContentInfo
       eContentType = id-cct-PKIData
       eContent
         controlSequence
           { 102, id-cmc-batchRequests, { 1, 2} }
           { 103, id-cmc-addExtensions,
             { {1, 201, {id-ce-certificatePolicies, anyPolicy}}
               {1, 201, {id-ce-subjectAltName, {extension data}}
               {2, XXX, {id-ce-subjectAltName, {extension data}}}
                     The Value XXX is not known here; it would
                     reference into the second client request,
                     which is not displayed above.
         cmsSequence
           { 1, &lt;Message from client to RA #1&gt; }
           { 2, &lt;Message from client to RA #2&gt; }
     SignedData.SignerInfos
       SignerInfo
         sid = RA key.
</pre><a href="#appendix-B.2-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-6">Response from CA to RA:<a href="#appendix-B.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-7">
<pre>
   ContentInfo.contentType = id-signedData
   ContentInfo.content
     SignedData.encapContentInfo
       eContentType = id-cct-PKIResponse
       eContent
         controlSequence
           {102, id-cmc-BatchResponse, {999, 998}}

           {103, id-cmc-statusInfoV2, {failed, 2, badIdentity}}
         cmsSequence
           { bodyPartID = 999
             contentInfo
               ContentInfo.contentType = id-signedData
               ContentInfo.content
                 SignedData.encapContentInfo
                   eContentType = id-cct-PKIResponse
                   eContent
                     controlSequence
                      {102, id-cmc-statusInfoV2, {success, 201}}
                 certificates
                   Newly issued certificate
                   Other certificates
                 SignedData.SignerInfos
                   Signed by CA
           }
           { bodyPartID = 998,
             contentInfo
               ContentInfo.contentType = id-signedData
               ContentInfo.content
                 SignedData.encapContentInfo
                   eContentType = id-cct-PKIResponse
                   eContent
                     controlSequence
                       {102, id-cmc-statusInfoV2, {failure, badAlg}}
                 certificates
                   Newly issued certificate
                   Other certificates
                 SignedData.SignerInfos
                   Signed by CA
           }
         SignedData.SignerInfos
           Signed by CA
</pre><a href="#appendix-B.2-7" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-8">Response from RA to client:<a href="#appendix-B.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-9">
<pre>
   ContentInfo.contentType = id-signedData
   ContentInfo.content
     SignedData.encapContentInfo
       eContentType = id-cct-PKIResponse
       eContent
         controlSequence
           {102, id-cmc-statusInfoV2, {success, 201}}
     certificates
       Newly issued certificate
       Other certificates
     SignedData.SignerInfos
       Signed by CA
</pre><a href="#appendix-B.2-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="DirectPOPforRSACertificate">
<section id="appendix-B.3">
        <h3 id="name-direct-pop-for-an-rsa-certi">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-direct-pop-for-an-rsa-certi" class="section-name selfRef">Direct POP for an RSA Certificate</a>
        </h3>
<p id="appendix-B.3-1">This section looks at the messages that would flow in the event that
an enrollment is done for an encryption only certificate using an
direct POP method.  For simplicity, it is assumed that the
certification requester already has a signing-only certificate.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3-2">The fact that a second round-trip is required is implicit rather than
explicit.  The server determines this based on the fact that no other
POP exists for the certification request.<a href="#appendix-B.3-2" class="pilcrow">¶</a></p>
<p id="appendix-B.3-3">Message #1 from client to server:<a href="#appendix-B.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-4">
<pre>
   ContentInfo.contentType = id-signedData
   ContentInfo.content
     SignedData.encapContentInfo
       eContentType = id-cct-PKIData
       eContent
         controlSequence
           {102, id-cmc-transactionId, 10132985123483401}
           {103, id-cmc-senderNonce, 10001}
           {104, id-cmc-dataReturn, &lt;packet of binary data identifying
                                     where the key in question is.&gt;}
         reqSequence
           certRequest
             certReqId = 201
             certTemplate
               subject = &lt;My DN from my signing cert&gt;
               publicKey = My Public Key
               extensions
                 {id-ce-keyUsage, keyEncipherment}
             popo
               keyEncipherment
                 subsequentMessage
     SignedData.SignerInfos
       SignerInfo
         Signed by requester's signing cert
</pre><a href="#appendix-B.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-5">Response #1 from server to client:<a href="#appendix-B.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-6">
<pre>
   ContentInfo.contentType = id-signedData
   ContentInfo.content
     SignedData.encapContentInfo
       eContentType = id-cct-PKIResponse
       eContent
         controlSequence
           {101, id-cmc-statusInfoV2, {failed, 201, popRequired}}
           {102, id-cmc-transactionId, 10132985123483401}
           {103, id-cmc-senderNonce, 10005}
           {104, id-cmc-recipientNonce, 10001}
           {105, id-cmc-encryptedPOP, {
              request {
                certRequest
                  certReqId = 201
                   certTemplate
                     subject = &lt;My DN from my signing cert&gt;
                     publicKey = My Public Key
                     extensions
                       {id-ce-keyUsage, keyEncipherment}
                   popo
                     keyEncipherment
                     subsequentMessage
              }
              cms
                contentType = id-envelopedData
                content
                  recipientInfos.riid.issuerSerialNumber = &lt;NULL, 201&gt;
                  encryptedContentInfo
                    eContentType = id-data
                    eContent = &lt;Encrypted value of 'y'&gt;
              thePOPAlgID = HMAC-SHA256
              witnessAlgID = SHA-256
              witness &lt;hashed value of 'y'&gt;}}
           {106, id-cmc-dataReturn, &lt;packet of binary data identifying
                                     where the key in question is.&gt;}
     certificates
       Other certificates (optional)
     SignedData.SignerInfos
       Signed by CA

   ContentInfo.contentType = id-signedData
   ContentInfo.content
     SignedData.encapContentInfo
       eContentType = id-cct-PKIData
       eContent
         controlSequence
           {102, id-cmc-transactionId, 10132985123483401}
           {103, id-cmc-senderNonce, 100101}
           {104, id-cmc-dataReturn, &lt;packet of binary data identifying
                                     where the key in question is.&gt;}
           {105, id-cmc-recipientNonce, 10005}
           {107, id-cmc-decryptedPOP, {
             bodyPartID 201,
             thePOPAlgID HMAC-SHA256,
             thePOP &lt;HMAC computed value goes here&gt;}}
         reqSequence
           certRequest
             certReqId = 201
             certTemplate
               subject = &lt;My DN from my signing cert&gt;
               publicKey = My Public Key
               extensions
                 {id-ce-keyUsage, keyEncipherment}
             popo
               keyEncipherment
                 subsequentMessage
     SignedData.SignerInfos
       SignerInfo
         Signed by requester's signing cert
</pre><a href="#appendix-B.3-6" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-7">Response #2 from server to client:<a href="#appendix-B.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-8">
<pre>
   ContentInfo.contentType = id-signedData
   ContentInfo.content
     SignedData.encapContentInfo
       eContentType = id-cct-PKIResponse
       eContent
         controlSequence
           {101, id-cmc-transactionId, 10132985123483401}
           {102, id-cmc-statusInfoV2, {success, 201}}
           {103, id-cmc-senderNonce, 10019}
           {104, id-cmc-recipientNonce, 100101}
           {105, id-cmc-dataReturn, &lt;packet of binary data identifying
                                     where the key in question is.&gt;}
     certificates
       Newly issued certificate
       Other certificates
     SignedData.SignerInfos
       Signed by CA
</pre><a href="#appendix-B.3-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="enroll-dh">
<section id="appendix-C">
      <h2 id="name-production-of-diffie-hellma">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-production-of-diffie-hellma" class="section-name selfRef">Production of Diffie-Hellman Public Key Certification Requests</a>
      </h2>
<p id="appendix-C-1">Part of a certification request is a signature over the request;
Diffie-Hellman is a key agreement algorithm and cannot be used to
directly produce the required signature object.  <span>[<a href="#DH-POP" class="cite xref">DH-POP</a>]</span> provides
two ways to produce the necessary signature value.  This document
also defines a signature algorithm that does not provide a POP value,
but can be used to produce the necessary signature value.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="NoSig-Sig">
<section id="appendix-C.1">
        <h3 id="name-no-signature-signature-mech">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-no-signature-signature-mech" class="section-name selfRef">No-Signature Signature Mechanism</a>
        </h3>
<p id="appendix-C.1-1">Key management (encryption/decryption) private keys cannot always be
used to produce some type of signature value as they can be in a
decrypt-only device.  Certification requests require that the
signature field be populated.  This section provides a signature
algorithm specifically for that purposes.  The following object
identifier and signature value are used to identify this signature
type:<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-2">
<pre>
  id-alg-noSignature OBJECT IDENTIFIER ::= { id-pkix id-alg(6) 2 }

  NoSignatureValue ::= OCTET STRING
</pre><a href="#appendix-C.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-3">The parameters for id-alg-noSignature <span class="bcp14">MUST</span> be present and <span class="bcp14">MUST</span> be
encoded as NULL.  NoSignatureValue contains the hash of the
certification request.  It is important to realize that there is no
security associated with this signature type.  If this signature type
is on a certification request and the Certification Authority policy
requires proof-of-possession of the private key, the POP mechanism
defined in <a href="#EncryptedandDecryptedPOPControls" class="auto internal xref">Section 6.7</a> <span class="bcp14">MUST</span> be used.<a href="#appendix-C.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">Obviously, the authors of this version of the document would like to
thank Jim Schaad and Michael Myers for their work on the previous
version of this document.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">The acknowledgment from the previous version of this document follows:<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">The authors and the PKIX Working Group are grateful for the
participation of Xiaoyi Liu and Jeff Weinstein in helping to author
the original versions of this document.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<p id="appendix-D-4">The authors would like to thank Brian LaMacchia for his work in
developing and writing up many of the concepts presented in this
document.  The authors would also like to thank Alex Deacon and Barb
Fox for their contributions.<a href="#appendix-D-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-E">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jim Schaad</span></div>
<div dir="auto" class="left"><span class="org">August Cellars</span></div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Myers</span></div>
<div dir="auto" class="left"><span class="org">TraceRoute Security, Inc.</span></div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Joseph Mandel (editor)</span></div>
<div dir="auto" class="left"><span class="org">AKAYLA, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:joe@akayla.com" class="email">joe@akayla.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sean Turner (editor)</span></div>
<div dir="auto" class="left"><span class="org">sn3rd</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sean@sn3rd.com" class="email">sean@sn3rd.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
